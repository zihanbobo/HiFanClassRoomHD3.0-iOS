var TK=TK||{};
TK.EventDispatcher=function(c){var f={};c.dispatcher={};c.dispatcher.eventListeners={};c.dispatcher.backupListerners={};f.addEventListener=function(b,a,d){void 0!==b&&null!==b&&(void 0===c.dispatcher.eventListeners[b]&&(c.dispatcher.eventListeners[b]=[]),c.dispatcher.eventListeners[b].push(a),d&&(void 0===c.dispatcher.backupListerners[d]&&(c.dispatcher.backupListerners[d]=[]),c.dispatcher.backupListerners[d].push({eventType:b,listener:a})))};f.removeEventListener=function(b,a){c.dispatcher.eventListeners[b]?(a=
c.dispatcher.eventListeners[b].indexOf(a),-1!==a&&c.dispatcher.eventListeners[b].splice(a,1)):L.Logger.info("[tk-mobile-sdk]not event type: "+b)};f.removeAllEventListener=function(b){if(b&&"object"===typeof b&&"number"===typeof b.length&&"function"===typeof b.splice&&!b.propertyIsEnumerable("length"))for(var a in b){var d=b[a];delete c.dispatcher.eventListeners[d]}else if("string"===typeof b)delete c.dispatcher.eventListeners[b];else if("object"===typeof b)for(var e in b)d=e,f.removeEventListener(d,
b[e])};f.dispatchEvent=function(b,a){var d;(void 0!=a?a:1)&&L.Logger.debug("[tk-mobile-sdk]dispatchEvent , event type: "+b.type);for(d in c.dispatcher.eventListeners[b.type])if(c.dispatcher.eventListeners[b.type].hasOwnProperty(d))c.dispatcher.eventListeners[b.type][d](b)};f.removeBackupListerner=function(b){if(b&&c.dispatcher.backupListerners[b]){for(var a=0;a<c.dispatcher.backupListerners[b].length;a++){var d=c.dispatcher.backupListerners[b][a];f.removeEventListener(d.eventType,d.listener)}c.dispatcher.backupListerners[b].length=
0;delete c.dispatcher.backupListerners[b]}};return f};TK.TalkEvent=function(c){var f={};f.type=c.type;return f};TK.RoomEvent=function(c,f){var b=TK.TalkEvent(c);b.streams=c.streams;b.message=c.message;b.user=c.user;if(f&&"object"===typeof f)for(var a in f)b[a]=f[a];return b};TK.StreamEvent=function(c,f){var b=TK.TalkEvent(c);b.stream=c.stream;b.message=c.message;b.bandwidth=c.bandwidth;b.attrs=c.attrs;if(f&&"object"===typeof f)for(var a in f)b[a]=f[a];return b};
TK.PublisherEvent=function(c,f){c=TK.TalkEvent(c);if(f&&"object"===typeof f)for(var b in f)c[b]=f[b];return c};TK.mobileSdkEventManager=TK.EventDispatcher({});TK.mobileUICoreEventManager=TK.EventDispatcher({});TK=TK||{};TK.SDKTYPE="mobile";TK.PUBLISH_STATE_NONE=0;TK.PUBLISH_STATE_AUDIOONLY=1;TK.PUBLISH_STATE_VIDEOONLY=2;TK.PUBLISH_STATE_BOTH=3;TK.PUBLISH_STATE_MUTEALL=4;
TK.Room=function(){L.Logger.info("[tk-sdk-version]sdk-version:"+(window.__SDKVERSIONS__||"2.1.1")+" , sdk-time: "+(window.__SDKVERSIONSTIME__||"2018052222"));var c=TK.EventDispatcher({}),f={},b={},a={},d={};c.getSpecifyRoleList=function(a){if(void 0===a)return L.Logger.error("[tk-sdk]getSpecifyRoleList specifyRoleIdentification is not exist!"),{};var e={},d;for(d in b)b[d]&&b[d].role===a&&(e[d]=b[d]);return e};c.getRoomProperties=function(){return a};c.getUsers=function(){return b};c.getUser=function(a){return b[a]};
c.getMySelf=function(){return f};c.logMessage=function(a,d){MOBILETKSDK.sendInterface.logMessage(a,d)};c.dynamicPptVideoAutoPlay=function(a){MOBILETKSDK.sendInterface.dynamicPptVideoAutoPlay(a)};c.changeWebPageFullScreen=function(a){MOBILETKSDK.sendInterface.changeWebPageFullScreen(a)};c.onPageFinished=function(){MOBILETKSDK.sendInterface.onPageFinished()};c.pubMsg=function(a){MOBILETKSDK.sendInterface.pubMsg(a)};c.delMsg=function(a){MOBILETKSDK.sendInterface.delMsg(a)};c.changeUserProperty=function(a,
d,b){MOBILETKSDK.sendInterface.changeUserProperty(a,d,b)};c.setLocalStorageItem=function(a,d){MOBILETKSDK.sendInterface.setLocalStorageItem(a,d)};c.getLocalStorageItem=function(a,d){var e=void 0;"function"===typeof d&&(e=function(a){d(""+a)});MOBILETKSDK.sendInterface.getLocalStorageItem(a,e)};d={"room-userproperty-changed":function(a){a=a.message;L.Logger.debug("[tk-mobile-sdk]room-userproperty-changed info:"+L.Utils.toJsonStringify(a));var e=a.userid;if(a.hasOwnProperty("properties")){var d=a.properties,
h=b[e];if(void 0===h)return L.Logger.error("[tk-mobile-sdk]room-userproperty-changed user is not exist , userid is "+e+"!"),!0;for(var f in d)"id"!=f&&"watchStatus"!=f&&(h[f]=d[f]);f=TK.RoomEvent({type:"room-userproperty-changed",user:h,message:d},{fromID:a.fromID});c.dispatchEvent(f)}return!0},"room-participant_leave":function(a){a=a.userid;L.Logger.debug("[tk-mobile-sdk]room-participant_leave userid:"+a);var d=b[a];if(void 0===d)return L.Logger.error("[tk-mobile-sdk]participantLeft user is not exist , userid is "+
a+"!"),!0;TK.global.initPageParameterFormPhone.playback?b[a]&&(b[a].playbackLeaved=!0):delete b[a];a=TK.RoomEvent({type:"room-participant_leave",user:d});c.dispatchEvent(a);return!0},"room-participant_join":function(a){a=a.user;L.Logger.debug("[tk-mobile-sdk]room-participant_join user:"+L.Utils.toJsonStringify(a));b[a.id]=a;TK.global.initPageParameterFormPhone.playback&&b[a.id]&&delete b[a.id].playbackLeaved;a=TK.RoomEvent({type:"room-participant_join",user:a});c.dispatchEvent(a);return!0},"room-connected":function(d){L.Logger.debug("[tk-mobile-sdk]room-connected info:"+
L.Utils.toJsonStringify(d));var e=d.userlist,g=d.msglist,h=d.myself;d=d.roomProperties;h&&(f=h);d&&(a=d);b={};b[f.id]=f;for(var l in e)e.hasOwnProperty(l)&&(h=e[l],void 0!==h&&(b[h.id]=h,TK.global.initPageParameterFormPhone.playback&&b[h.id]&&delete b[h.id].playbackLeaved));e=[];g&&"string"==typeof g&&(g=L.Utils.toJsonParse(g));for(l in g)g.hasOwnProperty(l)&&e.push(g[l]);e.sort(function(a,d){return void 0!==a&&a.hasOwnProperty("seq")&&void 0!==d&&d.hasOwnProperty("seq")?a.seq-d.seq:0});g=TK.RoomEvent({type:"room-connected",
message:e});c.dispatchEvent(g);return!0},"room-disconnected":function(a){L.Logger.debug("[tk-mobile-sdk]room-disconnected");if(b)if(a=b,TK.global.initPageParameterFormPhone.playback)for(d in a)a[d].playbackLeaved=!0;else for(var d in a)delete a[d];f&&(f.publishstate=TK.PUBLISH_STATE_NONE);d=TK.RoomEvent({type:"room-disconnected"});c.dispatchEvent(d);return!0},"room-playback-clear_all":function(a){if(TK.global.initPageParameterFormPhone.playback)return L.Logger.debug("[tk-mobile-sdk]room-playback-clear_all"),
a=TK.RoomEvent({type:"room-playback-clear_all"}),c.dispatchEvent(a),!0;L.Logger.warning("[tk-mobile-sdk]room-playback-clear_all:No playback environment!")},"room-pubmsg":function(a){a=TK.RoomEvent({type:"room-pubmsg",message:a.message});c.dispatchEvent(a);return!0},"room-delmsg":function(a){a=TK.RoomEvent({type:"room-delmsg",message:a.message});c.dispatchEvent(a);return!0},"room-msglist":function(a){a=TK.RoomEvent({type:"room-msglist",message:a.message});c.dispatchEvent(a);return!0}};c.changeExtendSendInterfaceName=
function(a){TK.extendSendInterfaceName=a};TK.mobileSdkEventManager&&TK.mobileSdkEventManager.addEventListener("mobileSdk_dispatchEvent",function(a){a=a.message;var e=a.type,b=!1;d[e]&&"function"===typeof d[e]&&(b=d[e](a));b||c.dispatchEvent(a)});return c};
(function(){var c=!1;if(void 0!==window.__SDKDEV__&&null!==window.__SDKDEV__&&"boolean"===typeof window.__SDKDEV__)try{c=window.__SDKDEV__}catch(b){c=!1}if(!c){c=decodeURIComponent(window.location.href);var f=c.indexOf("?");c=c.substring(f+1).match(/(^|&)debug=([^&]*)(&|$)/i);c=null!=c?c[2]:""}window.__TkSdkBuild__=!c;window.localStorage&&window.localStorage.setItem("debug",c?"*":"none")})();var L=L||{};TK=TK||{};
L.Logger=function(c){var f="",b=!1;var a=function(a,e){try{switch(e){case c.Logger.DEBUG:b?console.warn.apply(console,a):console.debug.apply(console,a);break;case c.Logger.TRACE:console.trace.apply(console,a);break;case c.Logger.INFO:b?console.warn.apply(console,a):console.info.apply(console,a);break;case c.Logger.WARNING:console.warn.apply(console,a);break;case c.Logger.ERROR:console.error.apply(console,a);break;case c.Logger.NONE:console.warn("log level is none!");break;default:b?console.warn.apply(console,
a):console.log.apply(console,a)}}catch(k){console.log.apply(console,a)}};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogDevelopment:function(a){b=a},enableLogPanel:function(){c.Logger.panel=document.createElement("textarea");c.Logger.panel.setAttribute("id","licode-logs");c.Logger.panel.setAttribute("style","position:fixed;left:0;top:0;width: 100%; height: 100%; display: none;z-index:9999;  user-select: text ;-webkit-user-select: text; -moz-user-select: text ; -ms-user-select: text ;");
c.Logger.panel.setAttribute("rows",20);c.Logger.panel.setAttribute("cols",20);c.Logger.panel.setAttribute("readOnly",!0);"QtNativeClientRoom"===TK.SDKNATIVENAME&&(document.oncontextmenu=null,document.oncontextmenu=function(){return!0});var a=document.createElement("button");a.innerHTML="open log";a.setAttribute("style","position:fixed;left:0;top:0;z-index:10000;background:gold;");a.onclick=function(){"open log"===a.innerHTML?(c.Logger.panel.style.display="block",a.innerHTML="close log"):(c.Logger.panel.style.display=
"none",a.innerHTML="open log")};document.body.appendChild(a);document.body.appendChild(c.Logger.panel)},setLogLevel:function(a){a>c.Logger.NONE?a=c.Logger.NONE:a<c.Logger.DEBUG&&(a=c.Logger.DEBUG);c.Logger.logLevel=a},setOutputFunction:function(d){a=d},setLogPrefix:function(a){f=a},print:function(d){var e=f;if(!(d<c.Logger.logLevel)){d===c.Logger.DEBUG?e=e+"DEBUG("+(new Date).toLocaleString()+")":d===c.Logger.TRACE?e=e+"TRACE("+(new Date).toLocaleString()+")":d===c.Logger.INFO?e=e+"INFO("+(new Date).toLocaleString()+
")":d===c.Logger.WARNING?e=e+"WARNING("+(new Date).toLocaleString()+")":d===c.Logger.ERROR&&(e=e+"ERROR("+(new Date).toLocaleString()+")");e+=":";for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];b=b.slice(1);b=[e].concat(b);if(void 0!==c.Logger.panel){e="";for(g=0;g<b.length;g++)e+="object"===typeof b[g]?c.Utils.toJsonStringify(b[g]):b[g];c.Logger.panel.value=c.Logger.panel.value+"\n"+e}a.apply(c.Logger,[b,d])}},debug:function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];c.Logger.print.apply(c.Logger,
[c.Logger.DEBUG].concat(a))},trace:function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];c.Logger.print.apply(c.Logger,[c.Logger.TRACE].concat(a))},info:function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];c.Logger.print.apply(c.Logger,[c.Logger.INFO].concat(a))},warning:function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];c.Logger.print.apply(c.Logger,[c.Logger.WARNING].concat(a))},error:function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];
c.Logger.print.apply(c.Logger,[c.Logger.ERROR].concat(a))}}}(L);
TK.tkLogPrintConfig=function(c,f,b){f=f||{};c=c||{};b=b||{};TK&&TK.global&&TK.global.initPageParameterFormPhone&&TK.global.initPageParameterFormPhone.debugLog&&(c.debug=!0,f.development=!0,f.logLevel=0,b.webrtcLogDebug=!0);var a=void 0!=f.logLevel?f.logLevel:0;c=void 0!=c.debug?c.debug:!0;b=void 0!=b.webrtcLogDebug?b.webrtcLogDebug:!0;L.Logger.setLogDevelopment(void 0!=f.development?f.development:!0);L.Logger.setLogLevel(a);window.localStorage&&window.localStorage.setItem("debug",c?"*":"none");window.webrtcLogDebug=
b};L=L||{};L.Constant=function(){return{mClientType:{flash:0,pc:1,ios:2,andriod:3},IOS:"ios",ANDRIOD:"andriod"}}(L);L=L||{};L.aexInstance=void 0;
(function(){var c={cipher:function(a,d){for(var e=d.length/4-1,b=[[],[],[],[]],g=0;16>g;g++)b[g%4][Math.floor(g/4)]=a[g];b=c.addRoundKey(b,d,0,4);for(g=1;g<e;g++)b=c.subBytes(b,4),b=c.shiftRows(b,4),b=c.mixColumns(b,4),b=c.addRoundKey(b,d,g,4);b=c.subBytes(b,4);b=c.shiftRows(b,4);b=c.addRoundKey(b,d,e,4);d=Array(16);for(g=0;16>g;g++)d[g]=b[g%4][Math.floor(g/4)];return d},keyExpansion:function(a){for(var d=a.length/4,b=d+6,k=Array(4*(b+1)),g=Array(4),f=0;f<d;f++)k[f]=[a[4*f],a[4*f+1],a[4*f+2],a[4*
f+3]];for(f=d;f<4*(b+1);f++){k[f]=Array(4);for(a=0;4>a;a++)g[a]=k[f-1][a];if(0==f%d)for(g=c.subWord(c.rotWord(g)),a=0;4>a;a++)g[a]^=c.rCon[f/d][a];else 6<d&&4==f%d&&(g=c.subWord(g));for(a=0;4>a;a++)k[f][a]=k[f-d][a]^g[a]}return k},subBytes:function(a,d){for(var b=0;4>b;b++)for(var f=0;f<d;f++)a[b][f]=c.sBox[a[b][f]];return a},shiftRows:function(a,d){for(var b=Array(4),c=1;4>c;c++){for(var g=0;4>g;g++)b[g]=a[c][(g+c)%d];for(g=0;4>g;g++)a[c][g]=b[g]}return a},mixColumns:function(a,b){for(b=0;4>b;b++){for(var d=
Array(4),c=Array(4),g=0;4>g;g++)d[g]=a[g][b],c[g]=a[g][b]&128?a[g][b]<<1^283:a[g][b]<<1;a[0][b]=c[0]^d[1]^c[1]^d[2]^d[3];a[1][b]=d[0]^c[1]^d[2]^c[2]^d[3];a[2][b]=d[0]^d[1]^c[2]^d[3]^c[3];a[3][b]=d[0]^c[0]^d[1]^d[2]^c[3]}return a},addRoundKey:function(a,b,e,c){for(var d=0;4>d;d++)for(var f=0;f<c;f++)a[d][f]^=b[4*e+f][d];return a},subWord:function(a){for(var b=0;4>b;b++)a[b]=c.sBox[a[b]];return a},rotWord:function(a){for(var b=a[0],e=0;3>e;e++)a[e]=a[e+1];a[3]=b;return a},sBox:[99,124,119,123,242,107,
111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,
34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],rCon:[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,
0,0,0]],Ctr:{}};c.Ctr.encrypt=function(a,d,e){d=d||"talk_2018_@beijing_20180310_talk_2018_@beijing";e=e||256;if(128!=e&&192!=e&&256!=e)return"";a=b.encode(a);d=b.encode(d);var k=e/8,g=Array(k);for(e=0;e<k;e++)g[e]=isNaN(d.charCodeAt(e))?0:d.charCodeAt(e);g=c.cipher(g,c.keyExpansion(g));g=g.concat(g.slice(0,k-16));d=Array(16);e=(new Date).getTime();k=e%1E3;var h=Math.floor(e/1E3),l=Math.floor(65535*Math.random());for(e=0;2>e;e++)d[e]=k>>>8*e&255;for(e=0;2>e;e++)d[e+2]=l>>>8*e&255;for(e=0;4>e;e++)d[e+
4]=h>>>8*e&255;k="";for(e=0;8>e;e++)k+=String.fromCharCode(d[e]);g=c.keyExpansion(g);h=Math.ceil(a.length/16);l=Array(h);for(var m=0;m<h;m++){for(e=0;4>e;e++)d[15-e]=m>>>8*e&255;for(e=0;4>e;e++)d[15-e-4]=m/4294967296>>>8*e;var n=c.cipher(d,g),q=m<h-1?16:(a.length-1)%16+1,r=Array(q);for(e=0;e<q;e++)r[e]=n[e]^a.charCodeAt(16*m+e),r[e]=String.fromCharCode(r[e]);l[m]=r.join("")}a=k+l.join("");return a=f.encode(a)};c.Ctr.decrypt=function(a,d,e){d=d||"talk_2018_@beijing_20180310_talk_2018_@beijing";e=e||
256;if(128!=e&&192!=e&&256!=e)return"";a=f.decode(a);d=b.encode(d);var k=e/8,g=Array(k);for(e=0;e<k;e++)g[e]=isNaN(d.charCodeAt(e))?0:d.charCodeAt(e);g=c.cipher(g,c.keyExpansion(g));g=g.concat(g.slice(0,k-16));d=Array(8);k=a.slice(0,8);for(e=0;8>e;e++)d[e]=k.charCodeAt(e);k=c.keyExpansion(g);g=Math.ceil((a.length-8)/16);e=Array(g);for(var h=0;h<g;h++)e[h]=a.slice(8+16*h,16*h+24);a=e;var l=Array(a.length);for(h=0;h<g;h++){for(e=0;4>e;e++)d[15-e]=h>>>8*e&255;for(e=0;4>e;e++)d[15-e-4]=(h+1)/4294967296-
1>>>8*e&255;var m=c.cipher(d,k),n=Array(a[h].length);for(e=0;e<a[h].length;e++)n[e]=m[e]^a[h].charCodeAt(e),n[e]=String.fromCharCode(n[e]);l[h]=n.join("")}a=l.join("");return a=b.decode(a)};var f={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",encode:function(a,b){var d=[],c="",g=f.code;b=("undefined"==typeof b?0:b)?a.encodeUTF8():a;a=b.length%3;if(0<a)for(;3>a++;)c+="\x3d",b+="\x00";for(a=0;a<b.length;a+=3){var h=b.charCodeAt(a);var l=b.charCodeAt(a+1);var m=b.charCodeAt(a+
2);var n=h<<16|l<<8|m;h=n>>18&63;l=n>>12&63;m=n>>6&63;n&=63;d[a/3]=g.charAt(h)+g.charAt(l)+g.charAt(m)+g.charAt(n)}d=d.join("");return d=d.slice(0,d.length-c.length)+c},decode:function(a,b){b="undefined"==typeof b?!1:b;var d=[],c=f.code;var g=b?a.decodeUTF8():a;for(var h=0;h<g.length;h+=4){var l=c.indexOf(g.charAt(h));var m=c.indexOf(g.charAt(h+1));a=c.indexOf(g.charAt(h+2));var n=c.indexOf(g.charAt(h+3));var q=l<<18|m<<12|a<<6|n;l=q>>>16&255;m=q>>>8&255;q&=255;d[h/4]=String.fromCharCode(l,m,q);64==
n&&(d[h/4]=String.fromCharCode(l,m));64==a&&(d[h/4]=String.fromCharCode(l))}d=d.join("");return b?d.decodeUTF8():d}},b={encode:function(a){a=a.replace(/[\u0080-\u07ff]/g,function(a){a=a.charCodeAt(0);return String.fromCharCode(192|a>>6,128|a&63)});return a=a.replace(/[\u0800-\uffff]/g,function(a){a=a.charCodeAt(0);return String.fromCharCode(224|a>>12,128|a>>6&63,128|a&63)})},decode:function(a){a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&15)<<12|(a.charCodeAt(1)&
63)<<6|a.charCodeAt(2)&63;return String.fromCharCode(a)});return a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&31)<<6|a.charCodeAt(1)&63;return String.fromCharCode(a)})}};L.aexInstance=c.Ctr})();
L.Utils=function(){var c=void 0,f=!1,b=!1;c={handleMediaPlayOnEvent:function(a,b){try{if(L.Utils.removeEvent(a,"canplay",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadedmetadata",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadeddata",c.handleMediaPlayOnEvent.bind(null,a,b)),a&&a.play&&"function"===typeof a.play){var d=a.play();d&&d.catch&&"function"===typeof d.catch&&d.catch(function(d){L.Logger.error("[tk-sdk]media play err:",L.Utils.toJsonStringify(d),
b?" , media element id is "+b:" media element:",b?"":a)})}}catch(k){L.Logger.error("[tk-sdk]media play error:",L.Utils.toJsonStringify(k),b?" , media element id is "+b:" media element:",b?"":a)}},handleMediaPauseOnEvent:function(a,b){try{if(L.Utils.removeEvent(a,"canplay",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadedmetadata",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadeddata",c.handleMediaPauseOnEvent.bind(null,a,b)),a&&a.pause&&"function"===typeof a.pause){var d=
a.pause();d&&d.catch&&"function"===typeof d.catch&&d.catch(function(d){L.Logger.error("[tk-sdk]media pause err:",L.Utils.toJsonStringify(d),b?" , media element id is "+b:" media element:",b?"":a)})}}catch(k){L.Logger.error("[tk-sdk]media pause error:",L.Utils.toJsonStringify(k),b?" , media element id is "+b:" media element:",b?"":a)}}};return{addEvent:function(a,b,c,f){a.addEventListener?a.addEventListener(b,c,void 0!=f&&null!=f?f:!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},removeEvent:function(a,
b,c,f){a.removeEventListener?a.removeEventListener(b,c,void 0!=f&&null!=f?f:!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null},toJsonStringify:function(a,b){if(void 0!=b&&!b||!a)return a;try{if("object"!==typeof a)return a;var d=JSON.stringify(a);d?a=d:L.Logger.debug("[tk-sdk]toJsonStringify:data is not json!")}catch(k){L.Logger.debug("[tk-sdk]toJsonStringify:data is not json!")}return a},toJsonParse:function(a,b){if(void 0!=b&&!b||!a)return a;try{if("string"!==typeof a)return a;var d=JSON.parse(a);
d?a=d:L.Logger.debug("[tk-sdk]toJsonParse:data is not json string!")}catch(k){L.Logger.debug("[tk-sdk]toJsonParse:data is not json string!")}return a},encrypt:function(a,b,c,f){if(!a)return a;c=c||TK.hexEncryptDecryptKey;f=f||TK.hexEncryptDecryptBit;b=void 0!=b?b:"talk_2018_@beijing";a=L.aexInstance.encrypt(a,c,f);return b+a+b},decrypt:function(a,b,c,f){if(!a)return a;c=c||TK.hexEncryptDecryptKey;f=f||TK.hexEncryptDecryptBit;a=a.replace(new RegExp(void 0!=b?b:"talk_2018_@beijing","gm"),"");return L.aexInstance.decrypt(a,
c,f)},mediaPlay:function(a){var b=void 0;a&&"string"===typeof a?a=document.getElementById(a):a&&/(audio|video)/g.test(a.nodeName.toLowerCase())&&a.getAttribute&&"function"===typeof a.getAttribute&&(b=a.getAttribute("id"));a&&/(audio|video)/g.test(a.nodeName.toLowerCase())&&(0!==a.readyState?c.handleMediaPlayOnEvent(a,b):(L.Utils.removeEvent(a,"canplay",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadedmetadata",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadeddata",
c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"canplay",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"loadedmetadata",c.handleMediaPlayOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"loadeddata",c.handleMediaPlayOnEvent.bind(null,a,b))))},mediaPause:function(a){var b=void 0;a&&"string"===typeof a?a=document.getElementById(a):a&&/(audio|video)/g.test(a.nodeName.toLowerCase())&&a.getAttribute&&"function"===typeof a.getAttribute&&(b=a.getAttribute("id"));a&&/(audio|video)/g.test(a.nodeName.toLowerCase())&&
(0!==a.readyState?c.handleMediaPauseOnEvent(a,b):(L.Utils.removeEvent(a,"canplay",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadedmetadata",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.removeEvent(a,"loadeddata",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"canplay",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"loadedmetadata",c.handleMediaPauseOnEvent.bind(null,a,b)),L.Utils.addEvent(a,"loadeddata",c.handleMediaPauseOnEvent.bind(null,a,
b))))},localStorage:{setItem:function(a,b){try{window.localStorage?window.localStorage.setItem?window.localStorage.setItem(a,b):L.Logger.warning("[tk-sdk]Browser does not support localStorage.setItem , key is "+a+" , value is "+b+"!"):f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage!"))}catch(e){f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage , error info:",L.Utils.toJsonStringify(e)))}},getItem:function(a){try{if(window.localStorage){if(window.localStorage.getItem)return window.localStorage.getItem(a);
L.Logger.warning("[tk-sdk]Browser does not support localStorage.getItem , key is "+a+" !");return""}f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage!"));return""}catch(d){return f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage , error info:",L.Utils.toJsonStringify(d))),""}},removeItem:function(a){try{if(window.localStorage){if(window.localStorage.removeItem)return window.localStorage.removeItem(a);L.Logger.warning("[tk-sdk]Browser does not support localStorage.removeItem , key is "+
a+" !");return""}f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage!"));return""}catch(d){return f||(f=!0,L.Logger.warning("[tk-sdk]Browser does not support localStorage , error info:",L.Utils.toJsonStringify(d))),""}}},sessionStorage:{setItem:function(a,c){try{window.sessionStorage?window.sessionStorage.setItem?window.sessionStorage.setItem(a,c):L.Logger.warning("[tk-sdk]Browser does not support sessionStorage.setItem , key is "+a+" , value is "+c+"!"):b||(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage!"))}catch(e){b||
(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage , error info:",L.Utils.toJsonStringify(e)))}},getItem:function(a){try{if(window.sessionStorage){if(window.sessionStorage.getItem)return window.sessionStorage.getItem(a);L.Logger.warning("[tk-sdk]Browser does not support sessionStorage.getItem , key is "+a+" !");return""}b||(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage!"));return""}catch(d){return b||(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage , error info:",
L.Utils.toJsonStringify(d))),""}},removeItem:function(a){try{if(window.sessionStorage){if(window.sessionStorage.removeItem)return window.sessionStorage.removeItem(a);L.Logger.warning("[tk-sdk]Browser does not support sessionStorage.removeItem , key is "+a+" !");return""}b||(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage!"));return""}catch(d){return b||(b=!0,L.Logger.warning("[tk-sdk]Browser does not support sessionStorage , error info:",L.Utils.toJsonStringify(d))),""}}}}}(L);TK=TK||{};TK.extendSendInterfaceName="";var MOBILETKSDK=MOBILETKSDK||{};TK.temporary=TK.temporary||{callbackMap:{}};TK.constant=TK.constant||{};TK.global=TK.global||{initPageParameterFormPhone:{mClientType:null,serviceUrl:{address:null,port:null},backupServiceUrl:{address:null,port:null},phpServiceUrl:{address:null,port:null},deviceType:null,role:null,playback:!1,isSendLogMessageToProtogenesis:!1,debugLog:!1,appType:void 0}};TK.variable=TK.variable||{};
(function(){var c=0,f={};MOBILETKSDK.receiveInterface=MOBILETKSDK.receiveInterface||{dispatchEvent:function(b){MOBILETKSDK.sendInterface.logMessage({method:"dispatchEvent",recvEventData:b});b=L.Utils.toJsonParse(b);TK.mobileSdkEventManager.dispatchEvent({type:"mobileSdk_dispatchEvent",message:b},!1)},setInitPageParameterFormPhone:function(b){MOBILETKSDK.sendInterface.logMessage({method:"setInitPageParameterFormPhone",data:b});b=L.Utils.toJsonParse(b);if(!TK.global.isLoadInitPageParameterFormPhone){TK.global.isLoadInitPageParameterFormPhone=
!0;for(var a in b)"playback"!==a&&"debugLog"!==a||"number"!==typeof b[a]||(b[a]=0!==b[a]),TK.global.initPageParameterFormPhone[a]=b[a];TK&&TK.global&&TK.global.initPageParameterFormPhone&&TK.global.initPageParameterFormPhone.debugLog&&TK.tkLogPrintConfig();TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_setInitPageParameterFormPhone",message:b})}},changeInitPageParameterFormPhone:function(b){MOBILETKSDK.sendInterface.logMessage({method:"changeInitPageParameterFormPhone",changeInitJson:b});
b=L.Utils.toJsonParse(b);for(var a in b)TK.global.initPageParameterFormPhone[a]=b[a];TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_changeInitPageParameterFormPhone",message:b})},changeDynamicPptSize:function(b){MOBILETKSDK.sendInterface.logMessage({method:"changeDynamicPptSize",data:b});b=L.Utils.toJsonParse(b);TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_changeDynamicPptSize",message:b})},closeDynamicPptWebPlay:function(){MOBILETKSDK.sendInterface.logMessage({method:"closeDynamicPptWebPlay"});
TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_closeDynamicPptWebPlay"})},receiveActionCommand:function(b,a){MOBILETKSDK.sendInterface.logMessage({method:"receiveActionCommand",action:b,cmd:a});a=L.Utils.toJsonParse(a);TK.mobileSdkEventManager.dispatchEvent({type:"mobileSdk_dispatchEvent",message:{type:"room-receiveActionCommand",message:{action:b,cmd:a}}},!1)},executeWebCallback:function(b){MOBILETKSDK.sendInterface.logMessage({method:"executeWebCallback",callbackJson:b});b=L.Utils.toJsonParse(b);
var a=b.callbackId;a?TK.temporary.callbackMap[a]&&"function"===typeof TK.temporary.callbackMap[a]?(b.data&&"string"===typeof b.data&&(b.data=L.Utils.toJsonParse(b.data)),TK.temporary.callbackMap[a](b.data)):L.Logger.info("[tk-mobile-sdk]executeWebCallback:callbackMap[callbackId]  is not exist or not's function , callbackJson:"+L.Utils.toJsonStringify(b)+"!"):L.Logger.info("[tk-mobile-sdk]executeWebCallback:callbackId is not exist , callbackJson:"+L.Utils.toJsonStringify(b)+"!")},fullScreenChangeCallback:function(b){MOBILETKSDK.sendInterface.logMessage({method:"fullScreenChangeCallback",
isFullScreen:b});"number"===typeof b&&(b=0!==b);TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_fullScreenChangeCallback",message:{isFullScreen:b}})},playbackPlayAndPauseController:function(b){TK.global.initPageParameterFormPhone.playback&&(MOBILETKSDK.sendInterface.logMessage({method:"playbackPlayAndPauseController",play:b}),"number"===typeof b&&(b=0!==b),TK.mobileUICoreEventManager.dispatchEvent({type:"mobileSdk_playbackPlayAndPauseController",message:{play:b}}))},JsSocketCallback:function(b,
a){if(f[b]){if("function"===typeof f[b])f[b](a);delete f[b]}}};MOBILETKSDK.sendInterface=MOBILETKSDK.sendInterface||{interface:function(b,a,c){if(TK.global.initPageParameterFormPhone)switch(c=c||TK.global.initPageParameterFormPhone.mClientType,c){case L.Constant.mClientType.ios:window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[b]?(a=a||"",L.Logger.debug("[tk-mobile-sdk]interface:window.webkit.messageHandlers."+b+".postMessage has been performed!"),window.webkit.messageHandlers[b].postMessage({data:a})):
L.Logger.error("[tk-mobile-sdk]interface:window.webkit.messageHandlers."+b+".postMessage is not exist!");break;case L.Constant.mClientType.andriod:"_videoWhiteboardPage"===TK.extendSendInterfaceName?window.JSVideoWhitePadInterface&&window.JSVideoWhitePadInterface[b]?(L.Logger.debug("[tk-mobile-sdk]interface:window.JSVideoWhitePadInterface."+b+" has been performed!"),window.JSVideoWhitePadInterface[b](a)):L.Logger.error("[tk-mobile-sdk]interface:window.JSVideoWhitePadInterface."+b+" is not exist!"):
window.JSWhitePadInterface&&window.JSWhitePadInterface[b]?(L.Logger.debug("[tk-mobile-sdk]interface:window.JSWhitePadInterface."+b+" has been performed!"),window.JSWhitePadInterface[b](a)):L.Logger.error("[tk-mobile-sdk]interface:window.JSWhitePadInterface."+b+" is not exist!");break;default:L.Logger.error("[tk-mobile-sdk]clientType not in sdk , will not be able to execute method(window.JSWhitePadInterface."+b+")")}},getInfoBaseInterface:function(b,a,c){if(a&&"function"===typeof a){var d=b+"_"+(new Date).getTime()+
"_"+Math.round(1E6*Math.random());TK.temporary.callbackMap[d]=a;a={callbackId:d};if(c&&"object"===typeof c)for(var f in c)a[f]=c[f];a=L.Utils.toJsonStringify(a);MOBILETKSDK.sendInterface.interface(b,a)}else L.Logger.error("[tk-mobile-sdk]"+b+" callback is not exist or not's function!")},logMessage:function(b,a){if(TK.global.initPageParameterFormPhone){b=L.Utils.toJsonStringify(b);switch(a){case L.Constant.IOS:var c=L.Constant.mClientType.ios;break;case L.Constant.ANDRIOD:c=L.Constant.mClientType.andriod;
break;default:c=TK.global.initPageParameterFormPhone.mClientType,a=c===L.Constant.mClientType.andriod?L.Constant.ANDRIOD:c===L.Constant.mClientType.ios?L.Constant.IOS:"unknown"}L.Logger.debug("[tk-mobile-sdk]logMessage info ,  clientType:"+a+" , mClientType:"+c+" , message:"+b);c===TK.global.initPageParameterFormPhone.mClientType&&TK.global.initPageParameterFormPhone.isSendLogMessageToProtogenesis&&MOBILETKSDK.sendInterface.interface("printLogMessage"+TK.extendSendInterfaceName,L.Utils.toJsonStringify({msg:b}),
c)}},dynamicPptVideoAutoPlay:function(b){b=L.Utils.toJsonStringify(b);MOBILETKSDK.sendInterface.interface("onJsPlay"+TK.extendSendInterfaceName,b)},changeWebPageFullScreen:function(b){MOBILETKSDK.sendInterface.interface("changeWebPageFullScreen"+TK.extendSendInterfaceName,b)},onPageFinished:function(){var b=void 0;window.JSWhitePadInterface||window.JSVideoWhitePadInterface?b=L.Constant.mClientType.andriod:window.webkit&&window.webkit.messageHandlers&&(b=L.Constant.mClientType.ios);MOBILETKSDK.sendInterface.interface("onPageFinished"+
TK.extendSendInterfaceName,void 0,b)},pubMsg:function(b){if(1===arguments.length&&b&&"object"===typeof b){var a=b.msgName;var c=b.msgId;var e=b.toId;var f=b.data;var g=b.save;var h=b.expiresabs;var l=b.associatedMsgID;var m=b.associatedUserID;var n=b.expires;var q=b.type;var r=b.write2DB;var t=b.actions;var u=b.do_not_replace}else a=arguments[0],c=arguments[1],e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],l=arguments[6],m=arguments[7],n=arguments[8],q=arguments[9],r=arguments[10],t=
arguments[11],u=arguments[12];var p={};p.signallingName=a;p.id=c;p.toID=e;p.data=f;g||(p.do_not_save="");if(void 0!==n){if("number"!==typeof n){L.Logger.error("[tk-mobile-sdk]pubMsg params expires must is number!");return}p.expires=n}if(void 0!==h){if("number"!==typeof h){L.Logger.error("[tk-mobile-sdk]pubMsg params expiresabs must is number!");return}p.expiresabs=h}void 0!==l&&(p.associatedMsgID=l);void 0!==m&&(p.associatedUserID=m);if("count"===q)p.type=q;else if(void 0!==q)return L.Logger.error("[tk-sdk]pubMsg params type error!");
void 0!==r&&"boolean"===typeof r&&(p.write2DB=r);if(void 0!==t&&Array.isArray(t)&&void 0!==l)p.actions=t;else if(void 0!==t&&Array.isArray(t)&&void 0===l)return L.Logger.error("[tk-sdk]pubMsg params actions depend on associatedMsgID, but associatedMsgID not defined!");void 0!==u&&(p.do_not_replace=u);p=L.Utils.toJsonStringify(p);MOBILETKSDK.sendInterface.interface("pubMsg"+TK.extendSendInterfaceName,p)},delMsg:function(b){if(1===arguments.length&&b&&"object"===typeof b){var a=b.msgName;var c=b.msgId;
var e=b.toId;var f=b.data}else a=arguments[0],c=arguments[1],e=arguments[2],f=arguments[3];var g={};g.signallingName=a;g.id=c;g.toID=e;g.data=f;g=L.Utils.toJsonStringify(g);MOBILETKSDK.sendInterface.interface("delMsg"+TK.extendSendInterfaceName,g)},changeUserProperty:function(b,a,c){if(void 0===c||void 0===b)L.Logger.error("[tk-mobile-sdk]changeUserProperty properties or id is not exist!");else{var d={};d.id=b;d.toID=a||"__all";c&&"object"===typeof c?(d.properties=c,d=L.Utils.toJsonStringify(d),MOBILETKSDK.sendInterface.interface("setProperty"+
TK.extendSendInterfaceName,d)):L.Logger.error("[tk-mobile-sdk]properties must be json , user id: "+b+"!")}},setLocalStorageItem:function(b,a){void 0!==b&&void 0!==a&&(b={key:""+b,value:""+a},b=L.Utils.toJsonStringify(b),MOBILETKSDK.sendInterface.interface("saveValueByKey"+TK.extendSendInterfaceName,b))},getLocalStorageItem:function(b,a){if(void 0!==b&&"function"===typeof a){var d=++c;f[d]=a;b={key:""+b,callbackID:d};b=L.Utils.toJsonStringify(b);MOBILETKSDK.sendInterface.interface("getValueByKey"+
TK.extendSendInterfaceName,b)}}}})();
