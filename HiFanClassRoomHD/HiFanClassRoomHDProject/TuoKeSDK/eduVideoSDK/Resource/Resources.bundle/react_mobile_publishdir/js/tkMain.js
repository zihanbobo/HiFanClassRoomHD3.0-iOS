webpackJsonp([1],{"/Ml/":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("HUPQ"),f=n(g),p=a("GiK3"),v=n(p),b=a("T+56"),y=n(b),S=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.state={alert:{isShow:!1,ok:"",type:""},confirm:{isShow:!1},isHasClassCenter:!1,title:"",message:"",callback:null},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this;y.default.CoreController.addEventListener("showAlert",e.showAlert.bind(e),e.listernerBackupid),y.default.CoreController.addEventListener("showConfirm",e.showConfirm.bind(e),e.listernerBackupid),y.default.CoreController.addEventListener("showInputTooltip",e.showInputTooltip.bind(e),self.listernerBackupid)}},{key:"componentWillUnmount",value:function(){y.default.CoreController.removeBackupListerner(this.listernerBackupid)}},{key:"alertCloseClick",value:function(e){this.setState({isHasClassCenter:!1,alert:{isShow:!1},confirm:{isShow:!1}}),e(!0)}},{key:"confirmClick",value:function(e){var t={text:this.refs.subNode_1?this.refs.subNode_1.value:void 0,href:this.refs.subNode_2?this.refs.subNode_2.value:void 0};this.setState({isHasClassCenter:!1,alert:{isShow:!1},confirm:{isShow:!1}}),e(!0,t)}},{key:"cancelClick",value:function(e){this.setState({isHasClassCenter:!1,alert:{isShow:!1},confirm:{isShow:!1}}),e(!1)}},{key:"showAlert",value:function(e){var t=e.message.data,a=t.title,n=t.message,i=t.ok,r=t.callback,s=t.type;this.setState({alert:{isShow:!0,ok:i,type:s},confirm:{isShow:!1},title:a,message:n,callback:r,isHasClassCenter:!0})}},{key:"showConfirm",value:function(e){var t=e.message.data,a=t.title,n=t.message,i=t.isOk,r=t.callback;this.setState({alert:{isShow:!1},confirm:{isShow:!0,isOk:i},title:a,message:n,callback:r,isHasClassCenter:!0})}},{key:"showInputTooltip",value:function(e){var t=e.data,a=t.title,n=t.message,i=t.isOk,r=t.callback,s=t.contentType;this.setState({alert:{isShow:!1},confirm:{isShow:!0,isOk:i},title:a,message:n,callback:r,isHasClassCenter:!0,contentType:s})}},{key:"__loadContent",value:function(){var e=this,t=void 0;if(e.state.message)t=e.state.message;else if(e.state.contentType)switch(e.state.contentType){case"edit-text-area":t=v.default.createElement("div",{className:"edit-node"},v.default.createElement("textarea",{ref:"subNode_1",name:"",id:"",cols:"50",rows:"6",maxLength:"50"}));break;case"edit-input":t=v.default.createElement("div",{className:"edit-node"},v.default.createElement("label",{htmlFor:""},f.default.language.languageData.notice.content,":"),v.default.createElement("input",{ref:"subNode_1",type:"text",style:{marginLeft:".08rem"},maxLength:"20"}));break;case"edit-input-db":t=v.default.createElement("div",{className:"edit-node"},v.default.createElement("label",{htmlFor:""},f.default.language.languageData.notice.content,":"),v.default.createElement("input",{ref:"subNode_1",type:"text",style:{marginLeft:".22rem",marginBottom:".3rem"},maxLength:"30"}),v.default.createElement("br",null),v.default.createElement("label",{htmlFor:""},f.default.language.languageData.notice.href,":"),v.default.createElement("input",{ref:"subNode_2",type:"text",style:{marginLeft:".08rem"},maxLength:"50"}));break;default:L.Logger.error("This content type has not defined, please check out and define this content!")}return{content:t}}},{key:"render",value:function(){var e=this,t=this.state,a=t.alert,n=t.confirm,i=t.isHasClassCenter,r=t.title,s=(t.message,t.callback),o=e.__loadContent(),l=o.content;return v.default.createElement("section",{id:"alert-error-confrim",className:"alert-error-confrim "+(a.isShow?"error"===a.type?" error-message":" prompt-message":""),style:{display:a.isShow||n.isShow?"block":"none"}},v.default.createElement("div",{id:"alert-box",className:"alert-box "+(i?"center ":"")},v.default.createElement("div",{className:"alert-title"},v.default.createElement("p",{className:"title-text"},r),a.isShow?v.default.createElement("button",{onClick:e.alertCloseClick.bind(e,s),className:"title-close",id:"title-close"}):""),v.default.createElement("div",{className:"alert-contant"},l),v.default.createElement("div",{className:"alert-isOk"},v.default.createElement("button",{id:"alert-confrim",onClick:a.isShow?e.alertCloseClick.bind(e,s):n.isShow?e.confirmClick.bind(e,s):void 0},a.isShow?a.ok:n.isShow?n.isOk.ok:""),n.isShow?v.default.createElement("button",{id:"alert-cancel",onClick:e.cancelClick.bind(e,s),className:"alert-cancel"},n.isOk.cancel):"")))}}]),t}(v.default.Component);t.default=S},0:function(e,t,a){e.exports=a("6G9P")},"0jvK":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("pFYg"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("T+56"),c=n(u),h=function(){function e(){(0,o.default)(this,e),this.permissionsJson=this.productionDefaultAppAppPermissions()}return(0,d.default)(e,[{key:"productionDefaultAppAppPermissions",value:function(){return{canDraw:!1,whiteboardPagingPage:!1,newpptPagingPage:!1,h5DocumentPagingPage:!1,h5DocumentActionClick:!1,dynamicPptActionClick:!1,pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,sendSignallingFromWBPageCount:!1,sendSignallingFromSharpsChange:!1,sendSignallingFromShowPage:!1,sendSignallingFromDynamicPptShowPage:!1,sendSignallingFromPptVolumeControl:!1,sendSignallingFromH5ShowPage:!1,sendSignallingFromGeneralShowPage:!1,sendSignallingFromDynamicPptTriggerActionClick:!1,sendSignallingFromH5DocumentAction:!1,sendSignallingFromVideoDraghandle:!1,sendSignallingFromBlackBoardDrag:!1,allUserTools:!1,laser:!1,publishDynamicPptMediaPermission_video:!1,sendWhiteboardMarkTool:!1,jumpPage:!1,sendSignallingFromBlackBoard:!1,sendSignallingTimerToStudent:!1,sendSignallingDialToStudent:!1,sendSignallingDataStudentToTeacherAnswer:!0,studentInit:!1,dialIconClose:!1,sendSignallingAnswerToStudent:!1,sendSignallingQiangDaQi:!1,sendSignallingQiangDaZhe:!0,sendSignallingFromDialDrag:!1,isSendSignallingFromTimerDrag:!1,isSendSignallingFromAnswerDrag:!1,isSendSignallingFromResponderDrag:!1,isShowCoursewareRemarks:!1,isSendSignallingFromCaptureImg:!1,canDragCaptureImg:!1,isSendSignallingFromCaptureImgDrag:!1,canResizeCaptureImg:!1,isSendCaptureImgResize:!1,sendSignallingFromRemoteControl:!1}}},{key:"resetDefaultAppPermissions",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;t.permissionsJson=t.productionDefaultAppAppPermissions(),e&&c.default.CoreController.dispatchEvent({type:"initAppPermissions",message:{data:t.permissionsJson}})}},{key:"resetAppPermissions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;e&&"object"===(void 0===e?"undefined":(0,r.default)(e))&&(Object.customAssign(a.permissionsJson,e),t&&c.default.CoreController.dispatchEvent({type:"resetAppPermissions",message:{data:a.permissionsJson}}))}},{key:"setAppPermissions",value:function(e,t){var a=this;if(a.permissionsJson[e]!==t){L.Logger.debug("setAppPermissions key and value:",e,t,"old appPermissions:",a.permissionsJson[e]),a.permissionsJson[e]=t;var n={type:"updateAppPermissions_"+e,message:{key:e,value:t}};c.default.CoreController.dispatchEvent(n)}}},{key:"getAppPermissions",value:function(e){return this.permissionsJson[e]}},{key:"initAppPermissions",value:function(e){L.Logger.debug("initAppPermissions data:",e);var t=this;for(var a in e)t.permissionsJson[a]=e[a];Object.customAssign(t.permissionsJson,e),t.permissionsJson=e,c.default.CoreController.dispatchEvent({type:"initAppPermissions",message:{data:t.permissionsJson}})}}]),e}(),m=new h;t.default=m},"0lA4":function(e,t){},"0quu":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("lHA8"),r=n(i),s=a("c/Tr"),o=n(s),l=a("BO1k"),d=n(l),u=a("Zx67"),c=n(u),h=a("Zrlr"),m=n(h),g=a("wxAW"),f=n(g),p=a("zwoO"),v=n(p),b=a("Pf15"),y=n(b),S=a("GiK3"),k=n(S),w=a("O27J"),C=n(w),T=a("HUPQ"),P=n(T),A=a("VSuD"),D=n(A),_=a("DrPG"),E=(n(_),a("T+56")),I=n(E),x=a("Sa83"),B=(n(x),a("yE5a")),R=n(B),L=a("YRCL"),N=n(L),W=a("EXAz"),M=n(W),F=function(e){function t(e){(0,m.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return a.state={optionUl:"",initArr:[],brr:[],allResult:"",allResultX:"",allResultHover:"",crr:[],trueSelect:"",answerTeachWrapDiv:"none",resultStudentDisplay:null,beginStyle:null,lisStyle:!1,flag:null,resultTeachStyleDisplay:null,changeOneAnswerStyle:"none",mySelect:"",trueLV:0,allNumbers:0,afterArrayA:[],afterArrayB:[],afterArrayC:[],afterArrayD:[],afterArrayE:[],afterArrayF:[],afterArrayG:[],afterArrayH:[],allStudentNameA:[],allStudentNameB:[],allStudentNameC:[],allStudentNameD:[],allStudentNameE:[],allStudentNameF:[],allStudentNameG:[],allStudentNameH:[],liA:"hidden",liB:"hidden",liC:"hidden",liD:"hidden",liE:"hidden",liF:"hidden",liG:"hidden",liH:"hidden",idA:[],idB:[],idC:[],idD:[],idE:[],idF:[],idG:[],idH:[],userAdmin:"",dataInit:[],trueResultDivStyle:"",teacherSendTime:"",xiangQingText:"",columnar:"",tableStyle:"",tableObject:"",userSelect:[],resizeInfo:{width:0,height:0}},a.selects=!1,a.stop=null,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,y.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=this;I.default.CoreController.addEventListener("receive-msglist-submitAnswers",e.handlerMsglistResultStudent.bind(e),e.listernerBackupid),I.default.CoreController.addEventListener(D.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),I.default.CoreController.addEventListener(D.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),I.default.CoreController.addEventListener("receive-msglist-answer",e.handlerMsglistAnswerShow.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;I.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){if(t.answerTeachWrapDiv!==this.state.answerTeachWrapDiv&&"block"===this.state.answerTeachWrapDiv||t.resultStudentDisplay!==this.state.resultStudentDisplay&&"block"===this.state.resultStudentDisplay){var a=this.props.id,n=document.getElementById(a);if(n){var i=P.default.windowInnerWidth/D.default.STANDARDSIZE;this.state.resizeInfo.width=n.offsetWidth/i,this.state.resizeInfo.height=n.offsetHeight/i,this.setState({resizeInfo:this.state.resizeInfo})}}}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!1)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"answer":D.default.hasRole.roleStudent&&t._updateAnswerShow(a);break;case"submitAnswers":D.default.hasRole.roleStudent&&t._updateSubmitAnswerShow(a)}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"ClassBegin":t.setState({answerTeachWrapDiv:"none",resultStudentDisplay:"none"});break;case"answer":t.state.userSelect=[],t.state.crr=[],t.setState({answerTeachWrapDiv:"none",resultStudentDisplay:"none",crr:t.state.crr,userSelect:t.state.userSelect})}}},{key:"handlerMsglistAnswerShow",value:function(e){var t=this,a=(e.message.answerShowArr,!0),n=!1,i=void 0;try{for(var r,s=(0,d.default)(e.message.answerShowArr);!(a=(r=s.next()).done);a=!0){var o=r.value;D.default.hasRole.roleStudent&&t._updateAnswerShow(o)}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"handlerMsglistResultStudent",value:function(e){var t=this,a=(e.message.submitAnswersArr,!0),n=!1,i=void 0;try{for(var r,s=(0,d.default)(e.message.submitAnswersArr);!(a=(r=s.next()).done);a=!0){var o=r.value;D.default.hasRole.roleStudent&&R.default.getTkRoom().getMySelf().id==o.fromID&&t._updateSubmitAnswerShow(o)}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"_updateSubmitAnswerShow",value:function(e){e.data.sendUserID==R.default.getTkRoom().getMySelf().id&&(this.state.userSelect=e.data.mySelect,this.state.initArr=e.data.optionalAnswers,this.state.crr=e.data.mySelect,this.state.userSelect.length>0?(this.state.beginStyle="#2196f3",this.state.lisStyle=!0,C.default.findDOMNode(this.refs.submitAndChange).textContent=P.default.language.languageData.answers.changeAnswer.text):(this.state.beginStyle=" ",this.state.lisStyle=!1,C.default.findDOMNode(this.refs.submitAndChange).textContent=P.default.language.languageData.answers.submitAnswer.text),this.setState({beginStyle:this.state.beginStyle,userSelect:this.state.userSelect,initArr:this.state.initArr,crr:this.state.crr}))}},{key:"_updateAnswerShow",value:function(e){var t=this;if(0==e.data.isShow){t.state.brr=e.data.rightAnswers,t.state.lisStyle=!1,t.state.answerAddStyle="hidden",t.state.answerReduceStyle="hidden",t.state.teacherSendTime=e.ts,t.state.changeOneAnswerStyle="none",C.default.findDOMNode(t.refs.submitAndChange).textContent=P.default.language.languageData.answers.submitAnswer.text,t.state.beginStyle="",t.state.initArr=e.data.optionalAnswers;var a=!0,n=!1,i=void 0;try{for(var r,s=(0,d.default)(t.state.initArr);!(a=(r=s.next()).done);a=!0)r.value.sel=!1}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}if(t.setState({answerTeachWrapDiv:"block",answerAddStyle:t.state.answerAddStyle,initArr:t.state.initArr,brr:t.state.brr,lisStyle:t.state.lisStyle,beginStyle:t.state.beginStyle,changeOneAnswerStyle:t.state.changeOneAnswerStyle,teacherSendTime:t.state.teacherSendTime}),e.data.isRound){t.state.trueLV=e.data.trueLV,t.state.allNumbers=e.data.allNumbers,t.state.dataInit=e.data.optionalAnswers,t.setState({trueLV:t.state.trueLV,allNumbers:t.state.allNumbers,dataInit:t.state.dataInit}),t.coordArr(),t.trueArr(),t.state.idA=[],t.state.idB=[],t.state.idC=[],t.state.idD=[],t.state.idE=[],t.state.idF=[],t.state.idG=[],t.state.idH=[],t.state.afterArrayA=[],t.state.afterArrayB=[],t.state.afterArrayC=[],t.state.afterArrayD=[],t.state.afterArrayE=[],t.state.afterArrayF=[],t.state.afterArrayG=[],t.state.afterArrayH=[];for(var o in e.data.dataChoose)for(var l in e.data.dataChoose[o])e.data.dataChoose[o][l].map(function(a,n){if("A"==a){t.state.idA=e.data.idAS,t.state.afterArrayA=[],t.setState({afterArray:t.state.afterArray});var i=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idA.length<13?t.state.idA.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idA.length));t.state.afterArrayA.push(i),t.setState({afterArrayA:t.state.afterArrayA,idA:t.state.idA})}if("B"==a){t.state.idB=e.data.idBS,t.state.afterArrayB=[],t.setState({afterArray:t.state.afterArray});var r=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idB.length<13?t.state.idB.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idB.length));t.state.afterArrayB.push(r),t.setState({afterArrayB:t.state.afterArrayB,idB:t.state.idB})}if("C"==a){t.state.idC=e.data.idCS,t.state.afterArrayC=[],t.setState({afterArray:t.state.afterArray});var s=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idC.length<13?t.state.idC.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idC.length));t.state.afterArrayC.push(s),t.setState({afterArrayC:t.state.afterArrayC,idC:t.state.idC})}if("D"==a){t.state.idD=e.data.idDS,t.state.afterArrayD=[];var o=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idD.length<13?t.state.idD.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idD.length));t.state.afterArrayD.push(o),t.setState({afterArrayD:t.state.afterArrayD,idD:t.state.idD})}if("E"==a){t.state.idE=e.data.idES,t.state.afterArrayE=[];var l=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idE.length<13?t.state.idE.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idE.length));t.state.afterArrayE.push(l),t.setState({afterArrayE:t.state.afterArrayE,idE:t.state.idE})}if("F"==a){t.state.idF=e.data.idFS,t.state.afterArrayF=[];var d=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idF.length<13?t.state.idF.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idF.length));t.state.afterArrayF.push(d),t.setState({afterArrayF:t.state.afterArrayF,idF:t.state.idF})}if("G"==a){t.state.idG=e.data.idGS,t.state.afterArrayG=[];var u=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idG.length<13?t.state.idG.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idG.length));t.state.afterArrayG.push(u),t.setState({afterArrayG:t.state.afterArrayG,idG:t.state.idG})}if("H"==a){t.state.idH=e.data.idHS,t.state.afterArrayH=[];var c=k.default.createElement("div",{className:"answer-stu-lis",key:n,style:{height:t.state.idH.length<13?t.state.idH.length/10+"rem":"1.2rem"}},k.default.createElement("p",null,t.state.idH.length));t.state.afterArrayH.push(c),t.setState({afterArrayH:t.state.afterArrayH,idH:t.state.idH})}});t.coordArrX(),setTimeout(function(){t.mySelectArr(t.state.userSelect)},10),document.getElementById("result-teach-mytimes").textContent=e.data.quizTimes,t.state.beginStyle="",t.state.trueResultDivStyle="hidden",t.state.columnar="block",t.state.tableStyle="none",t.state.tableObject=e.data.dataTable,C.default.findDOMNode(t.refs.submitAndChange).textContent=P.default.language.languageData.answers.submitAnswer.text,t.state.xiangQingText=P.default.language.languageData.answers.details.text,t.setState({columnar:t.state.columnar,tableStyle:t.state.tableStyle,tableObject:t.state.tableObject,resultStudentDisplay:"block",answerTeachWrapDiv:"none",beginStyle:t.state.beginStyle,trueResultDivStyle:t.state.trueResultDivStyle,xiangQingText:t.state.xiangQingText,userSelect:t.state.userSelect}),e.data.isPublished&&(t.state.trueResultDivStyle="visible",t.setState({trueResultDivStyle:t.state.trueResultDivStyle}))}else C.default.findDOMNode(t.refs.submitAndChange).textContent=P.default.language.languageData.answers.submitAnswer.text,t.state.beginStyle="",t.setState({answerTeachWrapDiv:"block",resultStudentDisplay:"none",beginStyle:t.state.beginStyle})}else t.state.crr=[],t.setState({answerTeachWrapDiv:"none",resultStudentDisplay:"none",crr:t.state.crr});I.default.CoreController.dispatchEvent({type:"resizeHandler"})}},{key:"_loadTimeDescArray",value:function(e){var t=this,a=[];return e.map(function(e,n){var i=k.default.createElement("li",{className:"answer-teach-lis",key:e.id,style:{background:t.state.initArr[n].sel?"#2196f3":null},onClick:t.changeColor.bind(t,n)},e.name);a.push(i)}),{beforeArray:a}}},{key:"_loadTableDescArray",value:function(e){var t=[];if(""!=e){var a=(0,o.default)(new r.default(this.state.brr));a=a.sort();for(var n in e){var i=n+"0",s=n+"1",l=n+"2",d=e[n][s].toString()==a.toString(),u=parseInt(e[n][l]/60)<10?"0"+parseInt(e[n][l]/60):parseInt(e[n][l]/60),c=parseInt(e[n][l]%60)<10?"0"+parseInt(e[n][l]%60):parseInt(e[n][l]%60),h=k.default.createElement("tr",{key:n},k.default.createElement("td",null,e[n][i]),k.default.createElement("td",{className:d?"table-true-result":"table-false-result"},e[n][s]),k.default.createElement("td",null,u,":",c));t.push(h)}}return{afterArry:t}}},{key:"changeColor",value:function(e,t){if(this.state.lisStyle)return!1;this.state.crr=[],this.state.crr.length=0,this.setState({crr:this.state.crr}),this.state.initArr[e].sel=!this.state.initArr[e].sel,this.setState({initArr:this.state.initArr}),0==this.state.initArr[e].sel&&(this.state.beginStyle="",this.setState({beginStyle:this.state.beginStyle}));var a=!0,n=!1,i=void 0;try{for(var s,l=(0,d.default)(this.state.initArr);!(a=(s=l.next()).done);a=!0)s.value.sel&&(this.state.beginStyle="#2196f3",this.setState({beginStyle:this.state.beginStyle}))}catch(e){n=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw i}}for(var u=0;u<this.state.initArr.length;u++)this.state.initArr[u].sel&&(this.state.crr.push(this.state.initArr[u].name),this.state.crr=(0,o.default)(new r.default(this.state.crr)),this.setState({crr:this.state.crr}));this.state.crr.length>0&&(this.state.changeOneAnswerStyle="none",this.setState({changeOneAnswerStyle:this.state.changeOneAnswerStyle}))}},{key:"beginAnswer",value:function(e){if(0==this.state.crr.length)return C.default.findDOMNode(this.refs.submitAndChange).textContent=P.default.language.languageData.answers.submitAnswer.text,this.state.changeOneAnswerStyle="block",this.setState({changeOneAnswerStyle:this.state.changeOneAnswerStyle}),!1;if(this.state.crr.length>0&&(this.state.changeOneAnswerStyle="none",this.setState({changeOneAnswerStyle:this.state.changeOneAnswerStyle})),this.state.lisStyle=!this.state.lisStyle,this.setState({lisStyle:this.state.lisStyle}),1==this.state.lisStyle){this._initSelectArr();var t=this.state.crr;this.state.userAdmin=R.default.getTkRoom().getMySelf().nickname,this.setState({userAdmin:this.state.userAdmin});var a=this.state.teacherSendTime,n=this.state.userAdmin,i=R.default.getTkRoom().getMySelf().id,r=this.state.initArr,s={mySelect:t,sendStudentName:n,sendUserID:i,times:a,optionalAnswers:r};e.target.textContent=P.default.language.languageData.answers.changeAnswer.text,N.default.sendSignallingDataStudentToTeacherAnswer(!1,s)}else{this.state.crr=[],this.state.beginStyle="#074496",this.setState({crr:this.state.crr,beginStyle:this.state.beginStyle});var o=!0,l=!1,u=void 0;try{for(var c,h=(0,d.default)(this.state.initArr);!(o=(c=h.next()).done);o=!0)c.value.sel=!1}catch(e){l=!0,u=e}finally{try{!o&&h.return&&h.return()}finally{if(l)throw u}}e.target.textContent=P.default.language.languageData.answers.submitAnswer.text}}},{key:"_initSelectArr",value:function(){this.state.crr=[],this.state.crr.length=0,this.setState({crr:this.state.crr});for(var e=0;e<this.state.initArr.length;e++)1==this.state.initArr[e].sel&&(this.state.crr.push(this.state.initArr[e].name),this.setState({crr:this.state.crr}))}},{key:"coordArrX",value:function(){var e=this;this.state.allResultX=this.state.dataInit.map(function(t,a){return"A"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayA):"B"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayB):"C"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayC):"D"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayD):"E"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayE):"F"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayF):"G"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayG):"H"==t.name?k.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},e.state.afterArrayH):void 0}),this.setState({allResultX:this.state.allResultX})}},{key:"coordArr",value:function(){this.state.allResult=this.state.dataInit.map(function(e,t){return k.default.createElement("li",{key:e.id},e.name)}),this.setState({allResult:this.state.allResult})}},{key:"trueArr",value:function(){this.state.trueSelect=this.state.brr.map(function(e,t){return k.default.createElement("span",{className:"spans",key:t},e)}),this.setState({trueSelect:this.state.trueSelect})}},{key:"mySelectArr",value:function(e){var t=(0,o.default)(new r.default(e));t=t.sort(),this.state.mySelect=t.map(function(e,t){return k.default.createElement("span",{className:"spans",key:t},e)}),this.setState({mySelect:this.state.mySelect})}},{key:"xiangQingHandel",value:function(){this.state.isXiangQing=!this.state.isXiangQing,this.setState({isXiangQing:this.state.isXiangQing}),this.state.isXiangQing?(this.state.columnar="none",this.state.tableStyle="block",this.state.xiangQingText=P.default.language.languageData.answers.statistics.text,this.setState({columnar:this.state.columnar,tableStyle:this.state.tableStyle,xiangQingText:this.state.xiangQingText})):(this.state.columnar="block",this.state.tableStyle="none",this.state.xiangQingText=P.default.language.languageData.answers.details.text,this.setState({columnar:this.state.columnar,tableStyle:this.state.tableStyle,xiangQingText:this.state.xiangQingText}))}},{key:"render",value:function(){var e=this.state,t=e.initArr,a=e.tableObject,n=e.resizeInfo;this.state.crr=(0,o.default)(new r.default(this.state.crr));var i=this._loadTimeDescArray(t),s=i.beforeArray,l=this._loadTableDescArray(a),d=l.afterArry,u=this.props,c=u.id,h=u.studentAnswerDrag,m=u.draggableData,g=Object.customAssign({id:c,size:n,percentPosition:{percentLeft:h.percentLeft,percentTop:h.percentTop}},m);return k.default.createElement(M.default,g,k.default.createElement("div",{id:c,className:"student-answer-drag",style:{position:"absolute",left:0,top:0,zIndex:130}},k.default.createElement("div",{className:"answer-teach-wrapDiv touch-select-select ",style:{display:this.state.answerTeachWrapDiv},ref:"dragBox"},k.default.createElement("div",{className:"answer-teach-header"},k.default.createElement("div",{className:"answer-teach-header-left"},k.default.createElement("span",{className:"answer-teach-headerImg"}),k.default.createElement("span",{className:"answer-teach-header-left-grey"},P.default.language.languageData.answers.headerTopLeft.text),k.default.createElement("span",{className:"answer-teach-header-left-green"},P.default.language.languageData.answers.headerMiddel.text)),k.default.createElement("div",{className:"answer-teach-header-right",style:{display:"none"}})),k.default.createElement("div",{className:"answer-teach-content"},k.default.createElement("ul",{className:"answer-teach-optionUl"},s),k.default.createElement("p",{className:"changeOneAnswer",style:{display:this.state.changeOneAnswerStyle}},P.default.language.languageData.answers.selectAnswer.text),k.default.createElement("div",{className:"answer-teach-add",style:{visibility:this.state.answerAddStyle}},"+"),k.default.createElement("div",{className:"answer-teach-reduce",style:{visibility:this.state.answerReduceStyle}},"-"),k.default.createElement("div",{className:"answer-teach-begin",onClick:this.beginAnswer.bind(this),style:{background:this.state.beginStyle},ref:"submitAndChange"},P.default.language.languageData.answers.submitAnswer.text))),k.default.createElement("div",{className:"result-teach-wrapDiv",style:{display:this.state.resultStudentDisplay},ref:"resultRef"},k.default.createElement("div",{className:"result-teach-header"},k.default.createElement("div",{className:"result-teach-header-left"},k.default.createElement("span",{className:"result-teach-headerImg"}),k.default.createElement("span",{className:"result-teach-header-left-grey"},P.default.language.languageData.answers.headerTopLeft.text),k.default.createElement("span",{id:"result-teach-mytimes",ref:"timeText"})),k.default.createElement("p",{className:"result-teach-close",style:{display:this.state.resultTeachStyleDisplay}},"  ")),k.default.createElement("div",{className:"result-teach-content"},k.default.createElement("p",{className:"answersPeople"},P.default.language.languageData.answers.numberOfAnswer.text,":",k.default.createElement("span",{ref:"ans"},this.state.allNumbers),k.default.createElement("span",{className:"xiang-qing-div",onClick:this.xiangQingHandel.bind(this)},"(",this.state.xiangQingText,")")),k.default.createElement("span",{className:"result-teach-accuracy-right"},k.default.createElement("span",{className:"result-teach-accuracy-right-text"},P.default.language.languageData.answers.tureAccuracy.text,"："),k.default.createElement("span",{style:{color:"red"}},this.state.trueLV,"%")),k.default.createElement("div",{className:"result-teach-coordinate-div",style:{display:this.state.columnar}},k.default.createElement("span",{className:"result-teach-heart-span"},"0"),k.default.createElement("div",{className:"result-teach-staff-div"},k.default.createElement("ul",{className:"result-student-allResult"},this.state.allResultX)),k.default.createElement("ul",{className:"result-teach-allResult"},this.state.allResult)),k.default.createElement("div",{className:"answer-table-div",style:{display:this.state.tableStyle}},k.default.createElement("table",{className:"answer-table"},k.default.createElement("tbody",null,k.default.createElement("tr",{className:"answer-table-first-tr"},k.default.createElement("th",null,P.default.language.languageData.answers.student.text),k.default.createElement("th",null,P.default.language.languageData.answers.TheSelectedTheAnswer.text),k.default.createElement("th",null,P.default.language.languageData.answers.AnswerTime.text)),d))),k.default.createElement("div",{className:"result-teach-true-result",style:{visibility:this.state.trueResultDivStyle}},k.default.createElement("span",{style:{color:"white"}},P.default.language.languageData.answers.trueAnswer.text,":"),k.default.createElement("span",{className:"result-teach-trueSelect"},this.state.trueSelect)),k.default.createElement("div",{className:"result-teach-true-result"},k.default.createElement("span",{style:{color:"white"}},P.default.language.languageData.answers.myAnswer.text,":"),k.default.createElement("span",{className:"result-teach-trueSelect"},this.state.mySelect))))))}}]),t}(k.default.Component);t.default=F},"292p":function(e,t){},"2KxR":function(e,t){e.exports=function(e,t,a,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(a+": incorrect invocation!");return e}},"2pGZ":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("gRE1"),r=n(i),s=a("pFYg"),o=n(s),l=a("W3Iv"),d=n(l),u=a("BO1k"),c=n(u),h=a("d7EF"),m=n(h),g=a("fZjL"),f=n(g),p=a("bOdI"),v=n(p),b=a("Zx67"),y=n(b),S=a("Zrlr"),k=n(S),w=a("wxAW"),C=n(w),T=a("zwoO"),P=n(T),A=a("Pf15"),D=n(A),_=a("GiK3"),E=n(_),I=a("T+56"),x=n(I),B=a("VSuD"),R=n(B),N=a("HUPQ"),W=n(N),M=a("YRCL"),F=n(M),O=a("yE5a"),H=n(O),U=a("6ifl"),z=n(U),j=function(e){function t(e){(0,k.default)(this,t);var a=(0,P.default)(this,(t.__proto__||(0,y.default)(t)).call(this,e));return a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.state=Object.customAssign({},a._getDefaultState(),{show:!1,moreBlackboardDrag:{pagingToolLeft:"",pagingToolTop:""}}),a.blackboardCanvasBackgroundColor=a.props.blackboardCanvasBackgroundColor||"#ffffff",a.blackboardThumbnailImageId=a.props.blackboardThumbnailImageId||"blackboardThumbnailImageId",a.associatedMsgID="BlackBoard",a.currentTapKey=void 0,a.whiteboardMagnification=16/9,a.maxBlackboardNumber=8,a}return(0,D.default)(t,e),(0,C.default)(t,[{key:"componentDidMount",value:function(){var e=this;x.default.Window.addEventListener(R.default.EVENTTYPE.WindowEvent.onResize,e.handlerOnResize.bind(e),e.listernerBackupid),x.default.Document.addEventListener(R.default.EVENTTYPE.DocumentEvent.onFullscreenchange,e.handlerOnFullscreenchange.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomParticipantJoin,e.handlerRoomParticipantJoin.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomParticipantLeave,e.handlerRoomParticipantLeave.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomDisconnected,e.handlerRoomDisconnected.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(R.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-BlackBoard",e.handlerReceive_msglist_BlackBoard.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("resizeHandler",e.handlerResizeHandler.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("isSendSignallingFromBlackBoardDrag",e.handlerBlackBoardDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("updateBlackboardThumbnailImageFromBlackboardThumbnailImage",e.handlerUpdateBlackboardThumbnailImageFromBlackboardThumbnailImage.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("changeMainContentVesselSmartSize",e.changeMainContentVesselSmartSize.bind(e),e.listernerBackupid),this._init()}},{key:"componentWillUnmount",value:function(){var e=this;clearTimeout(this.disabledBlackboardToolBtnTimer),x.default.Window.removeBackupListerner(e.listernerBackupid),x.default.CoreController.removeBackupListerner(e.listernerBackupid),x.default.Document.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){t.show!==this.state.show&&this.state.show&&this._updateContainerWidthAndHeight(),t.blackBoardState!==this.state.blackBoardState&&(this._updateBlackBoardDescListByBlackBoardState(),this._updateContainerWidthAndHeight())}},{key:"handlerUpdateBlackboardThumbnailImageFromBlackboardThumbnailImage",value:function(e){var t=e.message.action;this.blackboardThumbnailImageClick({action:t,initiative:!1})}},{key:"handlerRoomPlaybackClearAll",value:function(){this._recoverDedaultState()}},{key:"handlerRoomDisconnected",value:function(){this._recoverDedaultState()}},{key:"handlerRoomParticipantJoin",value:function(){this._updateBlackBoardDescListByBlackBoardState()}},{key:"handlerRoomParticipantLeave",value:function(){this._updateBlackBoardDescListByBlackBoardState()}},{key:"handlerOnResize",value:function(){this._updateContainerWidthAndHeight(),"mobile"!==TK.SDKTYPE&&this.anewCountPosition()}},{key:"handlerOnFullscreenchange",value:function(){"mobile"!==TK.SDKTYPE&&(!TkUtils.tool.isFullScreenStatus()||TkUtils.tool.getFullscreenElement().id&&"lc-full-vessel"==TkUtils.tool.getFullscreenElement().id)&&this.anewCountPosition()}},{key:"changeMainContentVesselSmartSize",value:function(){"mobile"!==TK.SDKTYPE&&this.anewCountPosition()}},{key:"anewCountPosition",value:function(){var e=this,t=this.props,a=t.percentLeft,n=t.percentTop,i=t.id;TkUtils.getPagingToolLT(e,a,n,i),this.setState((0,v.default)({},i,this.state[i]))}},{key:"handlerResizeHandler",value:function(e){this._updateContainerWidthAndHeight(),"mobile"!==TK.SDKTYPE&&this.anewCountPosition()}},{key:"handlerReceive_msglist_BlackBoard",value:function(e){this.handlerRoomPubmsg(e)}},{key:"handlerRoomPubmsg",value:function(e){var t=e.message;switch(t.name){case"BlackBoard":(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant)&&void 0===this.state.useToolColor?this.setState({useToolColor:"#FF0000"}):R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||void 0!==this.state.useToolColor||this.setState({useToolColor:"#000000"}),((R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol||R.default.hasRole.rolePlayback)&&"_none"!==t.data.blackBoardState||"_dispenseed"===t.data.blackBoardState||"_recycle"===t.data.blackBoardState||"_againDispenseed"===t.data.blackBoardState)&&this.setState({show:!0});var a=this.currentTapKey,n=this.state.blackBoardState;void 0!==t.data.currentTapKey&&(this.currentTapKey=t.data.currentTapKey),void 0!==t.data.currentTapPage&&this.state.currentTapPage!==t.data.currentTapPage&&(this.state.currentTapPage=t.data.currentTapPage),this.setState({blackBoardState:t.data.blackBoardState,updateState:!this.state.updateState,currentTapPage:this.state.currentTapPage}),n===t.data.blackBoardState&&a!==t.data.currentTapKey&&(!R.default.hasRole.roleStudent||"_dispenseed"!==t.data.blackBoardState&&"_againDispenseed"!==t.data.blackBoardState)&&this._updateBlackBoardDescListByBlackBoardState()}}},{key:"handlerRoomDelmsg",value:function(e){switch(e.message.name){case"BlackBoard":case"ClassBegin":this._recoverDedaultState()}}},{key:"handlerBlackBoardDrag",value:function(e){var t=e.message.data;"_recycle"===this.state.blackBoardState&&F.default.sendSignallingFromBlackBoardDrag(t)}},{key:"handlerCloseClick",value:function(){var e={};F.default.sendSignallingFromBlackBoard(e,!0)}},{key:"handlerBlackBoardDispatchClick",value:function(){var e=this,t=void 0,a=this.props,n=a.translateX,i=a.translateY,r={translateX:n,translateY:i};if("_prepareing"===this.state.blackBoardState)F.default.sendSignallingFromBlackBoardDrag(r),t="_dispenseed";else if("_dispenseed"===this.state.blackBoardState)F.default.sendSignallingFromBlackBoardDrag(r),t="_recycle";else if("_recycle"===this.state.blackBoardState)t="_againDispenseed";else if("_againDispenseed"===this.state.blackBoardState)F.default.sendSignallingFromBlackBoardDrag(r),t="_recycle";else if("_none"===this.state.blackBoardState)return void L.Logger.error("current blackBoardState is _none , can't execute blackBoardDispatchClick!");if(t){var s={blackBoardState:t,currentTapKey:this.currentTapKey,currentTapPage:this.state.currentTapPage};F.default.sendSignallingFromBlackBoard(s,!1)}this.setState({disabledBlackboardToolBtn:!0}),clearTimeout(this.disabledBlackboardToolBtnTimer),this.disabledBlackboardToolBtnTimer=setTimeout(function(){e.setState({disabledBlackboardToolBtn:!1})},300)}},{key:"handlerTabClick",value:function(e){if(void 0!==e){var t={blackBoardState:this.state.blackBoardState,currentTapKey:e,currentTapPage:this.state.currentTapPage};F.default.sendSignallingFromBlackBoard(t,!1)}}},{key:"resizeWhiteboardSizeCallback",value:function(e){}},{key:"handleToolClick",value:function(e){"tool_pencil"!==e&&"tool_text"!==e&&"tool_eraser"!==e||this.setState({useToolKey:e})}},{key:"changeStrokeColorClick",value:function(e){this.setState({useToolColor:e})}},{key:"onTapPrevOrNextClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(0,f.default)(this.state.blackBoardDescList).length,n=Math.ceil(a/(this.maxBlackboardNumber-1));switch(e){case"prev":this.state.currentTapPage--;break;case"next":this.state.currentTapPage++}if(this.state.currentTapPage<1?this.state.currentTapPage=1:this.state.currentTapPage>n&&(this.state.currentTapPage=n),t){var i={blackBoardState:this.state.blackBoardState,currentTapKey:this.currentTapKey,currentTapPage:this.state.currentTapPage};F.default.sendSignallingFromBlackBoard(i,!1)}this.setState({currentTapPage:this.state.currentTapPage})}},{key:"blackboardThumbnailImageClick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,a=e.initiative,n=void 0===a||a;if("_none"!==this.state.blackBoardState)switch(t){case"shrink":this.setState({blackboardThumbnailImage:this.blackboardThumbnailImageId}),n&&x.default.CoreController.dispatchEvent({type:"updateBlackboardThumbnailImageFromMoreBlackboard",message:{show:!0,blackboardThumbnailImageId:this.blackboardThumbnailImageId,blackboardThumbnailImageBackgroundColor:this.blackboardCanvasBackgroundColor}});break;case"magnify":this.setState({blackboardThumbnailImage:void 0}),n&&x.default.CoreController.dispatchEvent({type:"updateBlackboardThumbnailImageFromMoreBlackboard",message:{show:!1,blackboardThumbnailImageId:this.blackboardThumbnailImageId,blackboardThumbnailImageBackgroundColor:this.blackboardCanvasBackgroundColor}})}else x.default.CoreController.dispatchEvent({type:"updateBlackboardThumbnailImageFromMoreBlackboard",message:{show:!1,blackboardThumbnailImageId:this.blackboardThumbnailImageId,blackboardThumbnailImageBackgroundColor:this.blackboardCanvasBackgroundColor}})}},{key:"_init",value:function(){this._updateContainerWidthAndHeight()}},{key:"_updateContainerWidthAndHeight",value:function(){var e=document.getElementById("blackboardContentBox");if("mobile"===TK.SDKTYPE){if(e){var t=e.clientWidth,a=e.clientHeight;this.state.containerWidthAndHeight.width=t,this.state.containerWidthAndHeight.height=a,this.setState({containerWidthAndHeight:this.state.containerWidthAndHeight})}}else if("pc"===TK.SDKTYPE&&e){var n=e.clientWidth,i=n*(1/this.whiteboardMagnification);this.state.containerWidthAndHeight.width=n,this.state.containerWidthAndHeight.height=i,this.setState({containerWidthAndHeight:this.state.containerWidthAndHeight})}}},{key:"_updateBlackBoardDescListByBlackBoardState",value:function(){if(H.default.getTkRoom()){var e=this.state.blackBoardDescList;"blackBoardCommon"===this.currentTapKey||H.default.getTkRoom().getUser(this.currentTapKey)||(this.currentTapKey="blackBoardCommon"),"_prepareing"===this.state.blackBoardState?((R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol||R.default.hasRole.rolePlayback)&&(this.currentTapKey="blackBoardCommon"),e=Object.customAssign({},this._getBlackBoardCommon())):"_dispenseed"===this.state.blackBoardState||"_againDispenseed"===this.state.blackBoardState?(R.default.hasRole.roleStudent&&(this.currentTapKey=H.default.getTkRoom().getMySelf().id),e=Object.customAssign({},this._getBlackBoardCommon(),this._getStudentBlackboard())):"_recycle"===this.state.blackBoardState?e=Object.customAssign({},this._getBlackBoardCommon(),this._getStudentBlackboard()):"_none"===this.state.blackBoardState&&(e={});var t=(0,f.default)(e).length,a=Math.ceil(t/(this.maxBlackboardNumber-1));this.state.currentTapPage<1?this.state.currentTapPage=1:this.state.currentTapPage>a&&(this.state.currentTapPage=a),this.setState({blackBoardDescList:e,currentTapPage:this.state.currentTapPage})}}},{key:"_getStudentBlackboard",value:function(){var e={},t=!0,a=!1,n=void 0;try{for(var i,r=(0,c.default)((0,d.default)(H.default.getTkRoom().getSpecifyRoleList(R.default.role.roleStudent)));!(t=(i=r.next()).done);t=!0){var s=i.value,o=(0,m.default)(s,2),l=o[0],u=o[1];u.playbackLeaved||(e[l]={instanceId:l,show:this.currentTapKey===l,isBaseboard:!1,deawPermission:!1,dependenceBaseboardWhiteboardID:"blackBoardCommon",needLooadBaseboard:!0,saveImage:!1,nickname:u.nickname},!R.default.role.roleStudent||"_dispenseed"!==this.state.blackBoardState&&"_againDispenseed"!==this.state.blackBoardState||H.default.getTkRoom().getMySelf().id!==l||(e[l].deawPermission=!0),"_recycle"===this.state.blackBoardState&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant)&&(e[l].deawPermission=!0))}}catch(e){a=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}return e}},{key:"_getBlackBoardCommon",value:function(e){var t={blackBoardCommon:{instanceId:"blackBoardCommon",show:"blackBoardCommon"===this.currentTapKey,isBaseboard:"_prepareing"===this.state.blackBoardState,deawPermission:R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant,dependenceBaseboardWhiteboardID:void 0,needLooadBaseboard:!1,saveImage:!1,nickname:"blackBoardCommon"}};return e&&"object"===(void 0===e?"undefined":(0,o.default)(e))&&Object.customAssign(t.blackBoardCommon,e),t}},{key:"_getDefaultState",value:function(){return{blackBoardState:"_none",disabledBlackboardToolBtn:!1,blackBoardDescList:{},useToolKey:"tool_pencil",useToolColor:void 0===R.default.hasRole.roleChairman?void 0:R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant?"#FF0000":"#000000",containerWidthAndHeight:{width:0,height:0},updateState:!1,currentTapPage:1,blackboardToolsInfo:"mobile"!==TK.SDKTYPE?{pencil:5,text:30,eraser:30}:{pencil:5,text:45,eraser:150},selectBlackboardToolSizeId:"blackboard_size_small",blackboardThumbnailImage:void 0}}},{key:"_loadBlackBoardElementArray",value:function(e){var t=this,a=[],n=[],i="tool_eraser"===this.state.useToolKey?this.state.blackboardToolsInfo.eraser:this.state.blackboardToolsInfo.pencil,s=this.state.blackboardToolsInfo.text,o=[],l=void 0,d=!0,u=!1,h=void 0;try{for(var m,g=(0,c.default)((0,r.default)(e));!(d=(m=g.next()).done);d=!0){var p=m.value;"blackBoardCommon"!==p.instanceId?o.push(p):l=p}}catch(e){u=!0,h=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw h}}o.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("instanceId")&&void 0!==t&&t.hasOwnProperty("instanceId")?e.instanceId<t.instanceId?-1:e.instanceId>t.instanceId?1:0:0}),l&&o.unshift(l);var v=(0,f.default)(e).length,b=void 0,y=void 0,S=Math.ceil(v/(this.maxBlackboardNumber-1));if(S>1)if(b=100/(this.maxBlackboardNumber-1),1===S||this.state.currentTapPage<S)y=(this.state.currentTapPage-1)*(this.maxBlackboardNumber-1)*b;else{var k=S*(this.maxBlackboardNumber-1)-v;y=((this.state.currentTapPage-1)*(this.maxBlackboardNumber-1)-k)*b}return o.forEach(function(e,r){("blackBoardCommon"===e.instanceId||"blackBoardCommon"!==e.instanceId&&H.default.getTkRoom()&&H.default.getTkRoom().getUser(e.instanceId))&&(a.push(E.default.createElement("li",{className:"tab-content-option ",key:e.instanceId,style:{display:e.show?"block":"none"}},E.default.createElement(z.default,{containerWidthAndHeight:t.state.containerWidthAndHeight,resizeWhiteboardSizeCallback:t.resizeWhiteboardSizeCallback.bind(t),instanceId:e.instanceId,show:e.show,isBaseboard:e.isBaseboard,deawPermission:e.deawPermission,dependenceBaseboardWhiteboardID:e.dependenceBaseboardWhiteboardID,associatedMsgID:t.associatedMsgID,associatedUserID:void 0,needLooadBaseboard:e.needLooadBaseboard,saveImage:e.saveImage,nickname:e.nickname,useToolKey:t.state.useToolKey,fontSize:s,useToolColor:t.state.useToolColor,pencilWidth:i,saveRedoStack:R.default.hasRole.roleChairman||R.default.joinRoomInfo.shapeUndoRedoClear,undoRedoClearToMySelf:R.default.hasRole.roleStudent&&R.default.joinRoomInfo.shapeUndoRedoClear,imageThumbnailId:e.show?t.state.blackboardThumbnailImage:void 0,backgroundColor:t.blackboardCanvasBackgroundColor,imageThumbnailTipContent:W.default.language.languageData.header.tool.blackBoard.content.blackboardHeadTitle,showShapeAuthor:!1}))),n.push(E.default.createElement("li",{style:{marginLeft:0===r&&void 0!==y?-y+"%":void 0,width:void 0!==b?b+"%":void 0,maxWidth:void 0!==b?b+"%":void 0,minWidth:void 0!==b?b+"%":void 0},className:"tap-option add-nowrap "+(e.show?"active":"")+(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant?" ":" disabled"),key:e.instanceId,onClick:"mobile"!==TK.SDKTYPE&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant)?t.handlerTabClick.bind(t,e.instanceId):void 0,onTouchStart:"mobile"===TK.SDKTYPE&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant)?t.handlerTabClick.bind(t,e.instanceId):void 0},E.default.createElement("span",{className:"text add-nowrap"},"blackBoardCommon"===e.instanceId?W.default.language.languageData.header.tool.blackBoard.toolBtn.commonTeacher:H.default.getTkRoom().getUser(e.instanceId).nickname),"mobile"===TK.SDKTYPE?E.default.createElement("em",{className:"separate"}):void 0)))}),{tabContentBlackBoardElementArray:a,tabBlackBoardElementArray:n}}},{key:"_loadToolColorsElementArray",value:function(){var e=this,t=[],a=[];return a="mobile"!==TK.SDKTYPE?["#FF0000","#FFFF00","#00FF00","#00FFFF","#0000FF","#FF00FF","#FE9401","#FF2C55","#007AFF","#7457F1","#626262","#000000"]:["#FF0000","#FFFF00","#007AFF","#000000"],a.forEach(function(a,n){var i="mobile"!==TK.SDKTYPE?E.default.createElement("li",{className:"color-option "+(e.state.useToolColor===a?" active":""),key:n,onClick:e.changeStrokeColorClick.bind(e,a),style:{backgroundColor:a},id:"blackboard_color_"+e._colorFilter(a)}):E.default.createElement("li",{key:n,className:"blackboard-tool-option"},E.default.createElement("button",{id:"blackboard_color_"+e._colorFilter(a),className:"color-option "+(e.state.useToolColor===a?" active":""),style:{backgroundColor:a},onTouchStart:e.changeStrokeColorClick.bind(e,a)}));t.push(i)}),{toolColorsArray:t}}},{key:"_colorFilter",value:function(e){return e.replace(/#/g,"")}},{key:"_recoverDedaultState",value:function(){clearTimeout(this.disabledBlackboardToolBtnTimer);var e=this._getDefaultState();this.currentTapKey=void 0,this.setState(Object.customAssign({},e,{show:!1})),x.default.CoreController.dispatchEvent({type:"updateBlackboardThumbnailImageFromMoreBlackboard",message:{show:!1,blackboardThumbnailImageId:this.blackboardThumbnailImageId,blackboardThumbnailImageBackgroundColor:this.blackboardCanvasBackgroundColor}})}},{key:"_changeStrokeSizeClick",value:function(e,t){this.setState({selectBlackboardToolSizeId:e,blackboardToolsInfo:Object.customAssign(this.state.blackboardToolsInfo,t)})}},{key:"render",value:function(){var e=this,t=e.state,a=t.blackBoardState,n=t.show,i=t.blackBoardDescList,r=t.containerWidthAndHeight,s=t.useToolKey,o=t.blackboardThumbnailImage,l=this.props.id,d="_none"!==a?"_prepareing"===a?W.default.language.languageData.header.tool.blackBoard.toolBtn.dispenseed:"_dispenseed"===a?W.default.language.languageData.header.tool.blackBoard.toolBtn.recycle:"_recycle"===a?W.default.language.languageData.header.tool.blackBoard.toolBtn.againDispenseed:"_againDispenseed"===a?W.default.language.languageData.header.tool.blackBoard.toolBtn.recycle:"":"",u=e._loadBlackBoardElementArray(i),c=u.tabContentBlackBoardElementArray,h=u.tabBlackBoardElementArray,m=e._loadToolColorsElementArray(),g=m.toolColorsArray,p=(0,f.default)(i).length,v=Math.ceil(p/(e.maxBlackboardNumber-1)),b=void 0,y=!("_recycle"===a||("_dispenseed"===a||"_againDispenseed"===a)&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol||R.default.hasRole.rolePlayback)),S="mobile"===TK.SDKTYPE&&"phone"===W.default.mobileDeviceType?!(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol)&&(R.default.hasRole.rolePlayback||R.default.hasRole.rolePatrol||R.default.hasRole.roleStudent&&!("_dispenseed"===a||"_againDispenseed"===a)):R.default.hasRole.rolePlayback||R.default.hasRole.rolePatrol||R.default.hasRole.roleStudent&&!("_dispenseed"===a||"_againDispenseed"===a),k="mobile"===TK.SDKTYPE&&"phone"===W.default.mobileDeviceType;if("mobile"===TK.SDKTYPE){var w=0;"pad"===W.default.mobileDeviceType?(k||(w+=.8),y||(w+=.8),S||(w+=1.15)):"phone"===W.default.mobileDeviceType&&(y||(w+=.8)),b={height:"calc( 100% - "+w+"rem )"}}return E.default.createElement("section",{id:l,className:"black-board-container "+(S?" hideBottom":" ")+(y?" hideTap":" ")+(k?" hideTitle":" "),style:{display:n?"block":"none",position:"absolute",opacity:void 0===o?void 0:0,zIndex:void 0===o?void 0:-999}},E.default.createElement("article",{className:"title-container",style:{display:k?"none":void 0}},E.default.createElement("span",{className:"title"},W.default.language.languageData.header.tool.blackBoard.content.blackboardHeadTitle),E.default.createElement("button",{className:"close",style:{display:R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant?"":"none"},title:W.default.language.languageData.header.tool.blackBoard.title.close,onTouchStart:e.handlerCloseClick.bind(e)}),"mobile"===TK.SDKTYPE&&"pad"===W.default.mobileDeviceType&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol)?E.default.createElement("button",{className:"blackboard-thumbnail-image",onTouchStart:e.blackboardThumbnailImageClick.bind(e,{action:"shrink"}),title:W.default.language.languageData.header.tool.blackBoard.title.shrink}):void 0),E.default.createElement("article",{className:"tap-container clear-float",style:{display:y?"none":""}},E.default.createElement("button",{className:"prev add-fl "+(e.state.currentTapPage<=1?"disabled":""),disabled:e.state.currentTapPage<=1,style:{display:p<e.maxBlackboardNumber?"none":""},title:W.default.language.languageData.header.tool.blackBoard.title.prev,onTouchStart:e.state.currentTapPage<=1?void 0:e.onTapPrevOrNextClick.bind(e,"prev",!0)}),E.default.createElement("ul",{className:"tap add-fl clear-float"},h),E.default.createElement("button",{className:"next add-fr "+(e.state.currentTapPage>=v?"disabled":""),disabled:e.state.currentTapPage>=v,style:{display:p<e.maxBlackboardNumber?"none":""},title:W.default.language.languageData.header.tool.blackBoard.title.next,onTouchStart:e.state.currentTapPage>=v?void 0:e.onTapPrevOrNextClick.bind(e,"next",!0)})),E.default.createElement("article",{className:"tab-content-container",id:"blackboardContentBox",style:b},E.default.createElement("ul",{style:{width:r.width+"px",height:r.height+"px"},className:"tab-content clear-float overflow-hidden"},c)),E.default.createElement("article",{id:"blackboard-tool-container",className:"blackboard-tool-container clear-float",style:{display:S?"none":""}},"mobile"===TK.SDKTYPE&&"phone"===W.default.mobileDeviceType&&(R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant||R.default.hasRole.rolePatrol)?E.default.createElement("button",{className:"blackboard-thumbnail-image",onTouchStart:e.blackboardThumbnailImageClick.bind(e,{action:"shrink"}),title:W.default.language.languageData.header.tool.blackBoard.title.shrink}):void 0,E.default.createElement("ul",{className:"blackboard-tool clear-float",style:{display:R.default.hasRole.rolePlayback||R.default.hasRole.rolePatrol||R.default.hasRole.roleStudent&&"_dispenseed"!==a&&"_againDispenseed"!==a?"none":""}},E.default.createElement("li",{className:"blackboard-tool-option"},E.default.createElement("button",{id:"blackboard_tool_vessel_pencil",className:"tool-btn pencil-icon "+("tool_pencil"===s?" active":""),title:W.default.language.languageData.header.tool.blackBoard.boardTool.pen,onTouchStart:e.handleToolClick.bind(e,"tool_pencil")})),E.default.createElement("li",{className:"blackboard-tool-option"},E.default.createElement("button",{id:"blackboard_tool_vessel_text",className:"tool-btn text-icon"+("tool_text"===s?" active":""),title:W.default.language.languageData.header.tool.blackBoard.boardTool.text,onTouchStart:e.handleToolClick.bind(e,"tool_text")})),E.default.createElement("li",{className:"blackboard-tool-option"},E.default.createElement("button",{id:"blackboard_tool_vessel_eraser",className:"tool-btn eraser-icon"+("tool_eraser"===s?" active":""),title:W.default.language.languageData.header.tool.blackBoard.boardTool.eraser,onTouchStart:e.handleToolClick.bind(e,"tool_eraser")})),"mobile"!==TK.SDKTYPE?E.default.createElement("li",{className:"blackboard-tool-option colors  add-position-relative"},E.default.createElement("button",{id:"blackboard_tool_vessel_color",className:"tool-btn colors-icon",title:W.default.language.languageData.header.tool.blackBoard.boardTool.color},E.default.createElement("span",{className:"current-color",style:{backgroundColor:this.state.useToolColor}})),E.default.createElement("div",{className:"blackboard-color-size-box"},E.default.createElement("ul",{className:"tool-size-container",id:"blackboard_tool_size"},E.default.createElement("li",{id:"blackboard_size_small",onTouchStart:e._changeStrokeSizeClick.bind(e,"blackboard_size_small",{pencil:5,text:30,eraser:30}),className:"size-small "+("blackboard_size_small"===this.state.selectBlackboardToolSizeId?"active":"")},E.default.createElement("span",null)),E.default.createElement("li",{id:"blackboard_size_middle",onTouchStart:e._changeStrokeSizeClick.bind(e,"blackboard_size_middle",{pencil:15,text:36,eraser:90}),className:"size-middle "+("blackboard_size_middle"===this.state.selectBlackboardToolSizeId?"active":"")},E.default.createElement("span",null)),E.default.createElement("li",{id:"blackboard_size_big",onTouchStart:e._changeStrokeSizeClick.bind(e,"blackboard_size_big",{pencil:30,text:72,eraser:150}),className:"size-big "+("blackboard_size_big"===this.state.selectBlackboardToolSizeId?"active":"")},E.default.createElement("span",null))),E.default.createElement("ol",{className:"colors-container"},g))):g),"pc"===TK.SDKTYPE||"mobile"===TK.SDKTYPE&&"pad"===W.default.mobileDeviceType?E.default.createElement("span",{className:"blackboard-function-btn-container"},E.default.createElement("button",{style:{display:R.default.hasRole.roleChairman||R.default.hasRole.roleTeachingAssistant?"":"none"},className:"blackboard-send-btn "+(this.state.disabledBlackboardToolBtn?"disabled":""),disabled:this.state.disabledBlackboardToolBtn,onTouchStart:e.handlerBlackBoardDispatchClick.bind(e)},d)):void 0))}}]),t}(E.default.Component);t.default=j},"2vo4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={header:{tool:{blackBoard:{title:{open:"小白板",close:"關閉",prev:"上壹位",next:"下壹位",shrink:"縮小"},content:{blackboardHeadTitle:"小白板"},toolBtn:{dispenseed:"分發",recycle:"回收",againDispenseed:"再次分發",commonTeacher:"老師"},tip:{saveImage:"是否保存白板"},boardTool:{pen:"筆",text:"文字",eraser:"橡皮",color:"顏色及粗細"}},sharing:{title:"屏幕共享"},mouse:{title:"鼠標"},pencil:{title:"筆",pen:{text:"鉛筆工具"},Highlighter:{text:"熒光筆工具"},linellae:{text:"線條工具"},arrow:{text:"箭頭工具"},laser:{title:"激光筆",text:"激光筆工具"}},text:{title:"文字",Msyh:{text:"微軟雅黑"},Ming:{text:"宋體"},Arial:{text:"Arial"}},shape:{title:"形狀",outlinedRectangle:{text:"空心矩形"},filledRectangle:{text:"矩形"},outlinedCircle:{text:"空心橢圓"},filledCircle:{text:"橢圓"}},eraser:{title:"橡皮擦"},undo:{title:"撤銷"},redo:{title:"恢復"},clear:{title:"清屏"},tool_zoom_big:{title:"放大"},tool_zoom_small:{title:"縮小"},tool_rotate_left:{title:"逆時針旋轉"},tool_rotate_right:{title:"順時針旋轉"},colorAndMeasure:{title:"顏色及粗細",selectColorText:"選擇顏色",selectMeasure:"選擇粗細"},colors:{title:"顏色"},measure:{title:"粗細"}},page:{prev:{text:"上壹頁"},next:{text:"下壹頁"},add:{text:"加頁"},lcFullBtn:{title:"繪制區域全屏"},pptFullBtn:{title:"PPT全屏"},h5FileFullBtn:{title:"h5課件全屏"},skipPage:{text_one:"至第",text_two:"頁"},ok:{text:"確定"},coursewareRemarks:{title:"課件備註"}},volume:{title:"音量"}},alertWin:{ok:{showError:{text:"確定"},showPrompt:{text:"確定"},showConfirm:{cancel:"取消",ok:"確定"}},title:{showError:{text:"錯誤信息"},showPrompt:{text:"提示信息"},showConfirm:{text:"確認消息"}},call:{fun:{page:{pageInteger:{text:"輸入的頁數必須是整數！"},pageMax:{text:"輸入的頁數不能超過最大頁數！"},pageMin:{text:"輸入的頁數不能小於1"}}}}},toolCase:{toolBox:{text:"工具箱"}},timers:{timerSetInterval:{text:"計時器"},timerBegin:{text:"開始"},timerStop:{text:"暫停"},again:{text:"重新開始"}},dial:{turntable:{text:"轉盤"}},answers:{headerTopLeft:{text:"答題器"},headerMiddel:{text:"點擊字母預設正確答案"},beginAnswer:{text:"開始答題"},tureAccuracy:{text:"正確率"},trueAnswer:{text:"正確答案"},endAnswer:{text:"結束答題"},restarting:{text:"重新開始"},myAnswer:{text:"我的答案"},changeAnswer:{text:"修改答案"},selectAnswer:{text:"請至少選擇壹個答案"},submitAnswer:{text:"提交答案"},numberOfAnswer:{text:"答題人數"},PublishTheAnswer:{text:"公布答案"},published:{text:"已公布"},details:{text:"詳情"},statistics:{text:"統計"},student:{text:"學生"},TheSelectedTheAnswer:{text:"所選答案"},AnswerTime:{text:"答題用時"},end:{text:"請先結束答題"}},responder:{responder:{text:"搶答器"},begin:{text:"開始搶答"},restart:{text:"重新開始"},close:{text:"關閉"},update:{text:"當前瀏覽器不支持canvas組件請升級！"},inAnswer:{text:"搶答中"},answer:{text:"搶答"},noContest:{text:"無人搶答"}},call:{fun:{page:{pageInteger:{text:"輸入的頁數必須是整數！"},pageMax:{text:"輸入的頁數不能超過最大頁數！"},pageMin:{text:"輸入的頁數不能小於1"}}}},coursewareRemarks:{remarks:"備註",close:"關閉"},reloadDoucumentHint:{one:"當前網絡不穩定，正在嘗試重新打開課件……第",two:"次"}};t.default=n},"3fs2":function(e,t,a){var n=a("RY/4"),i=a("dSzd")("iterator"),r=a("/bQp");e.exports=a("FeBl").getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||r[n(e)]}},"3oJH":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("W3Iv"),r=n(i),s=a("d7EF"),o=n(s),l=a("gRE1"),d=n(l),u=a("fZjL"),c=n(u),h=a("BO1k"),m=n(h),g=a("Zx67"),f=n(g),p=a("Zrlr"),v=n(p),b=a("wxAW"),y=n(b),S=a("zwoO"),k=n(S),w=a("Pf15"),C=n(w),T=a("GiK3"),P=n(T),A=a("HUPQ"),D=n(A),_=a("VSuD"),E=n(_),I=a("DrPG"),x=n(I),B=a("T+56"),R=n(B),N=a("Sa83"),W=n(N),M=a("adC7"),F=n(M),O=a("yE5a"),H=n(O),U=a("YRCL"),z=n(U),j=a("UQof"),V=n(j),K=a("F5u0"),Q=n(K),Y=a("m/zC"),G=n(Y),Z=a("EXAz"),J=n(Z),q=function(e){function t(e){(0,v.default)(this,t);var a=(0,k.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.props.id,a.whiteboardJson={disabled:{prevPage:!0,nextPage:!0,addPage:!0},page:{currpage:1,totalpage:1},temporaryDisabled:{prevPage:!1,nextPage:!1,addPage:!1},show:{prevPage:!0,nextPage:!0,addPage:!1},onClick:{prevPage:a.whiteboardPrevPageClick.bind(a),nextPage:a.whiteboardNextPageClick.bind(a),addPage:a.whiteboardAddPageClick.bind(a),fullScreen:a.fullScreenClick.bind(a)},updateState:!1},a.newpptJson={disabled:{prevPage:!0,nextPage:!0,addPage:!0},page:{currpage:1,totalpage:1},temporaryDisabled:{prevPage:!1,nextPage:!1,addPage:!1},show:{prevPage:!0,nextPage:!0,addPage:!1},onClick:{prevPage:a.newpptPrevStepClick.bind(a),nextPage:a.newpptNextStepClick.bind(a),addPage:void 0,fullScreen:a.fullScreenClick.bind(a)}},a.h5DocumentJson={disabled:{prevPage:!0,nextPage:!0,addPage:!0},page:{currpage:1,totalpage:1},temporaryDisabled:{prevPage:!1,nextPage:!1,addPage:!1},show:{prevPage:!0,nextPage:!0,addPage:!1},onClick:{prevPage:a.h5DocumentPrevStepClick.bind(a),nextPage:a.h5DocumentNextStepClick.bind(a),addPage:void 0,fullScreen:a.fullScreenClick.bind(a)}},a.state={jumpPage:W.default.handler.getAppPermissions("jumpPage"),fileTypeMark:"general",isFullScreen:!1,pagingDesc:a._getPaddingDesc("general"),registerWhiteboardToolsList:{zoom_small:{toolKey:"zoom_small",disabled:!1},zoom_big:{toolKey:"zoom_big",disabled:!1}},selectExtendListShow:!1,pageSelectListPassivityHideNumber:0,pagingToolBarIsShow:!1,volume:1,isOverVolume:!1,isShowDynamicPptVolume:!1},a.coursewareRemarksInfo={},a.isVolumeDraging=!1,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.pageSelectListId="pageSelectListId_pageingToolBar",a}return(0,C.default)(t,e),(0,y.default)(t,[{key:"componentDidMount",value:function(){var e=this;R.default.Document.addEventListener(E.default.EVENTTYPE.DocumentEvent.onKeydown,e.handlerOnKeydown.bind(e),e.listernerBackupid),R.default.Document.addEventListener(E.default.EVENTTYPE.DocumentEvent.onFullscreenchange,e.handlerOnFullscreenchange.bind(e),e.listernerBackupid),R.default.Window.addEventListener(E.default.EVENTTYPE.WindowEvent.onResize,e.handlerOnResize.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener(E.default.EVENTTYPE.RoomEvent.roomConnected,e.handlerRoomConnected.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("callAllWrapOnClick",e.handlerCallAllWrapOnClick.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("changeFileTypeMark",e.handlerChangeFileTypeMark.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("updatePagdingState",e.handlerUpdatePagdingState.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("updateAppPermissions_jumpPage",e.handlerUpdateAppPermissions_jumpPage.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("commonWhiteboardTool_noticeUpdateToolDesc",e.handlerCommonWhiteboardTool_noticeUpdateToolDesc.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("mobileSdk_fullScreenChangeCallback",e.handlerMobileSdk_fullScreenChangeCallback.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("receive-msglist-PptVolumeControl",e.handlerReceiveMsglistPptVolumeControl.bind(e),e.listernerBackupid),R.default.Window.addEventListener(E.default.EVENTTYPE.WindowEvent.onMessage,e.handlerOnMessage.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener(E.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),this.setDefaultPosition()}},{key:"componentWillUnmount",value:function(){var e=this;R.default.CoreController.removeBackupListerner(e.listernerBackupid),R.default.Document.removeBackupListerner(e.listernerBackupid),R.default.Window.removeBackupListerner(e.listernerBackupid),clearTimeout(e.keydownTimer)}},{key:"componentDidUpdate",value:function(e,t){var a=this;"general"!=a.state.fileTypeMark&&(a.state.isOverVolume=!1),t.isShowFileRemarksBtn!==this.state.isShowFileRemarksBtn&&!0===this.state.isShowFileRemarksBtn&&R.default.CoreController.dispatchEvent({type:"renderRemarks",message:{}})}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2,s=i.offsetHeight-n.offsetHeight-10,o=s/(i.offsetHeight-n.offsetHeight);o=isNaN(o)||null===o||o<0?0:o,a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:s,percentLeft:.5,percentTop:o,isDrag:!1},!1)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"PptVolumeControl":t.recvEventDataPptVolumeControl(a)}}},{key:"handlerOnMessage",value:function(e){var t=this,a=e.message.event;t.handlerIframeMessage(a)}},{key:"handlerIframeMessage",value:function(e){var t=this;if(e.data){var a=void 0,n=void 0;try{n=JSON.parse(e.data),a=n.data}catch(t){return void L.Logger.warning("iframe message data can't be converted to JSON , iframe data:",e.data)}if("tk_dynamicPPT"===n.source)switch(a.action){case"allVideoAndAudio":a.allVideoAndAudioLength>0&&(t.state.isShowDynamicPptVolume=!0)}else t.state.isShowDynamicPptVolume=!1;t.setState({isShowDynamicPptVolume:t.state.isShowDynamicPptVolume})}}},{key:"handlerReceiveMsglistPptVolumeControl",value:function(e){var t=e.message.PptVolumeControlArr[0];this.recvEventDataPptVolumeControl(t)}},{key:"recvEventDataPptVolumeControl",value:function(e){var t=this;t.state.volume=100*e.data.volume,t.setState({volume:t.state.volume});var a=document.getElementsByClassName("tk-audio-ppt-volume-slider")[0],n=a.getElementsByClassName("rc-slider-track")[0],i=a.getElementsByClassName("rc-slider-handle")[0];n.style.height=100*e.data.volume+"%",i.style.bottom=100*e.data.volume+"%"}},{key:"handlerRoomConnected",value:function(){this.state.pagingToolBarIsShow=!0,this.setState({pagingToolBarIsShow:this.state.pagingToolBarIsShow})}},{key:"handlerCallAllWrapOnClick",value:function(e){if("mobile"===TK.SDKTYPE){var t=e.message.event,a=this.pageSelectListId;if(this.state.selectExtendListShow&&!(t.target.id===a||$(t.target)&&$(t.target).parents("#"+a).length>0)){var n=this.state.pageSelectListPassivityHideNumber;n++,this.setState({pageSelectListPassivityHideNumber:n})}this.state.isOverVolume&&!("tk-audio-ppt-volume-slider-id"===t.target.id||$(t.target)&&$(t.target).parents("#tk-audio-ppt-volume-slider-id").length>0)&&this._handlerVolumeMute()}}},{key:"handlerOnResize",value:function(){this.setState({updateState:!this.state.updateState})}},{key:"handlerOnKeydown",value:function(e){var t=this;if(!(D.default.playPptVideoing||D.default.playMediaFileing||D.default.isSkipPageing)){var a=e.message.keyCode;clearTimeout(t.keydownTimer),t.keydownTimer=setTimeout(function(){if("general"===t.state.fileTypeMark){if(W.default.handler.getAppPermissions("whiteboardPagingPage"))switch(a){case 37:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"whiteboardPrevPage"})}}});break;case 39:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"whiteboardNextPage"})}}})}}else if("dynamicPPT"===t.state.fileTypeMark){if(W.default.handler.getAppPermissions("newpptPagingPage"))switch(a){case 39:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"newpptNextSlideClick"})}}});break;case 37:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"newpptPrevSlideClick"})}}});break;case 38:R.default.CoreController.dispatchEvent({type:"newpptPrevStepClick"});break;case 40:R.default.CoreController.dispatchEvent({type:"newpptNextStepClick"})}}else if("h5document"===t.state.fileTypeMark&&W.default.handler.getAppPermissions("h5DocumentPagingPage"))switch(a){case 37:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"h5DocumentPageUpClick"})}}});break;case 39:R.default.CoreController.dispatchEvent({type:"lcTextEditing",message:{callback:function(e){e||R.default.CoreController.dispatchEvent({type:"h5DocumentPageDownClick"})}}})}},250)}}},{key:"handlerChangeFileTypeMark",value:function(e){this.setState({fileTypeMark:e.message.fileTypeMark}),this.setState({pagingDesc:this._getPaddingDesc(e.message.fileTypeMark)})}},{key:"handlerUpdatePagdingState",value:function(e){var t=e.message;if(W.default.handler.getAppPermissions("isShowCoursewareRemarks")&&this.handleCoursewareRemarks(t.data),"whiteboard"===t.source){var a={disabled:{prevPage:!(W.default.handler.getAppPermissions("whiteboardPagingPage")&&t.data.currpage>1),nextPage:!(W.default.handler.getAppPermissions("whiteboardPagingPage")&&t.data.currpage<t.data.pagenum),addPage:!(W.default.handler.getAppPermissions("sendSignallingFromWBPageCount")&&t.data.currpage===t.data.pagenum&&0===t.data.fileid)},page:{currpage:t.data.currpage,totalpage:t.data.pagenum},show:{prevPage:"phone"!==D.default.mobileDeviceType||W.default.handler.getAppPermissions("whiteboardPagingPage"),nextPage:"phone"===D.default.mobileDeviceType?W.default.handler.getAppPermissions("whiteboardPagingPage"):!(0===t.data.fileid&&t.data.currpage===t.data.pagenum),addPage:"phone"!==D.default.mobileDeviceType&&0===t.data.fileid&&t.data.currpage===t.data.pagenum}};Object.customAssign(this.whiteboardJson,a),"general"===this.state.fileTypeMark&&this.setState({pagingDesc:this.whiteboardJson})}else if("newppt"===t.source){var n={disabled:{prevPage:!W.default.handler.getAppPermissions("newpptPagingPage")||D.default.playMediaFileing||D.default.playPptVideoing||t.data.pptslide<=1&&t.data.pptstep<=0,nextPage:!W.default.handler.getAppPermissions("newpptPagingPage")||D.default.playMediaFileing||D.default.playPptVideoing||t.data.pptslide>=t.data.pagenum&&t.data.pptstep>=t.data.steptotal-1,addPage:!0},page:{currpage:t.data.currpage,totalpage:t.data.pagenum}};"phone"===D.default.mobileDeviceType&&(n.show={prevPage:W.default.handler.getAppPermissions("newpptPagingPage"),nextPage:W.default.handler.getAppPermissions("newpptPagingPage"),addPage:!1}),Object.customAssign(this.newpptJson,n),"dynamicPPT"===this.state.fileTypeMark&&this.setState({pagingDesc:this.newpptJson})}else if("h5document"===t.source){var i={disabled:{prevPage:!(W.default.handler.getAppPermissions("h5DocumentPagingPage")&&t.data.currpage>1),nextPage:!(W.default.handler.getAppPermissions("h5DocumentPagingPage")&&t.data.currpage<t.data.pagenum),addPage:!0},page:{currpage:t.data.currpage,totalpage:t.data.pagenum}};"phone"===D.default.mobileDeviceType&&(i.show={prevPage:W.default.handler.getAppPermissions("h5DocumentPagingPage"),nextPage:W.default.handler.getAppPermissions("h5DocumentPagingPage"),addPage:!1}),Object.customAssign(this.h5DocumentJson,i),"h5document"===this.state.fileTypeMark&&this.setState({pagingDesc:this.h5DocumentJson})}}},{key:"handlerOnFullscreenchange",value:function(){"mobile"!==TK.SDKTYPE&&this.setState({isFullScreen:x.default.tool.getFullscreenElement()&&"lc-full-vessel"==x.default.tool.getFullscreenElement().id})}},{key:"handlerMobileSdk_fullScreenChangeCallback",value:function(e){if("mobile"===TK.SDKTYPE){var t=e.message.isFullScreen;this.setState({isFullScreen:t})}}},{key:"handlerInitAppPermissions",value:function(){this.setState({jumpPage:W.default.handler.getAppPermissions("jumpPage")})}},{key:"handlerUpdateAppPermissions_jumpPage",value:function(){this.setState({jumpPage:W.default.handler.getAppPermissions("jumpPage")})}},{key:"handlerCurrpageOnChange",value:function(e){var t=e.target.value;t=t.replace(/[^\d]/g,""),this.state.pagingDesc.page.currpage=t,this.setState({pagingDesc:this.state.pagingDesc})}},{key:"handlerKeyDown",value:function(e){var t=this;13===e.keyCode&&t.handlerCurrpageOnBlur(e)}},{key:"handlerCurrpageOnBlur",value:function(e){var t=this;return D.default.isSkipPageing=!1,/^\d+$/.test(t.state.pagingDesc.page.currpage)?t.state.pagingDesc.page.currpage>t.state.pagingDesc.page.totalpage?(F.default.showPrompt(D.default.language.languageData.alertWin.call.fun.page.pageMax.text),t.state.pagingDesc.page.currpage=t.changeCurrpage,void t.setState({pagingDesc:t.state.pagingDesc})):t.state.pagingDesc.page.currpage<1?(F.default.showPrompt(D.default.language.languageData.alertWin.call.fun.page.pageMin.text),t.state.pagingDesc.page.currpage=t.changeCurrpage,void t.setState({pagingDesc:t.state.pagingDesc})):(R.default.CoreController.dispatchEvent({type:"skipPage_"+t.state.fileTypeMark,message:{currpage:t.state.pagingDesc.page.currpage}}),void(t.changeCurrpage=void 0)):(F.default.showPrompt(D.default.language.languageData.alertWin.call.fun.page.pageInteger.text),t.state.pagingDesc.page.currpage=t.changeCurrpage,void t.setState({pagingDesc:t.state.pagingDesc}))}},{key:"handlerCurrpageOnFocus",value:function(e){var t=this;D.default.isSkipPageing=!0,t.changeCurrpage=t.state.pagingDesc.page.currpage}},{key:"whiteboardPrevPageClick",value:function(e){this._addTemporaryDisabled("prevPage"),R.default.CoreController.dispatchEvent({type:"whiteboardPrevPage"})}},{key:"whiteboardNextPageClick",value:function(e){this._addTemporaryDisabled("nextPage"),R.default.CoreController.dispatchEvent({type:"whiteboardNextPage"})}},{key:"whiteboardAddPageClick",value:function(e){this._addTemporaryDisabled("addPage"),R.default.CoreController.dispatchEvent({type:"whiteboardAddPage"})}},{key:"newpptPrevStepClick",value:function(e){this._addTemporaryDisabled("prevPage"),R.default.CoreController.dispatchEvent({type:"newpptPrevStepClick"})}},{key:"newpptNextStepClick",value:function(e){this._addTemporaryDisabled("nextPage"),R.default.CoreController.dispatchEvent({type:"newpptNextStepClick"})}},{key:"h5DocumentPrevStepClick",value:function(e){this._addTemporaryDisabled("prevPage"),R.default.CoreController.dispatchEvent({type:"h5DocumentPageUpClick"})}},{key:"h5DocumentNextStepClick",value:function(e){this._addTemporaryDisabled("nextPage"),R.default.CoreController.dispatchEvent({type:"h5DocumentPageDownClick"})}},{key:"fullScreenClick",value:function(e){if("mobile"===TK.SDKTYPE){var t=!this.state.isFullScreen;H.default.getTkRoom().changeWebPageFullScreen(t)}else{var a=document.getElementById("lc-full-vessel");x.default.tool.isFullScreenStatus(a)?x.default.tool.exitFullscreen():x.default.tool.launchFullscreen(a)}}},{key:"handlerWhiteboard_activeCommonWhiteboardToolClick",value:function(e,t){R.default.CoreController.dispatchEvent({type:"whiteboard_activeCommonWhiteboardTool",message:{toolKey:e}})}},{key:"handlerCommonWhiteboardTool_noticeUpdateToolDesc",value:function(e){var t=e.message.registerWhiteboardToolsList,a=!1,n=!0,i=!1,r=void 0;try{for(var s,o=(0,m.default)((0,c.default)(this.state.registerWhiteboardToolsList));!(n=(s=o.next()).done);n=!0){var l=s.value;t[l]&&(this.state.registerWhiteboardToolsList[l]=t[l],a=!0)}}catch(e){i=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}a&&this.setState({registerWhiteboardToolsList:this.state.registerWhiteboardToolsList})}},{key:"_getPaddingDesc",value:function(e){return e=e||this.state.fileTypeMark,"general"===e||void 0===e?this.whiteboardJson:"dynamicPPT"===e?this.newpptJson:"h5document"===e?this.h5DocumentJson:void 0}},{key:"_addTemporaryDisabled",value:function(e){var t=this,a=this.state.fileTypeMark,n="general"==this.state.fileTypeMark?"whiteboardJson":"dynamicPPT"==this.state.fileTypeMark?"newpptJson":"h5DocumentJson";this[n].temporaryDisabled[e]=!0,this.setState({pagingDesc:this._getPaddingDesc(this.state.fileTypeMark)}),setTimeout(function(){t[n].temporaryDisabled[e]=!1,t.state.fileTypeMark===a&&t.setState({pagingDesc:t._getPaddingDesc(t.state.fileTypeMark)})},250)}},{key:"changeSelectPageOnChange",value:function(e){var t=this;return e>t.state.pagingDesc.page.totalpage?void F.default.showPrompt(D.default.language.languageData.alertWin.call.fun.page.pageMax.text):e<1?void F.default.showPrompt(D.default.language.languageData.alertWin.call.fun.page.pageMin.text):(t.state.pagingDesc.page.currpage=e,t.setState({pagingDesc:t.state.pagingDesc}),void R.default.CoreController.dispatchEvent({type:"skipPage_"+t.state.fileTypeMark,message:{currpage:e}}))}},{key:"changeSelectPageNoticeSelectExtendListShowOrHide",value:function(e){this.setState({selectExtendListShow:e})}},{key:"_handlerVolumeMute",value:function(){this.state.isOverVolume=!this.state.isOverVolume,this.setState({isOverVolume:this.state.isOverVolume})}},{key:"volumeOnBeforeChange",value:function(e){var t=this,a=t.props.draggableData;a.changeLayerIsShow&&"function"==typeof a.changeLayerIsShow&&a.changeLayerIsShow(!0),t.isVolumeDraging=!0,t.changeVolume=e}},{key:"volumeOnAfterChange",value:function(e){var t=this,a=t.props.draggableData;a.changeLayerIsShow&&"function"==typeof a.changeLayerIsShow&&a.changeLayerIsShow(!1),this.volume=e/100,this.setState({volume:e}),t.state.volume=this.volume,t.isVolumeDraging=!1,t.state.isOverVolume=!1,t.changeVolume=void 0,t.setState({volume:t.state.volume,isOverVolume:t.state.isOverVolume});var n={volume:t.state.volume};W.default.handler.getAppPermissions("sendSignallingFromPptVolumeControl")&&z.default.sendSignallingFromPptVolumeControl(n),R.default.CoreController.dispatchEvent({type:"volumeChangeDispatch",message:{data:n}})}},{key:"remarksClick",value:function(){R.default.CoreController.dispatchEvent({type:"handleIsShowRemarksBox",message:{data:{isShowRemarksBox:!0}}})}},{key:"handleHasRemarks",value:function(e){var t=e.message.data.hasRemarks;this.setState({isShowFileRemarksBtn:t})}},{key:"handleCoursewareRemarks",value:function(e){var t=this,a=!1,n="";if(t.coursewareRemarksInfo[e.fileid]){var i=!0,s=!1,l=void 0;try{for(var u,c=(0,m.default)((0,r.default)(t.coursewareRemarksInfo[e.fileid]));!(i=(u=c.next()).done);i=!0){var h=u.value,g=(0,o.default)(h,2),f=(g[0],g[1]);if(f.pageid==e.currpage){a=!0,n=f.remark;break}}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}var p={type:"handleHasRemarks",message:{data:{hasRemarks:a,remarksInfo:n}}};t.handleHasRemarks(p),R.default.CoreController.dispatchEvent(p)}else{var v={doneCallback:function(i){if(0===i.result){var r=!0,s=!1,o=void 0;try{for(var l,u=(0,m.default)((0,d.default)(i));!(r=(l=u.next()).done);r=!0){var c=l.value;if(c.fileid&&!t.coursewareRemarksInfo[c.fileid]&&(t.coursewareRemarksInfo[c.fileid]=i),c.pageid==e.currpage){a=!0,n=c.remark;break}}}catch(e){s=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(s)throw o}}}var h={type:"handleHasRemarks",message:{data:{hasRemarks:a,remarksInfo:n}}};t.handleHasRemarks(h),R.default.CoreController.dispatchEvent(h)}};G.default.getFileRemark(e.fileid,v)}}},{key:"render",value:function(){var e=this,t=e.state,a=t.fileTypeMark,n=t.isFullScreen,i=t.pagingDesc,r=t.registerWhiteboardToolsList,s=t.selectExtendListShow,o=t.volume,l=t.isOverVolume,d=t.isShowDynamicPptVolume,u=this.props,c=u.id,h=u.draggableData,m=u.pageWrap,g=Object.customAssign({id:c,disabled:"phone"===D.default.mobileDeviceType||s,percentPosition:{percentLeft:m.percentLeft,percentTop:m.percentTop}},h),f=r.zoom_small,p=r.zoom_big,v=[];if("mobile"===TK.SDKTYPE&&"pad"===D.default.mobileDeviceType)for(var b=1;b<=Number(i.page.totalpage);b++)v.push({value:b,label:b});var y=e.state.isShowFileRemarksBtn&&W.default.handler.getAppPermissions("isShowCoursewareRemarks"),S={left:0,top:0,display:this.state.pagingToolBarIsShow?"inline-block":"none"};return"phone"!==D.default.mobileDeviceType?P.default.createElement(J.default,g,P.default.createElement("div",{className:"header-left-page-time-container clear-float add-fr tk-tool-bottom "+e.state.fileTypeMark+" "+("phone"===D.default.mobileDeviceType?"phone ":"pc pad"),id:c,style:S}," ",P.default.createElement("div",{className:"h-page-container add-fl clear-float"},P.default.createElement("div",{className:"h-page-next-prev-container add-fl clear-float tk-paging-"+a},P.default.createElement("button",{className:"lc-tool-icon-wrap add-fl arrow-wrap lc-prev-page "+(i.disabled.prevPage?" disabled":"")+(i.temporaryDisabled.prevPage?" temporary-disabled":" "),onClick:i.disabled.prevPage?void 0:i.onClick.prevPage,style:{display:i.show.prevPage?"block":"none"},disabled:i.disabled.prevPage||void 0,id:"prev_page",title:D.default.language.languageData.header.page.prev.text}),P.default.createElement("div",{className:"lc-tool-icon-wrap  add-fl page-print not-active"},P.default.createElement("span",{className:"page-print-content button custom-select "},"mobile"===TK.SDKTYPE?P.default.createElement("span",{id:"curr_page",className:"curr-page disabled ",disabled:!0},i.page.currpage):P.default.createElement("input",{id:"curr_page",disabled:!e.state.jumpPage||void 0,className:"curr-page "+(e.state.jumpPage?" ":" disbaled"),type:"text",value:i.page.currpage,onFocus:e.handlerCurrpageOnFocus.bind(e),onBlur:e.handlerCurrpageOnBlur.bind(e),onChange:e.handlerCurrpageOnChange.bind(e),onKeyDown:e.handlerKeyDown.bind(e)}),P.default.createElement("span",{className:"h-page-print-oblique"},"/"),P.default.createElement("span",{id:"all_page",className:"all-page disabled ",disabled:!0},i.page.totalpage),"mobile"===TK.SDKTYPE&&"pad"===D.default.mobileDeviceType?P.default.createElement(V.default,{id:this.pageSelectListId,className:"page-select pad "+(e.state.jumpPage?"":"disabled"),disabled:!e.state.jumpPage,onChange:e.changeSelectPageOnChange.bind(e),selectOptions:v,optionClassName:"page-option",currentValue:i.page.currpage,isMobile:"mobile"===TK.SDKTYPE,pageSelectListPassivityHideNumber:e.state.pageSelectListPassivityHideNumber,noticeSelectExtendListShowOrHide:e.changeSelectPageNoticeSelectExtendListShowOrHide.bind(e)}):void 0)),P.default.createElement("button",{className:"lc-tool-icon-wrap  add-fl arrow-wrap lc-next-page "+(i.disabled.nextPage?" disabled":"")+(i.temporaryDisabled.nextPage?" temporary-disabled":" "),onClick:i.disabled.nextPage?void 0:i.onClick.nextPage,style:{display:i.show.nextPage?"block":"none"},disabled:i.disabled.nextPage||void 0,id:"next_page",title:D.default.language.languageData.header.page.next.text}),P.default.createElement("button",{className:" lc-tool-icon-wrap   add-fl add-page lc-add-page "+(i.disabled.addPage?" disabled":"")+(i.temporaryDisabled.addPage?" temporary-disabled":" "),id:"add_literally_page",onClick:i.disabled.addPage?void 0:i.onClick.addPage,style:{display:i.show.addPage?"block":"none"},disabled:i.disabled.addPage||void 0,title:D.default.language.languageData.header.page.add.text}),P.default.createElement("button",{disabled:f.disabled,className:" lc-tool-icon-wrap   add-fl lc-zoom-small "+(f.disabled?"disabled":""),style:{display:"general"!==e.state.fileTypeMark?"none":""},id:"tool_zoom_small",title:D.default.language.languageData.header.tool.tool_zoom_small.title,onClick:e.handlerWhiteboard_activeCommonWhiteboardToolClick.bind(e,"zoom_small")}),P.default.createElement("button",{disabled:p.disabled,className:" lc-tool-icon-wrap   add-fl lc-zoom-big "+(p.disabled?"disabled":""),style:{display:"general"!==e.state.fileTypeMark?"none":""},id:"tool_zoom_big",title:D.default.language.languageData.header.tool.tool_zoom_big.title,onClick:e.handlerWhiteboard_activeCommonWhiteboardToolClick.bind(e,"zoom_big")}),"phone"!==D.default.mobileDeviceType?P.default.createElement("button",{className:" lc-tool-icon-wrap   add-fl lc-full "+(n?"yes":"no"),id:"lc_full_btn",onClick:i.onClick.fullScreen,title:"general"===a?D.default.language.languageData.header.page.lcFullBtn.title:"dynamicPPT"===a?D.default.language.languageData.header.page.pptFullBtn.title:D.default.language.languageData.header.page.h5FileFullBtn.title}):void 0,"phone"!==D.default.mobileDeviceType?P.default.createElement("span",{style:{display:"dynamicPPT"===a&&d&&(E.default.hasRole.roleChairman||E.default.hasRole.roleTeachingAssistant)?"block":"none"}},P.default.createElement("button",{className:" lc-tool-icon-wrap lc-volume  "+(0===o?"yes":"no"),id:"tk-audio-ppt-volume-slider-id",onClick:e._handlerVolumeMute.bind(e)}),P.default.createElement(Q.default,{className:"tk-audio-ppt-volume-slider",vertical:!0,style:{display:l?"block":"none"},value:void 0!==e.changeVolume?100*e.changeVolume:100*o,onAfterChange:e.volumeOnAfterChange.bind(e),onBeforeChange:e.volumeOnBeforeChange.bind(e)})):void 0,P.default.createElement("button",{className:"lc-tool-icon-wrap add-fl lc-courseware-remarks",id:"coursewareRemarksBtn",onClick:e.remarksClick.bind(e),title:D.default.language.languageData.header.page.coursewareRemarks.title,style:{display:y?"block":"none"}}))))):P.default.createElement("div",{className:"header-left-page-time-container-phone "+e.state.fileTypeMark+" "+("phone"===D.default.mobileDeviceType?"phone ":"pc pad"),id:"page_wrap_phone"}," ",P.default.createElement("button",{className:"lc-tool-icon-wrap add-fl arrow-wrap lc-prev-page "+(i.disabled.prevPage?" disabled":"")+(i.temporaryDisabled.prevPage?" temporary-disabled":" "),onClick:i.disabled.prevPage?void 0:i.onClick.prevPage,style:{display:i.show.prevPage?"block":"none",top:(D.default.windowInnerHeight/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64)/2+"rem",left:"0.2rem"},disabled:i.disabled.prevPage||void 0,id:"prev_page_phone",title:D.default.language.languageData.header.page.prev.text}),P.default.createElement("button",{className:"lc-tool-icon-wrap  add-fl arrow-wrap lc-next-page "+(i.disabled.nextPage?" disabled":"")+(i.temporaryDisabled.nextPage?" temporary-disabled":" "),onClick:i.disabled.nextPage?void 0:i.onClick.nextPage,style:{display:i.show.nextPage?"block":"none",top:(D.default.windowInnerHeight/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64)/2+"rem",left:D.default.windowInnerWidth/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64-.2+"rem"},disabled:i.disabled.nextPage||void 0,id:"next_page_phone",title:D.default.language.languageData.header.page.next.text}),P.default.createElement("button",{disabled:f.disabled,className:" lc-tool-icon-wrap   add-fl lc-zoom-small "+(f.disabled?"disabled":""),style:{display:"general"!==e.state.fileTypeMark?"none":"",top:(D.default.windowInnerHeight/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64)/2+.64+.1+"rem",left:D.default.windowInnerWidth/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64-.2+"rem"},id:"tool_zoom_small_phone",title:D.default.language.languageData.header.tool.tool_zoom_small.title,onClick:e.handlerWhiteboard_activeCommonWhiteboardToolClick.bind(e,"zoom_small")}),P.default.createElement("button",{disabled:p.disabled,className:" lc-tool-icon-wrap   add-fl lc-zoom-big "+(p.disabled?"disabled":""),style:{display:"general"!==e.state.fileTypeMark?"none":"",top:(D.default.windowInnerHeight/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64)/2+1.48+"rem",left:D.default.windowInnerWidth/(D.default.windowInnerWidth/E.default.STANDARDSIZE)-.64-.2+"rem"},id:"tool_zoom_big_phone",title:D.default.language.languageData.header.tool.tool_zoom_big.title,onClick:e.handlerWhiteboard_activeCommonWhiteboardToolClick.bind(e,"zoom_big")}))}}]),t}(P.default.Component);t.default=q},"4MrL":function(e,t){},"4O1h":function(e,t,a){a("jEnx"),e.exports=a("FeBl").Object.is},"4WTo":function(e,t,a){var n=a("NWt+");e.exports=function(e,t){var a=[];return n(e,!1,a.push,a,t),a}},"5PlU":function(e,t,a){var n=a("RY/4"),i=a("dSzd")("iterator"),r=a("/bQp");e.exports=a("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||r.hasOwnProperty(n(t))}},"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},"6G9P":function(e,t,a){"use strict";a("0lA4"),a("PRvV"),a("FDbx"),a("xPSH"),a("292p"),a("9Z7U"),a("4MrL"),a("sKCO"),a("DeyK"),a("CPua"),a("bMTV"),a("WcKi"),a("CUPi"),a("9Xwq"),a("w5fS"),a("rPQW"),a("j1ja"),a("gDty"),a("buLY"),a("PqAP");var n=a("nst9");(0,function(e){return e&&e.__esModule?e:{default:e}}(n).default)()},"6ifl":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),r=n(i),s=a("+6Bu"),o=n(s),l=a("Zx67"),d=n(l),u=a("Zrlr"),c=n(u),h=a("wxAW"),m=n(h),g=a("zwoO"),f=n(g),p=a("Pf15"),v=n(p),b=a("GiK3"),y=n(b),S=a("KSGD"),k=n(S),w=a("T+56"),C=n(w),T=a("DrPG"),P=n(T),A=a("HUPQ"),D=n(A),_=a("yE5a"),E=n(_),I=a("YRCL"),x=n(I),B=a("uObV"),R=n(B),L=function(e){function t(e){(0,c.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.containerWidthAndHeight=Object.customAssign({},a.props.containerWidthAndHeight),a.instanceId=void 0!==a.props.instanceId?a.props.instanceId:"whiteboard_default",a.whiteboardElementId="whiteboard_container_"+a.instanceId,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.showShapeAuthor=void 0!==a.props.showShapeAuthor?a.props.showShapeAuthor:D.default.showShapeAuthor,a}return(0,v.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){var e=this;C.default.CoreController.addEventListener("resizeHandler",e.handlerResizeHandler.bind(e),e.listernerBackupid),e._lcInit()}},{key:"componentWillUnmount",value:function(){var e=this;e.props.saveImage&&R.default.downCanvasImageToLocalFile(e.instanceId),R.default.destroyWhiteboardInstance(e.instanceId),C.default.Window.removeBackupListerner(e.listernerBackupid),C.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){var a=this;e.show!==this.props.show&&this.props.show&&R.default.resizeWhiteboardHandler(a.instanceId),!a.props.containerWidthAndHeight||a.props.containerWidthAndHeight.width===a.containerWidthAndHeight.width&&a.props.containerWidthAndHeight.height===a.containerWidthAndHeight.height||(Object.customAssign(a.containerWidthAndHeight,a.props.containerWidthAndHeight),R.default.updateContainerWidthAndHeight(a.instanceId,a.containerWidthAndHeight)),a.props.isBaseboard!==e.isBaseboard&&R.default.updateIsBaseboard(a.instanceId,a.props.isBaseboard),a.props.watermarkImageScalc!==e.watermarkImageScalc&&R.default.updateWhiteboardWatermarkImageScalc(a.instanceId,a.props.watermarkImageScalc),a.props.dependenceBaseboardWhiteboardID!==e.dependenceBaseboardWhiteboardID&&R.default.updateDependenceBaseboardWhiteboardID(a.instanceId,a.props.dependenceBaseboardWhiteboardID),a.props.deawPermission!==e.deawPermission&&R.default.changeWhiteboardDeawPermission(a.props.deawPermission,a.instanceId),a.props.useToolKey!==e.useToolKey&&R.default.activeWhiteboardTool(a.props.useToolKey,a.instanceId),a.props.useToolColor!==e.useToolColor&&R.default.updateColor(a.instanceId,{primary:a.props.useToolColor}),a.props.pencilWidth!==e.pencilWidth&&R.default.updatePencilWidth(a.instanceId,{pencilWidth:a.props.pencilWidth}),a.props.saveRedoStack!==e.saveRedoStack&&R.default.updateWhiteboardSaveRedoStackAndSaveUndoStack(a.instanceId,{saveRedoStack:a.props.saveRedoStack}),a.props.fontSize!==e.fontSize&&R.default.updateTextFont(a.instanceId,{fontSize:a.props.fontSize}),a.props.imageThumbnailId!==e.imageThumbnailId&&R.default.updateImageThumbnailId(a.instanceId,a.props.imageThumbnailId),a.props.backgroundColor!==e.backgroundColor&&R.default.updateColor(a.instanceId,{background:a.props.backgroundColor}),this.props.watermarkImageUrl!==e.watermarkImageUrl&&R.default.setWhiteboardWatermarkImage(this.instanceId,this.props.watermarkImageUrl)}},{key:"handlerResizeHandler",value:function(e){var t=this;e&&e.message&&void 0!=e.message.eleWHPercent&&R.default.updateWhiteboardMagnification(t.instanceId,e.message.eleWHPercent)}},{key:"sendSignallingToServer",value:function(e,t,a,n,i,r,s,o){x.default.sendSignallingFromSharpsChange(!1,e,t,a,n,i,r,s,o)}},{key:"delSignallingToServer",value:function(e,t,a,n){x.default.sendSignallingFromSharpsChange(!0,e,t,a,n)}},{key:"resizeWhiteboardSizeCallback",value:function(e){this.props.resizeWhiteboardSizeCallback&&"function"==typeof this.props.resizeWhiteboardSizeCallback&&this.props.resizeWhiteboardSizeCallback(e)}},{key:"noticeUpdateToolDescCallback",value:function(e){}},{key:"_lcInit",value:function(){var e=this;if(!R.default.hasWhiteboardById(e.instanceId)){var t={whiteboardElementId:e.whiteboardElementId,id:e.instanceId,productionOptions:{proprietaryTools:!0,isBaseboard:this.props.isBaseboard,dependenceBaseboardWhiteboardID:this.props.dependenceBaseboardWhiteboardID,deawPermission:this.props.deawPermission,containerWidthAndHeight:this.props.containerWidthAndHeight,associatedMsgID:this.props.associatedMsgID,associatedUserID:this.props.associatedUserID,needLooadBaseboard:this.props.needLooadBaseboard,nickname:this.props.nickname,useToolKey:this.props.useToolKey,saveRedoStack:this.props.saveRedoStack,imageThumbnailId:this.props.imageThumbnailId,backgroundColor:this.props.backgroundColor,imageThumbnailTipContent:this.props.imageThumbnailTipContent,showShapeAuthor:this.showShapeAuthor,useImgOriginalSizeToContainerWidthAndHeight:this.props.useImgOriginalSizeToContainerWidthAndHeight,myselfId:E.default.getTkRoom()&&E.default.getTkRoom().getMySelf()?E.default.getTkRoom().getMySelf().id:void 0,undoRedoClearToMySelf:this.props.undoRedoClearToMySelf},handler:{sendSignallingToServer:e.sendSignallingToServer.bind(e),delSignallingToServer:e.delSignallingToServer.bind(e),resizeWhiteboardSizeCallback:e.resizeWhiteboardSizeCallback.bind(e),noticeUpdateToolDescCallback:e.noticeUpdateToolDescCallback.bind(e),whiteboardWatermarkImageOnloadCallback:e.props.whiteboardWatermarkImageOnloadCallback}};this.props.watermarkImageScalc&&(t.productionOptions.watermarkImageScalc=this.props.watermarkImageScalc);var a={tool_pencil:{},tool_eraser:{},tool_text:{}};R.default.productionWhiteboard(t),R.default.registerWhiteboardTools(e.instanceId,a),R.default.clearRedoAndUndoStack(e.instanceId),R.default.hasWhiteboardFiledata(e.instanceId)||R.default.updateWhiteboardFiledata(e.instanceId,R.default.getWhiteboardDefaultFiledata({fileid:this.instanceId,filetype:"blackboard",filename:"blackboard"})),void 0!==this.props.watermarkImageUrl&&R.default.setWhiteboardWatermarkImage(this.instanceId,this.props.watermarkImageUrl),R.default.loadCurrpageWhiteboard(e.instanceId),R.default.resizeWhiteboardHandler(e.instanceId),R.default.updateTextFont(e.instanceId,{fontSize:e.props.fontSize}),R.default.updateColor(e.instanceId,{primary:e.props.useToolColor}),R.default.updatePencilWidth(e.instanceId,{pencilWidth:e.props.pencilWidth})}}},{key:"render",value:function(){var e=this,t=e.props,a=t.show,n=(0,o.default)(t,["show"]);return y.default.createElement("div",(0,r.default)({id:e.whiteboardElementId,style:{display:a?"block":"none"},className:"overflow-hidden  scroll-literally-container "},P.default.filterContainDataAttribute(n)))}}]),t}(y.default.Component);L.propTypes={instanceId:k.default.string.isRequired,containerWidthAndHeight:k.default.object.isRequired,isBaseboard:k.default.bool.isRequired,deawPermission:k.default.bool.isRequired},t.default=L},"7Doy":function(e,t,a){var n=a("EqjI"),i=a("7UMu"),r=a("dSzd")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},"9Bbf":function(e,t,a){"use strict";var n=a("kM2E");e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"9C8M":function(e,t,a){"use strict";var n=a("evD5").f,i=a("Yobk"),r=a("xH/j"),s=a("+ZMJ"),o=a("2KxR"),l=a("NWt+"),d=a("vIB/"),u=a("EGZi"),c=a("bRrM"),h=a("+E39"),m=a("06OY").fastKey,g=a("LIJb"),f=h?"_s":"size",p=function(e,t){var a,n=m(t);if("F"!==n)return e._i[n];for(a=e._f;a;a=a.n)if(a.k==t)return a};e.exports={getConstructor:function(e,t,a,d){var u=e(function(e,n){o(e,u,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[f]=0,void 0!=n&&l(n,a,e[d],e)});return r(u.prototype,{clear:function(){for(var e=g(this,t),a=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete a[n.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var a=g(this,t),n=p(a,e);if(n){var i=n.n,r=n.p;delete a._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),a._f==n&&(a._f=i),a._l==n&&(a._l=r),a[f]--}return!!n},forEach:function(e){g(this,t);for(var a,n=s(e,arguments.length>1?arguments[1]:void 0,3);a=a?a.n:this._f;)for(n(a.v,a.k,this);a&&a.r;)a=a.p},has:function(e){return!!p(g(this,t),e)}}),h&&n(u.prototype,"size",{get:function(){return g(this,t)[f]}}),u},def:function(e,t,a){var n,i,r=p(e,t);return r?r.v=a:(e._l=r={i:i=m(t,!0),k:t,v:a,p:n=e._l,n:void 0,r:!1},e._f||(e._f=r),n&&(n.n=r),e[f]++,"F"!==i&&(e._i[i]=r)),e},getEntry:p,setStrong:function(e,t,a){d(e,t,function(e,a){this._t=g(e,t),this._k=a,this._l=void 0},function(){for(var e=this,t=e._k,a=e._l;a&&a.r;)a=a.p;return e._t&&(e._l=a=a?a.n:e._t._f)?"keys"==t?u(0,a.k):"values"==t?u(0,a.v):u(0,[a.k,a.v]):(e._t=void 0,u(1))},a?"entries":"values",!a,!0),c(t)}}},"9Xwq":function(e,t){},"9Z7U":function(e,t){},ALrJ:function(e,t,a){var n=a("+ZMJ"),i=a("MU5D"),r=a("sB3e"),s=a("QRG4"),o=a("oeOm");e.exports=function(e,t){var a=1==e,l=2==e,d=3==e,u=4==e,c=6==e,h=5==e||c,m=t||o;return function(t,o,g){for(var f,p,v=r(t),b=i(v),y=n(o,g,3),S=s(b.length),k=0,w=a?m(t,S):l?m(t,0):void 0;S>k;k++)if((h||k in b)&&(f=b[k],p=y(f,k,v),e))if(a)w[k]=p;else if(p)switch(e){case 3:return!0;case 5:return f;case 6:return k;case 2:w.push(f)}else if(u)return!1;return c?-1:d||u?u:w}}},BDhv:function(e,t,a){var n=a("kM2E");n(n.P+n.R,"Set",{toJSON:a("m9gC")("Set")})},BO1k:function(e,t,a){e.exports={default:a("fxRn"),__esModule:!0}},CJli:function(e,t,a){a("pRCB");var n=a("FeBl").Object;e.exports=function(e,t){return n.defineProperties(e,t)}},CPua:function(e,t){},CUPi:function(e,t){},Cdx3:function(e,t,a){var n=a("sB3e"),i=a("lktj");a("uqUo")("keys",function(){return function(e){return i(n(e))}})},"CmP/":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},CnnV:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("O27J"),v=(n(p),a("HUPQ")),b=n(v),y=a("VSuD"),S=n(y),k=a("DrPG"),w=(n(k),a("T+56")),C=n(w),T=a("Sa83"),P=n(T),A=a("yE5a"),D=(n(A),a("YRCL")),_=(n(D),a("EXAz")),E=n(_),I=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.state={hoursDiv:"",secondsDiv:"",number:"",timeDescArray:[],triangleStyles:"",numContentBorder:"",timerTeachToolWrapDisplay:"none",studentInit:!1,startAndStop:!1,restarting:!1,startAndStopImg:"none",servicerTimes:"",backGroundFalse:0,resizeInfo:{width:0,height:0}},a.stop=null,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this;C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener("receive-msglist-timer",e.handlerMsglistTimerShow.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;C.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){if(t.timerTeachToolWrapDisplay!==this.state.timerTeachToolWrapDisplay&&"block"===this.state.timerTeachToolWrapDisplay){var a=this.props.id,n=document.getElementById(a);if(n){var i=b.default.windowInnerWidth/S.default.STANDARDSIZE;this.state.resizeInfo.width=n.offsetWidth/i,this.state.resizeInfo.height=n.offsetHeight/i,this.setState({resizeInfo:this.state.resizeInfo})}}}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!1)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"timer":S.default.hasRole.roleStudent&&t.handleTimerShow(a);break;case"UpdateTime":t.state.servicerTimes=a.ts,t.setState({servicerTimes:t.state.servicerTimes})}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"timer":clearInterval(t.stop),t.state.startAndStopImg="none",t.state.timeDescArray=[0,5,0,0],t.setState({timerTeachToolWrapDisplay:"none",startAndStopImg:t.state.startAndStopImg,timeDescArray:t.state.timeDescArray});break;case"ClassBegin":t.setState({timerTeachToolWrapDisplay:"none"})}}},{key:"handlerMsglistTimerShow",value:function(e){var t=this,a=e.message.timerShowArr[0];S.default.hasRole.roleStudent&&t.handleTimerShow(a)}},{key:"handleTimerShow",value:function(e){if(e.data.isShow)return!1;var t=this;setTimeout(function(){t.state.timeDescArray=e.data.sutdentTimerArry,t.setState({timeDescArray:t.state.timeDescArray,timerTeachToolWrapDisplay:"block"});var a=((new Date).getTime()/1e3).toFixed(0)-e.ts,n=600*t.state.timeDescArray[0]+60*t.state.timeDescArray[1]+10*t.state.timeDescArray[2]+1*t.state.timeDescArray[3];if(e.data.isStatus)if(t.state.numContentBorder="black",t.state.startAndStopImg="none",t.setState({startAndStopImg:t.state.startAndStopImg,numContentBorder:t.state.numContentBorder}),t.state.servicerTimes<e.ts)t.stop=setInterval(function(){var i=((new Date).getTime()/1e3).toFixed(0)-a,r=n-(i-e.ts);if(r>0){r>n&&(r=n);var s=parseInt(r/60)<10?"0"+parseInt(r/60):parseInt(r/60),o=parseInt(r%60)<10?"0"+parseInt(r%60):parseInt(r%60);t.state.timeDescArray[0]=parseInt(s/10),t.state.timeDescArray[1]=parseInt(s%10),t.state.timeDescArray[2]=parseInt(o/10),t.state.timeDescArray[3]=parseInt(o%10),t.setState({timeDescArray:t.state.timeDescArray})}else clearInterval(t.stop),t.playAudioToAudiooutput(),t.state.timeDescArray[0]=0,t.state.timeDescArray[1]=0,t.state.timeDescArray[2]=0,t.state.timeDescArray[3]=0,t.state.numContentBorder="red",t.state.startAndStopImg="block",t.setState({timeDescArray:t.state.timeDescArray,numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg})},1e3);else{var i=t.state.servicerTimes-e.ts;t.stop=setInterval(function(){var r=((new Date).getTime()/1e3).toFixed(0)-a,s=n-i-(r-e.ts)-3;if(s>0){s>n&&(s=n);var o=parseInt(s/60)<10?"0"+parseInt(s/60):parseInt(s/60),l=parseInt(s%60)<10?"0"+parseInt(s%60):parseInt(s%60);t.state.timeDescArray[0]=parseInt(o/10),t.state.timeDescArray[1]=parseInt(o%10),t.state.timeDescArray[2]=parseInt(l/10),t.state.timeDescArray[3]=parseInt(l%10),t.setState({timeDescArray:t.state.timeDescArray})}else clearInterval(t.stop),t.playAudioToAudiooutput(),t.state.timeDescArray[0]=0,t.state.timeDescArray[1]=0,t.state.timeDescArray[2]=0,t.state.timeDescArray[3]=0,t.state.numContentBorder="red",t.state.startAndStopImg="block",t.setState({timeDescArray:t.state.timeDescArray,numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg})},1e3)}else t.state.timeDescArray=e.data.sutdentTimerArry,t.setState({timeDescArray:t.state.timeDescArray}),t.state.startAndStopImg="block",t.state.numContentBorder="black",t.setState({startAndStopImg:t.state.startAndStopImg,numContentBorder:t.state.numContentBorder}),clearInterval(t.stop)},10)}},{key:"handlerInitAppPermissions",value:function(){this.state.studentInit=P.default.handler.getAppPermissions("studentInit"),this.setState({studentInit:this.state.studentInit}),0==this.state.studentInit&&(this.state.triangleStyles="hidden",this.state.againStuBtnStyle="none",this.state.startStuBtnStyle="none",this.state.startAndStopImg="none",this.setState({triangleStyle:this.state.triangleStyles,againStuBtnStyle:this.state.againStuBtnStyle,startStuBtnStyle:this.state.startStuBtnStyle,startAndStopImg:this.state.startAndStopImg}))}},{key:"handlerRoomPlaybackClearAll",value:function(){if(!b.default.playback)return void L.Logger.error("No playback environment, no execution event[roomPlaybackClearAll] handler ");this.setState({hoursDiv:"",secondsDiv:"",number:"",timeDescArray:[],triangleStyles:"",numContentBorder:"",timerTeachToolWrapDisplay:"none",studentInit:!1,startAndStop:!1,restarting:!1,startAndStopImg:"none",servicerTimes:""}),this.stop=null}},{key:"_loadTimeDescArrays",value:function(e){var t=this,a=[],n=[];return e.forEach(function(e,i){var r=f.default.createElement("div",{className:"timer-teachTool-num-divs",key:i},f.default.createElement("div",{className:"timer-teachTool-triangle-tops",style:{visibility:t.state.triangleStyles}}),f.default.createElement("div",{className:"timer-teachTool-num-contents",style:{color:t.state.numContentBorder}},e),f.default.createElement("div",{className:"timer-teachTool-triangle-downs",style:{visibility:t.state.triangleStyles}}));i>1?n.push(r):a.push(r)}),{afterArrays:n,beforeArrays:a}}},{key:"playAudioToAudiooutput",value:function(){var e=document.getElementById("ring_audio_student");e&&L.Utils.mediaPlay(e)}},{key:"render",value:function(){var e=this.state,t=e.timeDescArray,a=e.resizeInfo,n=this._loadTimeDescArrays(t),i=n.afterArrays,r=n.beforeArrays,s=this.props,o=s.id,l=s.draggableData,d=s.timerDrag,u=Object.customAssign({id:o,size:a,percentPosition:{percentLeft:d.percentLeft,percentTop:d.percentTop}},l);return f.default.createElement(E.default,u,f.default.createElement("div",{id:o,className:"timer-teachTool-wraps touch-select-select ",style:{display:this.state.timerTeachToolWrapDisplay},ref:"timerTeachToolWrap"},f.default.createElement("div",{className:"timer-teachTool-headers"},f.default.createElement("span",null),f.default.createElement("span",null,b.default.language.languageData.timers.timerSetInterval.text),f.default.createElement("span",{className:"timer-teachTool-closeSpans"})),r,f.default.createElement("div",{className:"timer-teachTool-colons"},f.default.createElement("div",null),f.default.createElement("div",null)),i,f.default.createElement("div",{className:"stop-btn-Imgs",style:{display:this.state.startAndStopImg}}),f.default.createElement("audio",{id:"ring_audio_student",preload:"auto",src:"./music/ring.mp3?ts="+this.listernerBackupid,className:"audio-play"})))}}]),t}(f.default.Component);t.default=I},DeyK:function(e,t){},DrPG:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("W3Iv"),r=n(i),s=a("BO1k"),o=n(s),l=a("d7EF"),d=n(l),u=a("fZjL"),c=n(u),h=a("pFYg"),m=n(h),g={tool:{launchFullscreen:function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},exitFullscreen:function(){document.exitFullScreen?document.exitFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():element.msExitFullscreen&&element.msExitFullscreen()},isFullScreenStatus:function(e){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen||!1},getFullscreenElement:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement},isFullscreenEnabled:function(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled},runPrefixMethod:function(e,t){var a=void 0;return["webkit","moz","ms","o",""].forEach(function(n){if(!a){""===n&&(t=t.slice(0,1).toLowerCase()+t.slice(1));var i=(0,m.default)(e[n+t]);i+""!="undefined"&&(a="function"===i?e[n+t]():e[n+t])}}),a},addFullscreenchange:function(e){g.tool.addEvent(document,"fullscreenchange",e,!1),g.tool.addEvent(document,"webkitfullscreenchange",e,!1),g.tool.addEvent(document,"mozfullscreenchange",e,!1),g.tool.addEvent(document,"MSFullscreenChange",e,!1),g.tool.addEvent(document,"msfullscreenchange",e,!1),g.tool.addEvent(document,"fullscreeneventchange",e,!1)},removeFullscreenchange:function(e){g.tool.removeEvent(document,"fullscreenchange",e,!1),g.tool.removeEvent(document,"webkitfullscreenchange",e,!1),g.tool.removeEvent(document,"mozfullscreenchange",e,!1),g.tool.removeEvent(document,"MSFullscreenChange",e,!1),g.tool.removeEvent(document,"msfullscreenchange",e,!1),g.tool.removeEvent(document,"fullscreeneventchange",e,!1)},addFullscreenerror:function(e){g.tool.addEvent(document,"fullscreenerror",e,!1),g.tool.addEvent(document,"webkitfullscreenerror",e,!1),g.tool.addEvent(document,"mozfullscreenerror",e,!1),g.tool.addEvent(document,"MSFullscreenError",e,!1),g.tool.addEvent(document,"msfullscreenerror",e,!1),g.tool.addEvent(document,"fullscreenerroreventchange",e,!1)},removeFullscreenerror:function(e){g.tool.removeEvent(document,"fullscreenerror",e,!1),g.tool.removeEvent(document,"webkitfullscreenerror",e,!1),g.tool.removeEvent(document,"mozfullscreenerror",e,!1),g.tool.removeEvent(document,"MSFullscreenError",e,!1),g.tool.removeEvent(document,"msfullscreenerror",e,!1),g.tool.removeEvent(document,"fullscreenerroreventchange",e,!1)},addEvent:function(e,t,a,n){n=void 0!=n&&null!=n&&n,e.addEventListener?e.addEventListener(t,a,n):e.attachEvent?e.attachEvent("on"+t,a):e["on"+t]=a},removeEvent:function(e,t,a,n){e.addEventListener?e.removeEventListener(t,a,n):e.attachEvent?e.detachEvent("on"+t,a):e["on"+t]=null},fireEvent:function(e,t){if(document.createEventObject){var a=document.createEventObject();return e.fireEvent("on"+t,a)}var n=document.createEvent("HTMLEvents");return n.initEvent(t,!0,!0),!e.dispatchEvent(n)},autoElementPositionCneter:function(e){e.css({"margin-left":-e.width()/2+"px","margin-top":-e.height()/2+"px"})},clearElementPositionCneter:function(e){e.css({"margin-left":"","margin-top":""})}},getGUID:function(){function e(){this.date=new Date,"function"!=typeof this.newGUID&&(e.prototype.newGUID=function(){this.date=new Date;for(var e="",t=this.hexadecimal(this.getGUIDDate(),16),a=this.hexadecimal(this.getGUIDTime(),16),n=0;n<9;n++)e+=Math.floor(16*Math.random()).toString(16);for(e+=t,e+=a;e.length<32;)e+=Math.floor(16*Math.random()).toString(16);return this.formatGUID(e)},e.prototype.getGUIDDate=function(){return this.date.getFullYear()+this.addZero(this.date.getMonth()+1)+this.addZero(this.date.getDay())},e.prototype.getGUIDTime=function(){return this.addZero(this.date.getHours())+this.addZero(this.date.getMinutes())+this.addZero(this.date.getSeconds())+this.addZero(parseInt(this.date.getMilliseconds()/10))},e.prototype.addZero=function(e){return"NaN"!=Number(e).toString()&&e>=0&&e<10?"0"+Math.floor(e):e.toString()},e.prototype.hexadecimal=function(e,t,a){return void 0!=a?parseInt(e.toString(),a).toString(t):parseInt(e.toString()).toString(t)},e.prototype.formatGUID=function(e){return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)})}return new e},getNewGUID:function(){g.guidObj||(g.guidObj=new g.getGUID);var e=g.guidObj.newGUID();return g.guidObj=null,e},getBrowserInfo:function(){var e=window.navigator.userAgent,t=/(msie\s|trident.*rv:)([\w.]+)/,a=/(firefox)\/([\w.]+)/,n=/(opera).+version\/([\w.]+)/,i=/(chrome)\/([\w.]+)/,r=/version\/([\w.]+).*(safari)/,s=function(e){var s=t.exec(e);return null!=s?{browser:"IE",version:s[2]||"0"}:null!=(s=a.exec(e))?{browser:s[1]||"",version:s[2]||"0"}:null!=(s=n.exec(e))?{browser:s[1]||"",version:s[2]||"0"}:null!=(s=i.exec(e))?{browser:s[1]||"",version:s[2]||"0"}:(s=r.exec(e),null!=s?{browser:s[2]||"",version:s[1]||"0"}:null!=s?{browser:"",version:"0"}:{browser:"unknown",version:"unknown"})}(e.toLowerCase());return{versions:function(){var e=navigator.userAgent;return navigator.appVersion,{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase(),info:{browserName:s.browser,browserVersion:s.version,appCodeName:navigator.appCodeName,appMinorVersion:navigator.appMinorVersion,appName:navigator.appName,appVersion:navigator.appVersion,browserLanguage:navigator.browserLanguage,cookieEnabled:navigator.cookieEnabled,cpuClass:navigator.cpuClass,onLine:navigator.onLine,platform:navigator.platform,systemLanguage:navigator.systemLanguage,userAgent:navigator.userAgent,userLanguage:navigator.userLanguage}}},isEmpty:function(e){return 0===(0,c.default)(e).length},getUrlParams:function(e,t){var a=window.location.href;window.TkConstant&&(a=g.decrypt(window.TkConstant.SERVICEINFO.joinUrl)||window.location.href),a=t||a;var n=decodeURIComponent(a),i=n.indexOf("?"),r=n.substring(i+1),s=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=r.match(s);return null!=o?o[2]:""},replaceFirstUper:function(e){if(e.length>0)return e.substring(0,1).toUpperCase()+e.substring(1)},isArray:function(e){return Array&&Array.isArray&&"function"==typeof Array.isArray?Array.isArray(e):e&&"object"===(void 0===e?"undefined":(0,m.default)(e))&&"number"==typeof e.length&&"function"==typeof e.splice&&!e.propertyIsEnumerable("length")},filterContainDataAttribute:function(e){var t=g;if(e&&!t.isArray(e)&&"object"===(void 0===e?"undefined":(0,m.default)(e))){var a={},n=!0,i=!1,s=void 0;try{for(var l,u=(0,o.default)((0,r.default)(e));!(n=(l=u.next()).done);n=!0){var c=l.value,h=(0,d.default)(c,2),f=h[0],p=h[1];/^tkcustomdata/g.test(f)&&(a[f]=p)}}catch(e){i=!0,s=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw s}}return a}return e},getFiletyeByFilesuffix:function(e){return"jpg"==e||"jpeg"==e||"png"==e||"gif"==e||"ico"==e||"bmp"==e?"jpg":"doc"==e||"docx"==e||"rtf"==e?"doc":"pdf"==e?"pdf":"ppt"==e||"pptx"==e||"pps"==e?"ppt":"txt"==e?"txt":"xls"==e||"xlsx"==e?"xlsx":"mp4"==e||"webm"==e?"mp4":"mp3"==e||"wav"==e?"mp3":"zip"==e?"h5":"whiteboard"===e?"whiteboard":"other"},isFunction:function(e){return e&&"function"==typeof e},getCustomUserPropertyByUser:function(e){return{disableaudio:e.disableaudio,disablevideo:e.disablevideo,giftnumber:e.giftnumber,hasaudio:e.hasaudio,hasvideo:e.hasvideo,publishstate:e.publishstate,raisehand:e.raisehand}},getTimeDifferenceToFormat:function(e,t){var a=t-e;if(a>=0){var n=Math.floor(a/864e5),i=a%864e5,r=Math.floor(i/36e5),s=i%36e5,o=Math.floor(s/6e4),l=s%6e4,d=Math.round(l/1e3),u=r+24*n,c={};return d>=60&&(d=0,o+=1),o>=60&&(o=0,u+=1),c.hh=u>9?u:"0"+u,c.mm=o>9?o:"0"+o,c.ss=d>9?d:"0"+d,c}return void L.Logger.error("Start time is greater than end time [start:"+e+"  , end:"+t+"]!")},isMillisecondClass:function(e){if("number"!=typeof e)return void L.Logger.error("time must is number!");e=String(e);var t=e.length;return 13===t||10!==t&&void L.Logger.warning("The incoming time is incorrect and cannot be judged to be second or second!")},encrypt:function(e,t){if(!e)return e;if(window.TkConstant){if(window.TkConstant.DEV)return e}else{var a=!1;try{a=!1}catch(e){L.Logger.warning("There is no configuration dev mark[__DEV__]!")}if(a||g.getUrlParams("debug"))return e}return L.Utils.encrypt(e,t)},decrypt:function(e,t){if(!e)return e;if(window.TkConstant){if(window.TkConstant.DEV)return e}else if(g.getUrlParams("debug"))return e;return L.Utils.decrypt(e,t)},detectOS:function(){var e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,a="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(a)return"Mac";if("X11"===navigator.platform&&!t&&!a)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Win2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"WinXP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Win2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"WinVista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Win7";if(e.indexOf("Windows NT 6.2")>-1||e.indexOf("Windows 8")>-1)return"Win8";if(e.indexOf("Windows NT 10.0")>-1||e.indexOf("Windows 10")>-1)return"Win10"}return"Other"},percentageChangeToRem:function(e,t,a){var n=window.GLOBAL.windowInnerWidth/TkConstant.STANDARDSIZE,i=document.getElementById(a);if(i){var r=i.offsetWidth,s=i.offsetHeight,o=void 0,l=void 0;if("pc"===TK.SDKTYPE){var d=document.getElementById("lc-full-vessel");o=d.clientWidth,l=d.clientHeight}else o=window.GLOBAL.windowInnerWidth,l=window.GLOBAL.windowInnerHeight;var u=e*(o-r)/n,c=t*(l-s)/n;return u=u&&u!==1/0&&!isNaN(u)&&u>0?u:0,c=c&&c!==1/0&&!isNaN(c)&&c>0?c:0,{left:u,top:c}}return{left:0,top:0}},RemChangeToPercentage:function(e,t,a){var n=window.GLOBAL.windowInnerWidth/TkConstant.STANDARDSIZE,i=document.getElementById(a);if(i){var r=i.offsetWidth,s=i.offsetHeight,o=void 0,l=void 0;if("pc"===TK.SDKTYPE){var d=document.getElementById("lc-full-vessel");o=d.clientWidth,l=d.clientHeight}else o=window.GLOBAL.windowInnerWidth,l=window.GLOBAL.windowInnerHeight;var u=e*n/(o-r),c=t*n/(l-s);return u=u&&u!==1/0&&!isNaN(u)&&u>0?u:0,c=c&&c!==1/0&&!isNaN(c)&&c>0?c:0,{percentLeft:u,percentTop:c}}return{percentLeft:0,percentTop:0}},controlDragBounds:function(e,t,a){var n=window.GLOBAL.windowInnerWidth/TkConstant.STANDARDSIZE,i=document.getElementById(t),r=i.offsetWidth/n,s=i.offsetHeight/n,o=document.getElementById(a),l=o.clientWidth/n,d=o.clientHeight/n;return e.state[t].left=e.state[t].left<0?e.state[t].left=0:e.state[t].left,e.state[t].left=e.state[t].left>l-r?l-r:e.state[t].left,e.state[t].top=e.state[t].top<0?e.state[t].top=0:e.state[t].top,e.state[t].top=e.state[t].top>d-s?d-s:e.state[t].top,e.state[t]},replaceRemToNumber:function(e){return e&&"string"==typeof e&&(e=Number(e.replace(/rem/g,""))),e},replaceCalc:function(e){return e&&"string"==typeof e&&(e=e.replace(/(^\s*)|(\s*$)/g,""),e=e.replace(/(^calc\s*\(|\)$)/g,"")),e},limitEleReSize:function(e,t,a){var n=window.GLOBAL.windowInnerWidth/TkConstant.STANDARDSIZE,i=window.GLOBAL.windowInnerWidth/n,r=window.GLOBAL.windowInnerHeight/n;if("pc"===TK.SDKTYPE){var s=document.getElementById("lc-full-vessel");i=s.clientWidth/n,r=s.clientHeight/n}return(e>i||t>r)&&(a>i/r?(e=i,t=i/a):(t=r,e=r*a)),{width:e,height:t}}};t.default=g},E09H:function(e,t){},EXAz:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),r=n(i),s=a("KmDb"),o=n(s),l=a("g4PW"),d=n(l),u=a("Zx67"),c=n(u),h=a("Zrlr"),m=n(h),g=a("wxAW"),f=n(g),p=a("zwoO"),v=n(p),b=a("Pf15"),y=n(b),S=a("GiK3"),k=n(S),w=a("O27J"),C=n(w),T=a("HUPQ"),P=n(T),A=a("T+56"),D=n(A),_=a("VSuD"),E=n(_),I=a("FH8v"),x=n(I),B=function(e){function t(e){(0,m.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return a.state={position:{top:e.defaultPosition?e.defaultPosition.top:0,left:e.defaultPosition?e.defaultPosition.left:0},size:{width:e.defaultSize?e.defaultSize.width:void 0,height:e.defaultSize?e.defaultSize.height:void 0},opacity:1,scale:1,isCanDrag:!1},a.newSize={},a.position={top:0,left:0},a.clientX=0,a.clientY=0,a.isCanDrag=!1,a.isDragging=!1,a.isResizing=!1,a.scale=0,a.onTouchTime=null,a.longTouchTime=500,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,y.default)(t,e),(0,f.default)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){D.default.Window.addEventListener(E.default.EVENTTYPE.WindowEvent.onResize,this.handlerOnResize.bind(this),this.listernerBackupid),D.default.Document.addEventListener(E.default.EVENTTYPE.DocumentEvent.onFullscreenchange,this.handlerOnFullscreenchange.bind(this),this.listernerBackupid),D.default.CoreController.addEventListener("resizeHandler",this.handlerOnResize.bind(this),this.listernerBackupid),D.default.CoreController.addEventListener("changeMainContentVesselSmartSize",this.changeMainContentVesselSmartSize.bind(this),this.listernerBackupid)}},{key:"componentWillUnmount",value:function(){D.default.Window.removeBackupListerner(this.listernerBackupid),D.default.CoreController.removeBackupListerner(this.listernerBackupid),D.default.Document.removeBackupListerner(this.listernerBackupid)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,a=(t.id,t.size),n=t.percentPosition;if(e.percentPosition&&(!this.props.percentPosition||!(0,d.default)(e.percentPosition.percentLeft,n.percentLeft)||!(0,d.default)(e.percentPosition.percentTop,n.percentTop))){var i=this.getPosition(e.percentPosition,e.size);this.state.position=Object.customAssign(this.state.position,i),this.setState({position:this.state.position})}if(e.size&&(!a||!(0,d.default)(e.size.width,a.width)||!(0,d.default)(e.size.height,a.height))){var r=this.getPosition(e.percentPosition,e.size);this.state.position=Object.customAssign(this.state.position,r),this.setState({position:this.state.position,size:{width:e.size.width,height:e.size.height}})}}},{key:"handlerOnResize",value:function(){this.recalculation()}},{key:"handlerOnFullscreenchange",value:function(){this.recalculation()}},{key:"changeMainContentVesselSmartSize",value:function(){this.recalculation()}},{key:"recalculation",value:function(){var e=this.props,t=e.id,a=e.percentPosition,n=e.canResize,i=e.changeEleReSize,r=this.getPosition(a);this.state.position=Object.customAssign(this.state.position,r),this.setState({position:this.state.position}),n&&(this.newSize=this.limitResizeBounds(this.state.size),i&&"function"==typeof i&&i(t,this.newSize))}},{key:"getPosition",value:function(e,t){var a=this.props,n=a.dragBounds,i=void 0===n?"#tk_app":n,r=a.borderWidth,s=void 0===r?0:r,o=C.default.findDOMNode(this),l=void 0;if("string"==typeof i&&(l=document.querySelector(i)),o&&l&&e&&void 0!==e.percentLeft&&void 0!==e.percentTop){var d=P.default.windowInnerWidth/E.default.STANDARDSIZE,u=t?t.width*d+2*s*d:o.offsetWidth,c=t?t.height*d+2*s*d:o.offsetHeight,h=l.offsetWidth,m=l.offsetHeight,g=e.percentLeft*(h-u),f=e.percentTop*(m-c);return g=isNaN(g)||g===1/0||null===g||g<0?0:g,f=isNaN(f)||f===1/0||null===f||f<0?0:f,{left:g,top:f}}return{left:0,top:0}}},{key:"getPercentPosition",value:function(e){var t=this.props.dragBounds,a=void 0===t?"#tk_app":t,n=C.default.findDOMNode(this),i=void 0;if("string"==typeof a&&(i=document.querySelector(a)),n&&i&&e&&void 0!==e.left&&void 0!==e.top){var r=n.offsetWidth,s=n.offsetHeight,o=i.offsetWidth,l=i.offsetHeight,d=e.left/(o-r),u=e.top/(l-s);return d=isNaN(d)||d===1/0||null===d||d<0?0:d,u=isNaN(u)||u===1/0||null===u||u<0?0:u,{percentLeft:d,percentTop:u}}return{percentLeft:0,percentTop:0}}},{key:"limitDragBounds",value:function(e){var t=this.props.dragBounds,a=C.default.findDOMNode(this),n=void 0;return"string"==typeof t&&(n=document.querySelector(t)),a&&n&&void 0!==e.left&&void 0!==e.top&&(e.left=e.left<0?0:e.left>n.offsetWidth-a.offsetWidth?n.offsetWidth-a.offsetWidth:e.left,e.top=e.top<0?0:e.top>n.offsetHeight-a.offsetHeight?n.offsetHeight-a.offsetHeight:e.top),e}},{key:"limitResizeBounds",value:function(e){var t=this.props,a=t.dragBounds,n=t.defaultSize,i=t.minResize,r=t.borderWidth,s=void 0===r?0:r,o=C.default.findDOMNode(this),l=e.width,d=e.height;if(!n||!o)return e;var u=n.originalResizeScale,c=void 0,h=void 0,m=void 0;"string"==typeof a&&(c=document.querySelector(a),h=c.clientWidth,m=c.clientHeight);var g=window.innerWidth/E.default.STANDARDSIZE;return i&&(u>i.width/i.height?d<i.height&&(d=i.height,l=d*u):l<i.width&&(l=i.width,d=l/u)),c&&(l>=h/g-2*s||d>=m/g-2*s)&&(u>h/m?(l=h/g-2*s,d=l/u):(d=m/g-2*s,l=d*u)),{width:l,height:d}}},{key:"onPress",value:function(){}},{key:"onPressUp",value:function(){}},{key:"onTouchStart",value:function(e){var t=this;e.persist();var a=this.props.handle;if(a&&e.target&&"string"==typeof a){var n=C.default.findDOMNode(this).querySelector(a);if(e.target!==n&&$(e.target).parents(a).length<=0)return}clearTimeout(this.onTouchTime),this.clientX=e.targetTouches[0].clientX,this.clientY=e.targetTouches[0].clientY,this.position.left=this.state.position.left||0,this.position.top=this.state.position.top||0,this.onTouchTime=setTimeout(function(){t.state.isCanDrag=!0,t.setState({isCanDrag:t.state.isCanDrag});var a=t.props.onPanStart;a&&"function"==typeof a&&a(e)},this.longTouchTime)}},{key:"onTouchMove",value:function(e){var t=Math.abs(e.touches[0].clientX-this.clientX),a=Math.abs(e.touches[0].clientY-this.clientY);if((0,o.default)(t,a)>=40&&clearTimeout(this.onTouchTime),this.state.isCanDrag){this.state.position.top=this.position.top+e.targetTouches[0].clientY-this.clientY,this.state.position.left=this.position.left+e.targetTouches[0].clientX-this.clientX;var n=this.limitDragBounds(this.state.position);this.setState({position:n}),e.preventDefault()}}},{key:"onTouchEnd",value:function(e){if(clearTimeout(this.onTouchTime),this.state.isCanDrag=!1,this.setState({isCanDrag:this.state.isCanDrag}),this.clientX=0,this.clientY=0,this.position.left=0,this.position.top=0,this.state.isCanDrag){var t=this.getPercentPosition(this.state.position),a=this.props,n=a.onPanEnd,i=a.id;n&&"function"==typeof n&&n(e,this.state.position,t,i)}}},{key:"onPinchStart",value:function(e){this.scale=this.state.scale||1;var t=this.props.onPinchStart;t&&"function"==typeof t&&t(e)}},{key:"onPinch",value:function(e){var t=this.props,a=t.id,n=t.onPinch;t.defaultSize&&(this.state.scale=this.scale*e.scale,this.newSize.width=this.props.defaultSize.width*this.state.scale,this.newSize.height=this.props.defaultSize.height*this.state.scale,this.newSize=this.limitResizeBounds(this.newSize),this.setState({size:this.newSize}),n&&"function"==typeof n&&n(e,a,this.newSize))}},{key:"onPinchEnd",value:function(e){var t=this.props,a=t.id,n=t.onPinchEnd;n&&"function"==typeof n&&n(e,a,this.newSize)}},{key:"onPinchIn",value:function(e){}},{key:"onPinchOut",value:function(e){}},{key:"onPinchCancel",value:function(e){}},{key:"render",value:function(){var e=this.props,t=(e.id,e.disabled),a=e.canResize,n=this.state,i=n.position,s=n.size,o=(n.opacity,n.isCanDrag),l={left:i.left+"px",top:i.top+"px",width:s.width+"rem",height:s.height+"rem",pointerEvents:o?"none":"auto",boxShadow:o?"0 0 0.2rem 0.05rem #222":void 0,transform:o?"scale(1.05)":void 0},d={recognizers:{pinch:{enable:a}}},u=k.default.Children.only(this.props.children),c={options:d,onPinchStart:this.onPinchStart.bind(this),onPinch:this.onPinch.bind(this),onPinchEnd:this.onPinchEnd.bind(this),onPinchIn:this.onPinchIn.bind(this),onPinchOut:this.onPinchOut.bind(this),onPress:this.onPress.bind(this),onPressUp:this.onPressUp.bind(this)};return k.default.createElement(x.default,c,k.default.cloneElement(u,{style:(0,r.default)({},u.props.style,l),onTouchStart:!0===t?void 0:this.onTouchStart.bind(this),onTouchMove:!0===t?void 0:this.onTouchMove.bind(this),onTouchEnd:!0===t?void 0:this.onTouchEnd.bind(this)}))}}]),t}(k.default.Component);t.default=B},F5u0:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("bA4h"),v=n(p);a("E09H");var b=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.state={updateState:!1},a.isSlidering=!1,a.changeValue=void 0,a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"onChange",value:function(e){this.isSlidering&&(this.changeValue=e,this.setState({updateState:!this.state.updateState})),this.props.onChange&&"function"==typeof this.props.onChange&&this.props.onChange(e)}},{key:"onBeforeChange",value:function(e){this.isSlidering=!0,this.changeValue=e,this.props.onBeforeChange&&"function"==typeof this.props.onBeforeChange&&this.props.onBeforeChange(e)}},{key:"onAfterChange",value:function(e){this.isSlidering=!1,this.changeValue=void 0,this.props.onAfterChange&&"function"==typeof this.props.onAfterChange&&this.props.onAfterChange(e)}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.disabled,n=e.vertical,i=e.style;return f.default.createElement(v.default,{style:i,vertical:n,className:t,disabled:a,value:void 0!==this.changeValue?this.changeValue:this.props.value,onChange:this.onChange.bind(this),onBeforeChange:this.onBeforeChange.bind(this),onAfterChange:this.onAfterChange.bind(this)})}}]),t}(f.default.Component);t.default=b},FDbx:function(e,t){},Geq7:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),r=n(i),s=a("Zx67"),o=n(s),l=a("Zrlr"),d=n(l),u=a("wxAW"),c=n(u),h=a("zwoO"),m=n(h),g=a("Pf15"),f=n(g),p=a("GiK3"),v=n(p),b=a("VSuD"),y=n(b),S=a("T+56"),k=n(S),w=a("DrPG"),C=n(w),T=a("YRCL"),P=n(T),A=a("Sa83"),D=n(A),_=a("HUPQ"),E=n(_),I=a("yE5a"),x=n(I),B=function(e){function t(e){(0,d.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.h5FileId=null,a.state={updateState:!1,h5Loading:!1,h5DocumentActionClick:D.default.handler.getAppPermissions("h5DocumentActionClick")},a.h5FileSrc="",a.forceReloadNumber=0,a.changeDocLineReloadNumber=0,a.maxForceReloadNumber=10,a.H5IsOnload=!1,a.h5ActionJson={},a}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;this.h5Frame=document.getElementById("h5DocumentFrame").contentWindow,k.default.Window.addEventListener(y.default.EVENTTYPE.WindowEvent.onMessage,t.handlerOnMessage.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener(y.default.EVENTTYPE.RoomEvent.roomPubmsg,t.handlerRoomPubmsg.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener(y.default.EVENTTYPE.RoomEvent.roomDelmsg,t.handlerRoomDelmsg.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("openDocuemntOrMediaFile",t.handlerOpenDocuemntOrMediaFile.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("receive-msglist-ShowPage-lastDocument",t.handlerShowLastDocument.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("initAppPermissions",t.handlerInitAppPermissions.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("h5DocumentPageUpClick",t.handlerH5FilePageUpClick.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("h5DocumentPageDownClick",t.handlerH5FilePageDownClick.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("setH5FileFrameSrc",t.setH5FileFrameSrc.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("updateAppPermissions_h5DocumentPagingPage",t.handlerUpdateAppPermissions_h5DocumentPagingPage.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("updateAppPermissions_h5DocumentActionClick",t.handlerUpdateAppPermissions_h5DocumentActionClick.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("skipPage_h5document",t.handlerSkipPage_h5document.bind(t),t.listernerBackupid),k.default.CoreController.addEventListener("changeLine",t.handlerChangeLine.bind(t),t.listernerBackupid),document.getElementById("h5DocumentFrame").onload=function(){return clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.h5FileSrc&&!e.H5IsOnload&&e.forceReloadNumber<e.maxForceReloadNumber&&e._setReloadIframeTimeout("awitIframeNoticeLoadFinish"),!1}}},{key:"componentWillUnmount",value:function(){var e=this;k.default.CoreController.removeBackupListerner(e.listernerBackupid),k.default.Window.removeBackupListerner(e.listernerBackupid),clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=null}},{key:"handlerChangeLine",value:function(){"h5document"===this.props.fileTypeMark&&(this.changeDocLineReloadNumber++,this.setState({updateState:!this.state.updateState}))}},{key:"_setReloadIframeTimeout",value:function(e){var t=this;clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=null,this.h5FileSrc&&!this.H5IsOnload&&this.forceReloadNumber<this.maxForceReloadNumber&&(clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=setTimeout(function(){if(t.h5FileSrc&&!t.H5IsOnload&&t.forceReloadNumber<t.maxForceReloadNumber){t.forceReloadNumber++;var a=E.default.docAddressList[E.default.docAddressIndex]||y.default.SERVICEINFO.docAddress;E.default.docAddressIndex=++E.default.docAddressIndex%E.default.docAddressList.length,"mobile"===TK.SDKTYPE?"function"==typeof x.default.getTkRoom().setLocalStorageItem&&x.default.getTkRoom().setLocalStorageItem("tkDocAddressIndex",E.default.docAddressIndex):L.Utils.localStorage.setItem("tkDocAddressIndex",E.default.docAddressIndex),E.default.nowUseDocAddress=E.default.docAddressList[E.default.docAddressIndex]||y.default.SERVICEINFO.docAddress,L.Logger.info("[reload h5 document]change doc address , old address is "+a+" , now address is "+E.default.nowUseDocAddress),L.Logger.info("["+e+"]load h5 document failure , reload file , old url is "+document.getElementById("h5DocumentFrame").src+" , now url is "+(t.h5FileSrc?E.default.nowUseDocAddress+t.h5FileSrc+(t.forceReloadNumber?"?forceReloadNumber="+t.forceReloadNumber:""):"")+" , reload number is "+t.forceReloadNumber),t.setState({updateState:!t.state.updateState}),t._setReloadIframeTimeout("reload")}},6e4))}},{key:"handlerUpdateAppPermissions_h5DocumentPagingPage",value:function(){if("h5document"===this.props.fileTypeMark){var e=function(e){k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:e}})};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:e}})}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=this,n=e.message;switch(n.name){case"ShowPage":var i=a.h5FileId!==n.data.filedata.fileid;a.h5FileId=n.data.filedata.fileid,a._handlerReceiveShowPageSignalling({message:{data:n.data,open:i,source:"room-pubmsg"}});break;case"H5DocumentAction":var s=function(e){var i=e.currpage,s=n.data;!1===t.H5IsOnload&&E.default.playback&&(t.h5ActionJson[i]&&t.h5ActionJson[i].length>0?t.h5ActionJson[i].push(s):(t.h5ActionJson[i]=[],t.h5ActionJson[i].push(s))),a.h5Frame.postMessage((0,r.default)(s),"*")};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:s}})}}},{key:"handlerRoomDelmsg",value:function(e){}},{key:"handlerOnMessage",value:function(e){var t=this,a=e.message.event;t.handlerIframeMessage(a)}},{key:"handlerIframeMessage",value:function(e){var t=this,a=this;if(e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(t){return void L.Logger.warning("iframe message data can't be converted to JSON , iframe data:",e.data)}if(n.method)switch(L.Logger.debug("[h5]receive remote iframe data form "+e.origin+":",e),n.method){case"onPagenum":var i=n.totalPages,s=function(e){e.pagenum=i,e.currpage>e.pagenum&&(e.currpage=e.pagenum),e.currpage<1&&(e.currpage=1),k.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:e}})};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:s}}),a.initH5Document(i);break;case"onFileMessage":n.method="onFileMessage",P.default.sendSignallingFromH5DocumentAction(n),k.default.CoreController.dispatchEvent({type:"resetAllLeftToolButtonOpenStateToFalse"});break;case"onLoadComplete":this.H5IsOnload=!0,clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=null,this.setState({h5Loading:!1});var o=function(e){a.h5FileJumpPage(e);var n=e.currpage;!C.default.isEmpty(t.h5ActionJson)&&t.h5ActionJson[n]&&0!==t.h5ActionJson[n].length&&(t.h5ActionJson[n].map(function(e,t){a.h5Frame.postMessage((0,r.default)(e),"*")}),t.h5ActionJson={})},l=n.coursewareRatio||16/9;k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:o}}),k.default.CoreController.dispatchEvent({type:"updateLcScaleWhenAynicPPTInitHandler",message:{lcLitellyScalc:l}})}}}},{key:"initH5Document",value:function(e){this._sendDocumentPageChangeAndSaveWhiteboard(e)}},{key:"handlerInitAppPermissions",value:function(e){this._sendDocumentPageChangeAndSaveWhiteboard()}},{key:"handlerUpdateAppPermissions_h5DocumentActionClick",value:function(){this.setState({h5DocumentActionClick:D.default.handler.getAppPermissions("h5DocumentActionClick")})}},{key:"handlerSkipPage_h5document",value:function(e){var t=this;if("h5document"===t.props.fileTypeMark){var a=e.message.currpage;t._skipH5documentPaging(a)}}},{key:"handlerOpenDocuemntOrMediaFile",value:function(e){var t=this,a=e.message,n=t.h5FileId!==a.filedata.fileid;t.h5FileId=a.filedata.fileid,a.isH5Document&&t._handlerReceiveShowPageSignalling({message:{data:a,open:n,source:"h5DocumentClickEvent"}})}},{key:"handlerShowLastDocument",value:function(e){e.message.open=this.h5FileId!==e.message.data.filedata.fileid,this.h5FileId=e.message.data.filedata.fileid,this._handlerReceiveShowPageSignalling(e)}},{key:"_handlerReceiveShowPageSignalling",value:function(e){var t=this,a=e.message.data,n=e.message.open;if(this.h5FileId=a.filedata.fileid,t.h5DocumentData=a,!a.isMedia&&a.isH5Document){var i=!1,r=function(t){n||(a.filedata.pagenum=t.pagenum,"room-pubmsg"===e.message.source&&Number(a.filedata.currpage)===t.currpage&&(i=!0))};if(k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:r}}),i)return;"room-pubmsg"!==e.message.source&&"room-msglist"!==e.message.source&&"h5DocumentClickEvent"!==e.message.source||1==e.message.open&&t._openH5DocumentHandler(a.filedata),t.slideChangeToLc(a.filedata),t.h5FileJumpPage(a.filedata)}}},{key:"h5FileJumpPage",value:function(e){if(this.H5IsOnload){var t=!1;e.currpage>e.pagenum&&(e.currpage=e.pagenum,t=!0),e.currpage<1&&(e.currpage=1,t=!0),t&&(k.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:e}}))}var a=e.currpage,n=(0,r.default)({method:"onJumpPage",toPage:a});this.h5Frame.postMessage(n,"*"),this._sendDocumentPageChangeAndSaveWhiteboard(e.pagenum,a)}},{key:"_openH5DocumentHandler",value:function(e){var t=this,a=e.swfpath;t.props.changeFileTypeMark("h5document"),k.default.CoreController.dispatchEvent({type:"resetLcDefault"}),k.default.CoreController.dispatchEvent({type:"updateLcScaleWhenAynicPPTInitHandler",message:{lcLitellyScalc:16/9}}),k.default.CoreController.dispatchEvent({type:"setNewPptFrameSrc",message:{src:""}}),this.H5IsOnload=!1,this.h5FileSrc=a,this.forceReloadNumber=0,this._setReloadIframeTimeout("open"),this.setState({updateState:!this.state.updateState,h5Loading:!!this.h5FileSrc}),k.default.CoreController.dispatchEvent({type:"checkSelectMouseState",message:{fileTypeMark:"h5document"}})}},{key:"setH5FileFrameSrc",value:function(e){var t=e.message.src;this.h5FileSrc=t||"",this.forceReloadNumber=0,this._setReloadIframeTimeout("open"),this.setState({updateState:!this.state.updateState,h5Loading:!!this.h5FileSrc})}},{key:"slideChangeToLc",value:function(e){k.default.CoreController.dispatchEvent({type:"saveLcStackToStorage",message:{}}),k.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),k.default.CoreController.dispatchEvent({type:"recoverCurrpageLcData"}),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:e}})}},{key:"handlerH5FilePageUpClick",value:function(){var e=this,t=(0,r.default)({method:"onPageup"});e.h5Frame.postMessage(t,"*"),e.changCurrPageUp()}},{key:"handlerH5FilePageDownClick",value:function(){var e=this,t=(0,r.default)({method:"onPagedown"});e.h5Frame.postMessage(t,"*"),e.changCurrPageDown()}},{key:"changCurrPageUp",value:function(){var e=this,t=function(t){var a=t.currpage;t.pagenum,a--,a<=1&&(a=1),t.currpage=a,e.slideChangeToLc(t),e.h5DocumentData.filedata=t,k.default.CoreController.dispatchEvent({type:"documentPageChange",message:e.h5DocumentData}),e.h5DocumentData.action="onJumpPage",e.sendSignallingToH5File(e.h5DocumentData),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:t}})};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:t}})}},{key:"changCurrPageDown",value:function(){var e=this,t=function(t){var a=t.currpage,n=t.pagenum;a++,a>=n&&(a=n),t.currpage=a,e.slideChangeToLc(t),e.h5DocumentData.filedata=t,k.default.CoreController.dispatchEvent({type:"documentPageChange",message:e.h5DocumentData}),e.h5DocumentData.action="onJumpPage",e.sendSignallingToH5File(e.h5DocumentData),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:t}})};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:t}})}},{key:"sendSignallingToH5File",value:function(e){P.default.sendSignallingFromShowPage(!1,"DocumentFilePage_ShowPage",e)}},{key:"_skipH5documentPaging",value:function(e){var t=this,a=null,n=e;a=(0,r.default)({method:"onJumpPage",toPage:n}),this.h5Frame.postMessage(a,"*");var i=function(a){t.h5DocumentData.filedata=a,t.h5DocumentData.filedata.currpage=e,t.slideChangeToLc(t.h5DocumentData.filedata),k.default.CoreController.dispatchEvent({type:"documentPageChange",message:t.h5DocumentData}),t.sendSignallingToH5File(t.h5DocumentData)};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:i}})}},{key:"_updateLcScaleWhenAynicPPTInitHandler",value:function(e){k.default.CoreController.dispatchEvent({type:"updateLcScaleWhenAynicPPTInitHandler",message:{lcLitellyScalc:e}})}},{key:"_sendDocumentPageChangeAndSaveWhiteboard",value:function(e,t){var a=this;if(a.setState({h5DocumentActionClick:D.default.handler.getAppPermissions("h5DocumentActionClick")}),"h5document"===a.props.fileTypeMark){var n=function(a){e&&(a.pagenum=e),t&&(a.currpage=t);var n={isMedia:!1,isDynamicPPT:!1,isGeneralFile:!1,isH5Document:!0,action:"show",mediaType:"",filedata:a};k.default.CoreController.dispatchEvent({type:"documentPageChange",message:n}),k.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:a}}),k.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"h5document",data:a}})};k.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:n}})}}},{key:"render",value:function(){var e=this.props.fileTypeMark,t=this.state.h5DocumentActionClick,a=Object.customAssign({display:"h5document"==e?"block":"none"},this.props.styleJson);return v.default.createElement("div",{id:"h5FileWrap",style:a,className:"h5-file-wrap add-position-absolute-top0-left0"},v.default.createElement("iframe",{allow:"autoplay",allowFullScreen:!0,id:"h5DocumentFrame",scrolling:"no",src:this.h5FileSrc?E.default.nowUseDocAddress+this.h5FileSrc+"?author=talkcloud"+(this.forceReloadNumber?"&forceReloadNumber="+this.forceReloadNumber:"")+(this.changeDocLineReloadNumber?"&changeDocLineReloadNumber="+this.changeDocLineReloadNumber:""):"",name:"h5FileFrame"}),v.default.createElement("div",{className:"student-disabled add-position-absolute-top0-left0",style:{display:t?"none":"block"}}),v.default.createElement("div",{id:"h5Document-layer",className:"student-disabled add-position-absolute-top0-left0",style:{display:t?"none":"block"}}),v.default.createElement("div",{id:"h5DocumentLoading",className:"h5-document-container",style:{display:this.state.h5Loading?"block":"none"}},v.default.createElement("span",{className:"tk-loading-reload-number",style:{display:E.default.reloadFileShowReloadNumber&&this.forceReloadNumber?"block":"none"}},E.default.language.languageData.reloadDoucumentHint.one+this.forceReloadNumber+E.default.language.languageData.reloadDoucumentHint.two)))}}]),t}(v.default.Component);t.default=B},GrKX:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("W3Iv"),r=n(i),s=a("BO1k"),o=n(s),l=a("d7EF"),d=n(l),u=a("mvHQ"),c=n(u),h=a("Zrlr"),m=n(h),g=a("wxAW"),f=n(g),p=a("T+56"),v=n(p),b=a("VSuD"),y=n(b),S=a("DrPG"),k=n(S),w=a("Wi6Q"),C=n(w),T=a("HUPQ"),P=n(T),A=a("yE5a"),D=n(A),_=a("YRCL"),E=n(_),I=a("0jvK"),x=n(I),B=a("uObV"),R=n(B),N=function(){function e(t){(0,m.default)(this,e),this.room=t}return(0,f.default)(e,[{key:"registerEventToRoom",value:function(){for(var e in y.default.EVENTTYPE.RoomEvent)!function(e){D.default.getTkRoom().addEventListener(y.default.EVENTTYPE.RoomEvent[e],function(t){var a=!0;"stream-rtcStats"===t.type&&(a=!1),a&&L.Logger.debug(y.default.EVENTTYPE.RoomEvent[e]+" event:",t),v.default.Room.dispatchEvent(t,!1)})}(e)}},{key:"addEventListenerToRoomHandler",value:function(){var e=this;for(var t in y.default.EVENTTYPE.RoomEvent)!function(t){v.default.Room.addEventListener(y.default.EVENTTYPE.RoomEvent[t],function(a){if(!e["handler"+k.default.replaceFirstUper(t)]||"function"!=typeof e["handler"+k.default.replaceFirstUper(t)]||!e["handler"+k.default.replaceFirstUper(t)](a)){var n=!0;"stream-rtcStats"===a.type&&(n=!1),v.default.CoreController.dispatchEvent(a,n)}})}(t)}},{key:"handlerRoomPubmsg",value:function(e){var t=this;e.message&&"string"==typeof e.message&&(e.message=JSON.parse(e.message)),e.message.data&&"string"==typeof e.message.data&&(e.message.data=JSON.parse(e.message.data));var a=e.message;if(P.default.signallingMessageList&&P.default.signallingMessageList.length>0&&"UpdateTime"!==a.name&&"LowConsume"!==a.name&&"StreamFailure"!==a.name)return P.default.signallingMessageList.push(a),!0;switch(P.default.serviceTime||(P.default.serviceTime=1e3*a.ts,P.default.remindServiceTime=1e3*a.ts),a.name){case"ClassBegin":P.default.serviceTime=k.default.isMillisecondClass(a.ts)?a.ts:1e3*a.ts,P.default.remindServiceTime=k.default.isMillisecondClass(a.ts)?a.ts:1e3*a.ts,t._classBeginStartHandler(a);break;case"UpdateTime":P.default.serviceTime=1e3*a.ts,P.default.remindServiceTime=1e3*a.ts,P.default.firstGetServiceTime||P.default.isHandleMsglistFromRoomPubmsg||!P.default.signallingMessageList||(P.default.firstGetServiceTime=!0,P.default.classBegin||v.default.Room.dispatchEvent({type:y.default.EVENTTYPE.RoomEvent.roomMsglistFromConnected,message:P.default.signallingMessageList,source:"roomConnected"}),v.default.Room.dispatchEvent({type:y.default.EVENTTYPE.RoomEvent.roomMsglistFromConnected,message:P.default.signallingMessageList,source:"roomPubmsg"}),P.default.signallingMessageList=null,delete P.default.signallingMessageList);break;case"SharpsChange":P.default.showShapeAuthor&&D.default.getTkRoom().getUser(a.fromID)&&(a.remindContent=D.default.getTkRoom().getUser(a.fromID).nickname),R.default.handlerPubmsg_SharpsChange(a);break;case"StreamFailure":L.Logger.info("StreamFailure signalling:"+(0,c.default)(a));break;case"RemoteControl":switch(a.data.action){case"getDocServer":E.default.sendSignallingFromRemoteControl(a.fromID,{action:"pushDocServer",serverInfo:{serverList:P.default.docAddressList,serverIndex:P.default.docAddressIndex}});break;case"changeLine":var n=Number(a.data.lineIndex);P.default.docAddressIndex!==n&&(P.default.docAddressIndex=n%P.default.docAddressList.length,P.default.nowUseDocAddress=P.default.docAddressList[P.default.docAddressIndex]||y.default.SERVICEINFO.docAddress,"mobile"===TK.SDKTYPE?D.default.getTkRoom()&&"function"==typeof D.default.getTkRoom().setLocalStorageItem&&D.default.getTkRoom().setLocalStorageItem("tkDocAddressIndex",P.default.docAddressIndex):L.Utils.localStorage.setItem("tkDocAddressIndex",P.default.docAddressIndex),v.default.CoreController.dispatchEvent({type:"changeLine"}))}}return"sendNetworkState"===a.name||"BlackBoardDrag"===a.name||"videoDraghandle"===a.name||void 0}},{key:"handlerRoomDelmsg",value:function(e){var t=this;e.message&&"string"==typeof e.message&&(e.message=JSON.parse(e.message)),e.message.data&&"string"==typeof e.message.data&&(e.message.data=JSON.parse(e.message.data));var a=e.message;if(P.default.signallingMessageList&&P.default.signallingMessageList.length>0){for(var n=P.default.signallingMessageList.length-1;n>=0;n--)P.default.signallingMessageList[n].id!==a.id&&P.default.signallingMessageList[n].associatedMsgID!==a.id||P.default.signallingMessageList.splice(n,1);return!0}switch(a.name){case"ClassBegin":t._classBeginEndHandler(a);break;case"SharpsChange":R.default.handlerDelmsg_SharpsChange(a)}}},{key:"handlerRoomConnected",value:function(e){this._compareDocServerSpeedSwitchCND(),this._bindInfoToTkConstant(),P.default.showShapeAuthor=y.default.joinRoomInfo.brushName&&!P.default.playback,P.default.firstGetServiceTime=!1,P.default.isHandleMsglistFromRoomPubmsg=!1,P.default.appConnected=!0;var t=C.default.getRoleHasDefalutAppPermissions();x.default.initAppPermissions(t);var a=e.message;P.default.signallingMessageList=a,v.default.Room.dispatchEvent({type:y.default.EVENTTYPE.RoomEvent.roomMsglistFromConnected,message:P.default.signallingMessageList,source:"roomConnected"}),P.default.serviceTime&&!P.default.firstGetServiceTime&&!P.default.isHandleMsglistFromRoomPubmsg&&P.default.signallingMessageList&&(P.default.firstGetServiceTime=!0,v.default.Room.dispatchEvent({type:y.default.EVENTTYPE.RoomEvent.roomMsglistFromConnected,message:P.default.signallingMessageList,source:"roomPubmsg"}),P.default.signallingMessageList=null,delete P.default.signallingMessageList),E.default.setParticipantPropertyToAll(D.default.getTkRoom().getMySelf().id,{codeVersion:1}),$(window).resize()}},{key:"handlerRoomDisconnected",value:function(e){P.default.appConnected=!1,P.default.classBegin=!1,P.default.serviceTime=void 0,P.default.remindServiceTime=void 0,P.default.signallingMessageList=null,delete P.default.signallingMessageList,P.default.isHandleMsglistFromRoomPubmsg=!1,P.default.participantGiftNumberJson={}}},{key:"handlerRoomUserpropertyChanged",value:function(e){var t=e.message,a=e.user,n=!0,i=!1,s=void 0;try{for(var l,u=(0,o.default)((0,r.default)(t));!(n=(l=u.next()).done);n=!0){var c=l.value,h=(0,d.default)(c,2),m=h[0],g=h[1];a.id===D.default.getTkRoom().getMySelf().id&&"candraw"===m&&(x.default.setAppPermissions("sendSignallingFromShowPage",g),x.default.setAppPermissions("sendSignallingFromH5ShowPage",g),x.default.setAppPermissions("sendSignallingFromDynamicPptShowPage",g),x.default.setAppPermissions("sendSignallingFromGeneralShowPage",g),x.default.setAppPermissions("sendSignallingFromDynamicPptTriggerActionClick",g),x.default.setAppPermissions("sendSignallingFromH5DocumentAction",g),x.default.setAppPermissions("sendWhiteboardMarkTool",g),x.default.setAppPermissions("h5DocumentActionClick",g),x.default.setAppPermissions("dynamicPptActionClick",g),x.default.setAppPermissions("publishDynamicPptMediaPermission_video",g),x.default.setAppPermissions("canDraw",g),x.default.setAppPermissions("canDragCaptureImg",g),x.default.setAppPermissions("canResizeCaptureImg",g),y.default.hasRole.roleStudent&&(x.default.setAppPermissions("whiteboardPagingPage",g||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("newpptPagingPage",g||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("h5DocumentPagingPage",g||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("jumpPage",g||y.default.joinRoomInfo.isSupportPageTrun)))}}catch(e){i=!0,s=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw s}}}},{key:"handlerRoomMsglistFromConnected",value:function(e){var t=this,a=e.message,n=e.source,i={};return function(e,a,n){var i={};for(var r in e)n&&n[e[r].name]||(e[r].data&&"string"==typeof e[r].data&&(e[r].data=JSON.parse(e[r].data)),/outIframe/.test(e[r].name)?v.default.CoreController.dispatchEvent({type:"outIframe-msglist",message:{signallingData:e[r]}}):null==i[e[r].name]||void 0==i[e[r].name]?(i[e[r].name]=[],i[e[r].name].push(e[r])):i[e[r].name].push(e[r]));if("roomConnected"===a){var s=i.ClassBegin;null!=s&&void 0!=s&&s.length>0?"ClassBegin"==s[s.length-1].name&&(t._classBeginStartHandler(s[s.length-1]),v.default.CoreController.dispatchEvent({type:"receive-msglist-ClassBegin",source:"room-msglist",message:s[s.length-1]})):v.default.CoreController.dispatchEvent({type:"receive-msglist-not-ClassBegin",source:"room-msglist",message:{}}),i.ClassBegin=null}else if("roomPubmsg"===a||"roomMsglist"===a){var o=i.whiteboardMarkTool;null!=o&&void 0!=o&&o.length>0&&"whiteboardMarkTool"==o[o.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-whiteboardMarkTool",source:"room-msglist",message:o[o.length-1]}),i.whiteboardMarkTool=null;var l=i.SharpsChange;null!=l&&void 0!=l&&l.length>0&&R.default.handlerMsglist_SharpsChange(l),i.SharpsChange=null;var d=i.CaptureImg;null!==d&&void 0!==d&&d.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-CaptureImg",message:{CaptureImgArray:d}}),i.CaptureImg=null;var u=i.CaptureImgDrag;null!==u&&void 0!==u&&u.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-CaptureImgDrag",message:{CaptureImgDragArray:u}}),i.CaptureImgDrag=null;var c=i.CaptureImgResize;null!==c&&void 0!==c&&c.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-CaptureImgResize",message:{CaptureImgResizeArray:c}}),i.CaptureImgResize=null;var h=i.WBPageCount;null!=h&&void 0!=h&&h.length>0&&"WBPageCount"==h[h.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-WBPageCount",source:"room-msglist",message:h[h.length-1]}),i.WBPageCount=null;var m=i.timer;null!=m&&void 0!=m&&m.length>0&&"timer"==m[m.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-timer",source:"room-msglist",message:{timerShowArr:m}}),i.timer=null;var g=i.TimerDrag;null!==g&&void 0!==g&&g.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-TimerDrag",message:{TimerDragArray:g}}),i.TimerDrag=null;var f=i.dial;null!=f&&void 0!=f&&f.length>0&&"dial"==f[f.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-dial",source:"room-msglist",message:{dialShowArr:f}}),i.dial=null;var p=i.DialDrag;null!==p&&void 0!==p&&p.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-DialDrag",message:{DialDragArray:p}}),i.DialDrag=null;var b=i.answer;null!=b&&void 0!=b&&b.length>0&&"answer"==b[b.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-answer",source:"room-msglist",message:{answerShowArr:b}}),i.answer=null;var y=i.submitAnswers;null!=y&&void 0!=y&&y.length>0&&"submitAnswers"==y[y.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-submitAnswers",source:"room-msglist",message:{submitAnswersArr:y}}),i.submitAnswers=null;var S=i.AnswerDrag;null!==S&&void 0!==S&&S.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-AnswerDrag",message:{AnswerDragArray:S}}),i.AnswerDrag=null;var k=i.qiangDaQi;null!=k&&void 0!=k&&k.length>0&&"qiangDaQi"==k[k.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-qiangDaQi",source:"room-msglist",message:{qiangDaQiArr:k}}),i.qiangDaQi=null;var w=i.QiangDaZhe;null!=w&&void 0!=w&&w.length>0&&"QiangDaZhe"==w[w.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-QiangDaZhe",source:"room-msglist",message:{QiangDaZheArr:w}}),i.QiangDaZhe=null;var C=i.ResponderDrag;null!==C&&void 0!==C&&C.length>0&&v.default.CoreController.dispatchEvent({type:"receive-msglist-ResponderDrag",message:{ResponderDragArray:C}}),i.ResponderDrag=null;var T=i.BlackBoard;null!=T&&void 0!=T&&T.length>0&&"BlackBoard"==T[T.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-BlackBoard",source:"room-msglist",message:T[T.length-1]}),i.BlackBoard=null;var A=i.PptVolumeControl;null!=A&&void 0!=A&&A.length>0&&"PptVolumeControl"==A[A.length-1].name&&v.default.CoreController.dispatchEvent({type:"receive-msglist-PptVolumeControl",source:"room-msglist",message:{PptVolumeControlArr:A}}),i.PptVolumeControl=null;var D=null,_=i.ShowPage;if(null!=_&&void 0!=_&&_.length>0)for(var E=0;E<_.length;E++)_[E].data.isMedia||(D=_[E]);i.ShowPage=null,void 0!=D&&null!=D?(L.Logger.debug("receive-msglist-ShowPage-lastDocument info:",D),v.default.CoreController.dispatchEvent({type:"receive-msglist-ShowPage-lastDocument",message:{data:D.data,source:"room-msglist"}})):v.default.CoreController.dispatchEvent({type:"receive-msglist-not-ShowPage-lastDocument",source:"room-msglist",message:{}}),P.default.isHandleMsglistFromRoomPubmsg=!0}}(a,n,i),!0}},{key:"handlerRoomPlaybackClearAll",value:function(e){return v.default.CoreController.dispatchEvent({type:y.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController}),!0}},{key:"handlerRoomTransmitWindowSize",value:function(){document.getElementById("tk_app")?(P.default.windowInnerWidth=document.getElementById("tk_app").clientWidth,P.default.windowInnerHeight=document.getElementById("tk_app").clientHeight):(P.default.windowInnerWidth=window.innerWidth,P.default.windowInnerHeight=window.innerHeight);var e=P.default.windowInnerWidth/y.default.STANDARDSIZE,t=document.getElementById("all_root")||document.getElementsByTagName("html");if(t){var a=k.default.isArray(t)?t[0]:t;a&&a.style&&(a.style.fontSize=e+"px")}return v.default.Window.dispatchEvent({type:y.default.EVENTTYPE.WindowEvent.onResize,message:{defalutFontSize:e}}),!0}},{key:"handlerRoomMsglist",value:function(e){e.source="roomMsglist",this.handlerRoomMsglistFromConnected(e)}},{key:"_classBeginStartHandler",value:function(e){P.default.classBeginTime=k.default.isMillisecondClass(e.ts)?e.ts:1e3*e.ts,P.default.classBegin=!0;var t=C.default.getRoleHasDefalutAppPermissions();x.default.initAppPermissions(t);var a=D.default.getTkRoom().getMySelf().candraw;x.default.setAppPermissions("sendSignallingFromShowPage",a),x.default.setAppPermissions("sendSignallingFromH5ShowPage",a),x.default.setAppPermissions("sendSignallingFromDynamicPptShowPage",a),x.default.setAppPermissions("sendSignallingFromGeneralShowPage",a),x.default.setAppPermissions("sendSignallingFromDynamicPptTriggerActionClick",a),x.default.setAppPermissions("sendSignallingFromH5DocumentAction",a),x.default.setAppPermissions("sendWhiteboardMarkTool",a),x.default.setAppPermissions("h5DocumentActionClick",a),x.default.setAppPermissions("dynamicPptActionClick",a),x.default.setAppPermissions("publishDynamicPptMediaPermission_video",a),x.default.setAppPermissions("canDraw",a),y.default.hasRole.roleStudent&&(x.default.setAppPermissions("whiteboardPagingPage",a||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("newpptPagingPage",a||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("h5DocumentPagingPage",a||y.default.joinRoomInfo.isSupportPageTrun),x.default.setAppPermissions("jumpPage",a||y.default.joinRoomInfo.isSupportPageTrun))}},{key:"_classBeginEndHandler",value:function(e){P.default.classBegin=!1,P.default.endClassBegin=!0;var t=C.default.getRoleHasDefalutAppPermissions();x.default.initAppPermissions(t)}},{key:"_bindInfoToTkConstant",value:function(){var e=k.default.decrypt(y.default.SERVICEINFO.joinUrl)||window.location.href,t=D.default.getTkRoom().getRoomProperties().chairmancontrol,a={starttime:D.default.getTkRoom().getRoomProperties().starttime,endtime:D.default.getTkRoom().getRoomProperties().endtime,nickname:D.default.getTkRoom().getMySelf().nickname,thirdid:D.default.getTkRoom().getMySelf().id,joinUrl:k.default.encrypt(e),serial:D.default.getTkRoom().getRoomProperties().serial,roomrole:Number(D.default.getTkRoom().getMySelf().role),roomtype:Number(D.default.getTkRoom().getRoomProperties().roomtype),companyid:Number(D.default.getTkRoom().getRoomProperties().companyid),isSupportPageTrun:!(P.default.playback||!t)&&1===Number(t.substr(38,1)),isShowTheAnswer:!(P.default.playback||!t)&&1===Number(t.substr(42,1)),hasCoursewareRemarks:!(P.default.playback||!t)&&1===Number(t.substr(43,1)),isClassOverNotLeave:!(P.default.playback||!t)&&1===Number(t.substr(47,1)),brushName:!(P.default.playback||!t)&&1===Number(t.substr(58,1)),shapeUndoRedoClear:!(P.default.playback||!t)&&1===Number(t.substr(68,1)),customWhiteboardBackground:!1,toolBox:{answer:!(P.default.playback||!t)&&1===Number(t.substr(61,1)),turnplate:!(P.default.playback||!t)&&1===Number(t.substr(62,1)),timer:!(P.default.playback||!t)&&1===Number(t.substr(63,1)),responder:!(P.default.playback||!t)&&1===Number(t.substr(64,1)),moreBlackboard:!(P.default.playback||!t)&&1===Number(t.substr(65,1))},roomname:D.default.getTkRoom().getRoomProperties().roomname};y.default.bindRoomInfoToTkConstant(a),y.default.bindParticipantHasRoleToTkConstant(),y.default.bindParticipantHasRoomtypeToTkConstant()}},{key:"_compareDocServerSpeedSwitchCND",value:function(){var e=function(e,t){if("function"==typeof t)if("mobile"===TK.SDKTYPE){if(D.default.getTkRoom()&&"function"==typeof D.default.getTkRoom().getLocalStorageItem)try{D.default.getTkRoom().getLocalStorageItem(e,function(e){t(e)})}catch(e){L.Logger.error("getLocalStorageItem error:",e),t("")}}else t(L.Utils.localStorage.getItem("tkDocAddressIndex"))};e("tkDocAddressIndex",function(t){if(!t){var a=void 0,n=void 0,i=void 0,r=void 0,s=function(e,t){var a={},n=(new Date).getTime(),i=e+"/speed.bmp?ts="+n,r=new Image;r.onload=function(){var e=(new Date).getTime();a={code:0,loadingTime:e-n},"function"==typeof t&&t(a)},r.onerror=function(){a={code:-1,loadingTime:void 0},"function"==typeof t&&t(a)},r.src=i},o=function(t){e("tkDocAddressIndex",function(e){e||P.default.docAddressIndex!==t&&(P.default.docAddressIndex=t%P.default.docAddressList.length,P.default.nowUseDocAddress=P.default.docAddressList[P.default.docAddressIndex]||y.default.SERVICEINFO.docAddress,v.default.CoreController.dispatchEvent({type:"changeLine"}),L.Logger.info("auto switch cdn , cdn index is "+P.default.docAddressIndex+" , address is "+P.default.nowUseDocAddress))})};s(y.default.SERVICEINFO.backupDocAddress,function(e){L.Logger.info("load backup document cdn  speed.bmp , response is "+L.Utils.toJsonStringify(e)),0===e.code&&e.loadingTime&&(n=e.loadingTime,clearTimeout(i),a?o(a<n+200?0:1):r=setTimeout(function(){a||o(1)},100))}),s(y.default.SERVICEINFO.docAddress,function(e){L.Logger.info("load document cdn  speed.bmp , response is "+L.Utils.toJsonStringify(e)),0===e.code&&e.loadingTime&&(a=e.loadingTime,clearTimeout(r),n?o(a<n+200?0:1):i=setTimeout(function(){n||o(0)},100))})}})}}]),e}(),W=new N;W.addEventListenerToRoomHandler(),t.default=W},HSQo:function(e,t,a){e.exports={default:a("CJli"),__esModule:!0}},HUPQ:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),r=n(i),s=a("DrPG"),o=n(s);window.GLOBAL=window.GLOBAL||{};var l=window.GLOBAL;l.classBegin=!1,l.endClassBegin=!1,l.routeName=void 0,l.playback=!1,l.playPptVideoing=!1,l.playMediaFileing=!1,l.serviceTime=void 0,l.firstGetServiceTime=!1,l.isHandleMsglist=!1,l.remindServiceTime=void 0,l.classBeginTime=void 0,l.isSkipPageing=!1,l.isClient=!1,l.isBroadcast=!1,l.mobileDeviceType=void 0,l.windowInnerWidth=window.innerWidth,l.windowInnerHeight=window.innerHeight;var d=o.default.getBrowserInfo();L.Logger.info("浏览器 browserInfo:"+(0,r.default)(d)),l.isMobile=d.versions.mobile||d.versions.ios||d.versions.android||d.versions.iPhone||d.versions.iPad,l.isBroadcastClient=l.isClient&&l.isBroadcast,l.isBroadcastMobile=l.isMobile&&l.isBroadcast,l.languageName="ch"===o.default.getUrlParams("languageType")?"chinese":"tw"===o.default.getUrlParams("languageType")?"complex":"english",l.defaultFileInfo={fileid:0,currpage:1,pagenum:1,filetype:"whiteboard",filename:"whiteboard",swfpath:"",pptslide:1,pptstep:0,steptotal:0},l.showShapeAuthor=!1,l.customWhiteboardColorArry=["ffffff","000000","415646","ffc973","d3465c","9ad0ea","756691","558289"],l.reloadFileShowReloadNumber=!0,l.whiteboardColorNumber=1,l.docAddressList=[],l.docAddressIndex=0,l.nowUseDocAddress=/https/.test(window.location.protocol)?"https://global.talk-cloud.net":"http://global.talk-cloud.net",t.default=l},HpRW:function(e,t,a){"use strict";var n=a("kM2E"),i=a("lOnJ"),r=a("+ZMJ"),s=a("NWt+");e.exports=function(e){n(n.S,e,{from:function(e){var t,a,n,o,l=arguments[1];return i(this),t=void 0!==l,t&&i(l),void 0==e?new this:(a=[],t?(n=0,o=r(l,arguments[2],2),s(e,!1,function(e){a.push(o(e,n++))})):s(e,!1,a.push,a),new this(a))}})}},K9xZ:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),r=n(i),s=a("BO1k"),o=n(s),l=a("Zx67"),d=n(l),u=a("Zrlr"),c=n(u),h=a("wxAW"),m=n(h),g=a("zwoO"),f=n(g),p=a("Pf15"),v=n(p),b=a("GiK3"),y=n(b),S=a("HUPQ"),k=n(S),w=a("VSuD"),C=n(w),T=a("T+56"),P=n(T),A=a("Sa83"),D=n(A),_=a("YRCL"),E=n(_),I=function(e){function t(e){(0,c.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.state={fileTypeMark:"general",selectColor:"000000",show:!1,showItemJson:{mouse:!0,laser:!1,brush:!0,text:!0,shape:!0,undo:!1,redo:!1,eraser:!0,clear:!1,colorAndSize:!0,colors:!0,measure:!0},registerWhiteboardToolsList:{action_clear:{toolKey:"action_clear",disabled:!1},action_redo:{toolKey:"action_redo",disabled:!1},action_undo:{toolKey:"action_undo",disabled:!1},tool_eraser:{toolKey:"tool_eraser",disabled:!1}},currentUseTool:"tool_mouse",currentExtendToolContainer:void 0,currentExtendToolExtraContainer:void 0,showCurrentExtendToolContainer:!1,useBrush:"tool_pencil",useText:"tool_text_msyh",useShape:"tool_rectangle_empty",useStrokeSize:"tool_color_measure_small",useStrokeColor:"simple_color_000000"},a.selectMouse=void 0,a.colors={smipleList:["#000000","#2d2d2d","#5b5b5b","#8e8e8e","#c5c5c5","#ffffff","#ff0001","#06ff02","#0009ff","#ffff03","#00ffff","#ff03ff"],moreList:[["#000000","#002d00","#015b00","#028e01","#03c501","#06ff02","#2d0000","#2d2d00","#2d5b00","#2d8e01","#2dc501","#2eff02","#5b0000","#5b2d00","#5b5b00","#5b8e01","#5bc501","#5cff02"],["#00002d","#002d2d","#015b2d","#028e2d","#03c52d","#05ff2d","#2d002d","#2d2d2d","#2d5b2d","#2d8e2d","#2dc52d","#2eff2d","#5b002d","#5b2d2d","#5b5b2d","#5b8e2d","#5bc52d","#5cff2d"],["#00015b","#002d5b","#005b5b","#018e5b","#02c55b","#05ff5b","#2d015b","#2d2d5b","#2d5b5b","#2d8e5b","#2dc55b","#2eff5b","#5b005b","#5b2d5b","#5b5b5b","#5b8e5b","#5bc55b","#5cff5b"],["#00038e","#002d8e","#005b8e","#008e8e","#01c58e","#03ff8e","#2c038e","#2d2d8e","#2d5b8e","#2d8e8e","#2dc58e","#2dff8e","#5b028e","#5b2d8e","#5b5b8e","#5b8e8e","#5bc58e","#5bff8e"],["#0005c5","#002ec5","#005bc5","#008ec5","#00c5c5","#01ffc5","#2c05c5","#2c2ec5","#2c5bc5","#2c8ec5","#2dc5c5","#2dffc5","#5b04c5","#5b2ec5","#5b5bc5","#5b8ec5","#5bc5c5","#5bffc5"],["#0009ff","#002eff","#005cff","#008fff","#00c5ff","#00ffff","#2c08ff","#2c2eff","#2c5cff","#2c8fff","#2cc5ff","#2dffff","#5b08ff","#5b2eff","#5b5cff","#5b8fff","#5bc5ff","#5bffff"],["#8e0000","#8e2d00","#8e5b01","#8e8e01","#8fc502","#8fff03","#c50001","#c52c01","#c55b01","#c58e01","#c5c502","#c5ff03","#ff0001","#ff2c01","#ff5b01","#ff8e02","#ffc502","#ffff03"],["#8e002d","#8e2d2d","#8e5b2d","#8e8e2d","#8fc52d","#8fff2d","#c5002d","#c52c2d","#c55b2d","#c58e2d","#c5c52d","#c5ff2d","#ff002d","#ff2c2d","#ff5b2d","#ff8e2d","#ffc52d","#ffff2d"],["#8e005b","#8e2d5b","#8e5b5b","#8e8e5b","#8fc55b","#8fff5b","#c5005b","#c52c5b","#c55b5b","#c58e5b","#c5c55b","#c5ff5b","#ff005b","#ff2c5b","#ff5b5b","#ff8e5b","#ffc55b","#ffff5b"],["#8e018e","#8e2d8e","#8e5b8e","#8e8e8e","#8ec58e","#8fff8e","#c5008e","#c52d8e","#c55b8e","#c58e8e","#c5c58e","#c5ff8e","#ff008e","#ff2c8e","#ff5b8e","#ff8e8e","#ffc58e","#ffff8e"],["#8e03c5","#8e2dc5","#8e5bc5","#8e8ec5","#8ec5c5","#8effc5","#c502c5","#c52dc5","#c55bc5","#c58ec5","#c5c5c5","#c5ffc5","#ff00c5","#ff2dc5","#ff5bc5","#ff8ec5","#ffc5c5","#ffffc5"],["#8e07ff","#8e2eff","#8e5cff","#8e8fff","#8ec5ff","#8effff","#c505ff","#c52eff","#c55bff","#c58eff","#c5c5ff","#c5ffff","#ff03ff","#ff2dff","#ff5bff","#ff8eff","#ffc5ff","#ffffff"]]},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,v.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){var e=this;P.default.CoreController.addEventListener("changeFileTypeMark",e.handlerChangeFileTypeMark.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomConnected,e.handlerRoomConnected.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("callAllWrapOnClick",e.handlerCallAllWrapOnClick.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("updateAppPermissions_canDraw",e.handlerUpdateAppPermissions_canDraw.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("resetDefaultAppPermissions",e.handlerResetDefaultAppPermissions.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-whiteboardMarkTool",e.handlerReceive_msglist_whiteboardMarkTool.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("commonWhiteboardTool_noticeUpdateToolDesc",e.handlerCommonWhiteboardTool_noticeUpdateToolDesc.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("teacherToolBox",e.handlerTeacherToolBox.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;P.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){t.show!==this.state.show&&!0===this.state.show&&this.props.setDefaultPosition&&"function"==typeof this.props.setDefaultPosition&&this.props.setDefaultPosition()}},{key:"handlerCallAllWrapOnClick",value:function(e){if("mobile"===TK.SDKTYPE){var t=e.message.event,a=this.props.parentId||"header_tool_vessel";t.target.id===a||$(t.target)&&$(t.target).parents("#"+a).length>0||(this.state.showCurrentExtendToolContainer&&this.setState({showCurrentExtendToolContainer:!1}),this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0}))}}},{key:"handlerRoomDelmsg",value:function(e){switch(e.message.name){case"ClassBegin":C.default.joinRoomInfo.isClassOverNotLeave||(this.selectMouse=void 0,this._initWhiteboardToolDefaultStyle())}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"whiteboardMarkTool":var n=a.data.selectMouse;t.selectMouse!==n&&(n?t.selectCurrentUseTool({toolId:"tool_mouse",isRemote:!0}):t.selectExtendTool({extendToolId:"whiteboard_tool_vessel_brush",isRemote:!0}))}}},{key:"handlerReceive_msglist_whiteboardMarkTool",value:function(e){var t=this,a=e.message,n=a.data.selectMouse;t.selectMouse!==n&&(n?t.selectCurrentUseTool({toolId:"tool_mouse",isRemote:!0}):t.selectExtendTool({extendToolId:"whiteboard_tool_vessel_brush",isRemote:!0}))}},{key:"handlerChangeFileTypeMark",value:function(e){this.setState({fileTypeMark:e.message.fileTypeMark})}},{key:"handlerRoomConnected",value:function(e){if(C.default.hasRole.roleChairman){var t=!0,a=!1,n=void 0;try{for(var i,s=(0,o.default)((0,r.default)(this.state.showItemJson));!(t=(i=s.next()).done);t=!0){var l=i.value;this.state.showItemJson[l]=!0}}catch(e){a=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw n}}"mobile"===TK.SDKTYPE?(this.state.showItemJson.laser=!1,this.state.showItemJson.undo=!1,this.state.showItemJson.redo=!1,this.state.showItemJson.clear=!1,this.state.showItemJson.colorAndSize=!1,this.state.showItemJson.colors=!0,this.state.showItemJson.measure=!0):(this.state.showItemJson.colors=!1,this.state.showItemJson.measure=!1),this.setState({showItemJson:this.state.showItemJson})}else"mobile"===TK.SDKTYPE?(this.state.showItemJson.laser=!1,this.state.showItemJson.undo=!1,this.state.showItemJson.redo=!1,this.state.showItemJson.clear=!1,this.state.showItemJson.colorAndSize=!1,this.state.showItemJson.colors=!0,this.state.showItemJson.measure=!0,this.setState({showItemJson:this.state.showItemJson})):((C.default.hasRole.roleStudent||C.default.hasRole.roleTeachingAssistant)&&(this.state.showItemJson.undo=C.default.joinRoomInfo.shapeUndoRedoClear||!1,this.state.showItemJson.redo=C.default.joinRoomInfo.shapeUndoRedoClear||!1,this.state.showItemJson.clear=C.default.joinRoomInfo.shapeUndoRedoClear||!1),this.state.showItemJson.colors=!1,this.state.showItemJson.measure=!1);this._initWhiteboardToolDefaultStyle()}},{key:"handlerUpdateAppPermissions_canDraw",value:function(e){this._changeCanDrawPermissions()}},{key:"handlerInitAppPermissions",value:function(e){this._changeCanDrawPermissions()}},{key:"handlerResetDefaultAppPermissions",value:function(){this._changeCanDrawPermissions()}},{key:"handlerCommonWhiteboardTool_noticeUpdateToolDesc",value:function(e){var t=e.message.registerWhiteboardToolsList,a=!1,n=!0,i=!1,s=void 0;try{for(var l,d=(0,o.default)((0,r.default)(this.state.registerWhiteboardToolsList));!(n=(l=d.next()).done);n=!0){var u=l.value;t[u]&&(this.state.registerWhiteboardToolsList[u]=t[u],a=!0)}}catch(e){i=!0,s=e}finally{try{!n&&d.return&&d.return()}finally{if(i)throw s}}a&&this.setState({registerWhiteboardToolsList:this.state.registerWhiteboardToolsList})}},{key:"handlerTeacherToolBox",value:function(e){this.state.showCurrentExtendToolContainer&&this.setState({showCurrentExtendToolContainer:!1}),this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0})}},{key:"allLiMouseLeave",value:function(e){"mobile"!==TK.SDKTYPE&&(this.state.showCurrentExtendToolContainer&&this.setState({showCurrentExtendToolContainer:!1}),this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0}))}},{key:"changeStrokeSizeClick",value:function(e,t){var a={};"whiteboard_tool_vessel_brush"===this.state.currentExtendToolContainer?a.pencil=!0:"whiteboard_tool_vessel_text"===this.state.currentExtendToolContainer||"mobile"===TK.SDKTYPE&&"tool_text"===this.state.currentUseTool?a.text=!0:"whiteboard_tool_vessel_shape"===this.state.currentExtendToolContainer?a.shape=!0:"tool_eraser"===this.state.currentUseTool&&(a.eraser=!0),this.setState({useStrokeSize:e}),"mobile"===TK.SDKTYPE&&this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0}),P.default.CoreController.dispatchEvent({type:"changeStrokeSize",message:{strokeJson:t,selectedTool:a}})}},{key:"changeStrokeColorClick",value:function(e,t){P.default.CoreController.dispatchEvent({type:"changeStrokeColor",message:{selectColor:t}}),this.setState({selectColor:t,useStrokeColor:e}),"mobile"===TK.SDKTYPE&&this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0})}},{key:"selectCurrentUseTool",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.toolId,a=e.extendToolId,n=e.isRemote,i=void 0!==n&&n,r=e.initiative,s=void 0===r||r,o=arguments[1];if(this.setState({currentUseTool:t}),this.state.currentExtendToolContainer!==a&&this.setState({currentExtendToolContainer:a}),void 0!==this.state.currentExtendToolExtraContainer&&this.setState({currentExtendToolExtraContainer:void 0}),s&&(!a||"mobile"===TK.SDKTYPE&&this.state.showCurrentExtendToolContainer)&&this.setState({showCurrentExtendToolContainer:!1}),s&&!i&&P.default.CoreController.dispatchEvent({type:"whiteboardToolBox"}),a)switch(a){case"whiteboard_tool_vessel_brush":this.setState({useBrush:t});break;case"whiteboard_tool_vessel_text":var l="tool_text_msyh";switch(t){case"tool_text_msyh":l=k.default.language.languageData.header.tool.text.Msyh.text;break;case"tool_text_ming":l=k.default.language.languageData.header.tool.text.Ming.text;break;case"tool_text_arial":l=k.default.language.languageData.header.tool.text.Arial.text}P.default.CoreController.dispatchEvent({type:"whiteboard_updateWhiteboardToolsInfo",message:{whiteboardToolsInfo:{fontFamily:l}}}),P.default.CoreController.dispatchEvent({type:"whiteboard_updateTextFont"}),this.setState({useText:t});break;case"whiteboard_tool_vessel_shape":this.setState({useShape:t})}return this.selectMouse!==("tool_mouse"===t)&&(this.selectMouse="tool_mouse"===t,P.default.CoreController.dispatchEvent({type:"updateSelectMouse",message:{selectMouse:this.selectMouse}}),i||E.default.sendMarkToolMouseIsSelect(this.selectMouse)),"whiteboard_tool_vessel_text"===a?this._whiteboard_activeCommonWhiteboardToolClick("tool_text"):this._whiteboard_activeCommonWhiteboardToolClick(t),o&&o.preventDefault(),!1}},{key:"selectExtendExtraTool",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.extendToolId,a=e.isRemote,n=void 0!==a&&a,i=(e.toolId,arguments[1]);return t&&(n||(this.state.currentExtendToolExtraContainer!==t?this.setState({currentExtendToolExtraContainer:t}):this.setState({currentExtendToolExtraContainer:void 0})),this.setState({showCurrentExtendToolContainer:!1}),n||P.default.CoreController.dispatchEvent({type:"whiteboardToolBox"})),i&&i.preventDefault(),!1}},{key:"selectExtendTool",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.extendToolId,a=e.isRemote,n=void 0!==a&&a,i=(e.toolId,arguments[1]);if(t){switch(n?this.setState({showCurrentExtendToolContainer:!1,currentExtendToolExtraContainer:void 0}):(this.state.currentExtendToolContainer&&this.state.currentExtendToolContainer===t?this.setState({showCurrentExtendToolContainer:!this.state.showCurrentExtendToolContainer}):this.setState({showCurrentExtendToolContainer:!0}),this.setState({currentExtendToolExtraContainer:void 0})),t){case"whiteboard_tool_vessel_brush":this.selectCurrentUseTool({toolId:this.state.useBrush,extendToolId:t,isRemote:n,initiative:!1});break;case"whiteboard_tool_vessel_text":this.selectCurrentUseTool({toolId:this.state.useText,extendToolId:t,isRemote:n,initiative:!1});break;case"whiteboard_tool_vessel_shape":this.selectCurrentUseTool({toolId:this.state.useShape,extendToolId:t,isRemote:n,initiative:!1})}n||P.default.CoreController.dispatchEvent({type:"whiteboardToolBox"})}return i&&i.preventDefault(),!1}},{key:"useWhiteboardAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.actionId,a=(e.isRemote,arguments[1]);return t&&(this.setState({showCurrentExtendToolContainer:!1}),this.setState({currentExtendToolExtraContainer:void 0}),this._whiteboard_activeCommonWhiteboardToolClick(t)),a&&a.preventDefault(),!1}},{key:"_whiteboard_activeCommonWhiteboardToolClick",value:function(e){P.default.CoreController.dispatchEvent({type:"whiteboard_activeCommonWhiteboardTool",message:{toolKey:e}})}},{key:"_loadSmipleAndMoreListToArray",value:function(e,t){var a=this,n=[],i=[];return e.map(function(e,t){n.push(y.default.createElement("li",{key:t,className:" "+(a.state.useStrokeColor==="simple_color_"+a._colorFilter(e)?"active":""),onClick:a.changeStrokeColorClick.bind(a,"simple_color_"+a._colorFilter(e),a._colorFilter(e)),style:{backgroundColor:e},id:"simple_color_"+a._colorFilter(e)}))}),t.map(function(e,t){if(Array.isArray(e)){var n=[];e.map(function(e,t){n.push(y.default.createElement("li",{key:t,className:" "+(a.state.useStrokeColor==="more_color_"+a._colorFilter(e)?"active":""),onClick:a.changeStrokeColorClick.bind(a,"more_color_"+a._colorFilter(e),a._colorFilter(e)),style:{backgroundColor:e},id:"more_color_"+a._colorFilter(e)}))}),i.push(y.default.createElement("ul",{key:t,className:"clear-float"},n))}}),{smipleColorElementArray:n,moreColorElementArray:i}}},{key:"_colorFilter",value:function(e){return e.replace(/#/g,"")}},{key:"_changeCanDrawPermissions",value:function(){var e=D.default.handler.getAppPermissions("canDraw");this.setState({show:e})}},{key:"colorReverse",value:function(e){var t="0x"+e.replace(/#/g,""),a="000000"+(16777215-t).toString(16);return a.substring(a.length-6,a.length)}},{key:"_initWhiteboardToolDefaultStyle",value:function(){if(C.default.joinRoomInfo.customWhiteboardBackground&&void 0!==k.default.whiteboardColorNumber){var e=k.default.whiteboardColorNumber,t="#"+k.default.customWhiteboardColorArry[e],a=this.colorReverse(t);if(C.default.hasRole.roleChairman||C.default.hasRole.roleTeachingAssistant){a="ffffff"===k.default.customWhiteboardColorArry[e]?"ff0000":this.colorReverse(t);var n="simple_color_"+a;this.changeStrokeColorClick(n,a)}else{var i=void 0;i="000000"===k.default.customWhiteboardColorArry[e]?"bd8e35":"000000";var r="simple_color_"+i;this.changeStrokeColorClick(r,i)}}else C.default.hasRole.roleChairman||C.default.hasRole.roleTeachingAssistant?this.changeStrokeColorClick("simple_color_ff0001","ff0001"):this.changeStrokeColorClick("simple_color_000000","000000");void 0===this.selectMouse&&this.selectCurrentUseTool({toolId:"tool_mouse",isRemote:!0});var s=void 0;s="mobile"===TK.SDKTYPE?"phone"===k.default.mobileDeviceType?{pencil:5,text:25,eraser:120,shape:5}:{pencil:5,text:25,eraser:50,shape:5}:{pencil:5,text:18,eraser:30,shape:5},this.changeStrokeSizeClick("tool_color_measure_small",s)}},{key:"render",value:function(){var e=this,t=this.props.left,a=e._loadSmipleAndMoreListToArray(e.colors.smipleList,e.colors.moreList),n=a.smipleColorElementArray,i=a.moreColorElementArray,r=e.state.showItemJson,s=r.mouse,o=r.laser,l=r.brush,d=r.text,u=r.shape,c=r.undo,h=r.redo,m=r.eraser,g=r.clear,f=r.colorAndSize,p=r.colors,v=r.measure,b=this.state.registerWhiteboardToolsList,S=b.action_clear,w=b.action_redo,C=b.action_undo,T=e.state,P=T.currentUseTool,A=T.currentExtendToolContainer,D=T.showCurrentExtendToolContainer,_=T.useBrush,E=T.useText,I=T.useShape,x=T.useStrokeSize,B=T.currentExtendToolExtraContainer;return y.default.createElement("div",{className:"whiteboard-tool-total-box add-fl clear-float"},"phone"!==k.default.mobileDeviceType?y.default.createElement("ol",{className:"add-fl clear-float h-tool tool-whiteboard-container pc pad ",id:"header_tool_vessel",style:{display:e.state.show?"":"none"}}," ",s?y.default.createElement("li",{className:"tool-li tl-mouse "+("tool_mouse"===P?"active":""),id:"whiteboard_tool_vessel_mouse",style:{display:s?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.mouse.title,id:"tool_mouse",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_mouse"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,o?y.default.createElement("li",{className:"tool-li tl-laser "+("tool_laser"===P?"active":""),id:"whiteboard_tool_vessel_laser",style:{display:o?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.pencil.laser.title,id:"tool_laser",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_laser"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,l?y.default.createElement("li",{className:"tool-li tl-pencil "+("whiteboard_tool_vessel_brush"===A?"active ":" ")+("whiteboard_tool_vessel_brush"===A&&D?"more ":" "),id:"whiteboard_tool_vessel_brush",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_brush"),style:{display:l?void 0:"none"}},y.default.createElement("button",{className:"header-tool tool-pencil  tool-more ",id:"tool_vessel_brush",title:k.default.language.languageData.header.tool.pencil.title,onClick:e.selectExtendTool.bind(e,{extendToolId:"whiteboard_tool_vessel_brush"}),tkcustomdataiconclass:_},y.default.createElement("span",{className:"tool-img-wrap tool-pencil-icon"})),y.default.createElement("div",{className:"header-tool-extend tool-pencil-extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("ul",{className:"clear-float"},y.default.createElement("li",{id:"tool_pencil",className:"extend-brush-pencil "+("tool_pencil"===_?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_pencil",extendToolId:"whiteboard_tool_vessel_brush"})},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.pencil.pen.text)),y.default.createElement("li",{id:"tool_highlighter",className:"extend-brush-highlighter "+("tool_highlighter"===_?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_highlighter",extendToolId:"whiteboard_tool_vessel_brush"})},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.pencil.Highlighter.text)),y.default.createElement("li",{id:"tool_line",className:"extend-brush-line "+("tool_line"===_?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_line",extendToolId:"whiteboard_tool_vessel_brush"})},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.pencil.linellae.text)),y.default.createElement("li",{id:"tool_arrow",className:"extend-brush-arrow "+("tool_arrow"===_?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_arrow",extendToolId:"whiteboard_tool_vessel_brush"})},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.pencil.arrow.text))))):void 0,d?"mobile"!==TK.SDKTYPE?y.default.createElement("li",{className:"tool-li tl-text "+("whiteboard_tool_vessel_text"===A?"active ":" ")+("whiteboard_tool_vessel_text"===A&&D?"more ":" "),id:"whiteboard_tool_vessel_text",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_text"),style:{display:d?void 0:"none"}},y.default.createElement("button",{className:"header-tool  tool-text  tool-more",title:k.default.language.languageData.header.tool.text.title,id:"tool_text",onClick:e.selectExtendTool.bind(e,{extendToolId:"whiteboard_tool_vessel_text"}),tkcustomdataiconclass:E},y.default.createElement("span",{className:"tool-img-wrap"})),y.default.createElement("div",{className:"header-tool-extend tool-text-extend",id:"tool_text_extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("ul",{className:"clear-float"},y.default.createElement("li",{id:"tool_text_msyh",className:"extend-text-msyh "+("tool_text_msyh"===E?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_text_msyh",extendToolId:"whiteboard_tool_vessel_text"})},y.default.createElement("span",{className:"add-nowrap"},k.default.language.languageData.header.tool.text.Msyh.text)),y.default.createElement("li",{id:"tool_text_ming",className:"extend-text-ming "+("tool_text_ming"===E?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_text_ming",extendToolId:"whiteboard_tool_vessel_text"})},y.default.createElement("span",{className:"add-nowrap"},k.default.language.languageData.header.tool.text.Ming.text)),y.default.createElement("li",{id:"tool_text_arial",className:"extend-text-arial "+("tool_text_arial"===E?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_text_arial",extendToolId:"whiteboard_tool_vessel_text"})},y.default.createElement("span",{className:"add-nowrap"},k.default.language.languageData.header.tool.text.Arial.text))))):y.default.createElement("li",{className:"tool-li tl-text "+("tool_text"===P?"active":""),id:"whiteboard_tool_vessel_text",style:{display:d?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.text.title,id:"tool_text",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_text"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,u?y.default.createElement("li",{className:"tool-li tl-shape "+("whiteboard_tool_vessel_shape"===A?"active ":" ")+("whiteboard_tool_vessel_shape"===A&&D?"more ":" "),id:"whiteboard_tool_vessel_shape",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_shape"),style:{display:u?void 0:"none"}},y.default.createElement("button",{className:"header-tool  tool-shape   tool-more",title:k.default.language.languageData.header.tool.shape.title,id:"tool_shape_list",onClick:e.selectExtendTool.bind(e,{extendToolId:"whiteboard_tool_vessel_shape"}),tkcustomdataiconclass:I},y.default.createElement("span",{className:"tool-img-wrap"})),y.default.createElement("div",{className:"header-tool-extend tool-shape-extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("ul",{className:"clear-float"},y.default.createElement("li",{className:"extend-shape-rectangle-empty "+("tool_rectangle_empty"===I?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_rectangle_empty",extendToolId:"whiteboard_tool_vessel_shape"}),id:"tool_rectangle_empty"},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.shape.outlinedRectangle.text)),y.default.createElement("li",{className:"extend-shape-rectangle "+("tool_rectangle"===I?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_rectangle",extendToolId:"whiteboard_tool_vessel_shape"}),id:"tool_rectangle"},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.shape.filledRectangle.text)),y.default.createElement("li",{className:"extend-shape-ellipse-empty "+("tool_ellipse_empty"===I?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_ellipse_empty",extendToolId:"whiteboard_tool_vessel_shape"}),id:"tool_ellipse_empty"},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.shape.outlinedCircle.text)),y.default.createElement("li",{className:"extend-shape-ellipse "+("tool_ellipse"===I?"active":""),onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_ellipse",extendToolId:"whiteboard_tool_vessel_shape"}),id:"tool_ellipse"},y.default.createElement("span",{className:"add-nowrap"},"mobile"===TK.SDKTYPE?void 0:k.default.language.languageData.header.tool.shape.filledCircle.text))))):void 0,p&&"mobile"===TK.SDKTYPE?y.default.createElement("li",{className:"tool-li tl-colors "+("whiteboard_tool_vessel_colors"===B?"active more":""),id:"whiteboard_tool_vessel_colors",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_colors"),style:{display:p?void 0:"none"}},y.default.createElement("button",{className:"header-tool  tool-colors   tool-more",title:k.default.language.languageData.header.tool.colors.title,id:"tool_colors_list",onClick:e.selectExtendExtraTool.bind(e,{extendToolId:"whiteboard_tool_vessel_colors"})},y.default.createElement("span",{className:"tool-img-wrap",style:{background:"#"+this.state.selectColor}})),y.default.createElement("div",{className:"header-tool-extend tool-colors-extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("ul",{className:"clear-float"},y.default.createElement("li",{className:"simple-color-000000 "+("simple_color_000000"===e.state.useStrokeColor?"active":""),onClick:e.changeStrokeColorClick.bind(e,"simple_color_000000","000000"),id:"mobile_simple_color_000000"},y.default.createElement("span",{className:"add-nowrap",style:{backgroundColor:"#000000"}})),y.default.createElement("li",{className:"simple-color-ff0001 "+("simple_color_ff0001"===e.state.useStrokeColor?"active":""),onClick:e.changeStrokeColorClick.bind(e,"simple_color_ff0001","ff0001"),id:"mobile_simple_color_ff0001"},y.default.createElement("span",{className:"add-nowrap",style:{backgroundColor:"#ff0001"}})),y.default.createElement("li",{className:"simple-color-fcd000 "+("simple_color_fcd000"===e.state.useStrokeColor?"active":""),onClick:e.changeStrokeColorClick.bind(e,"simple_color_fcd000","fcd000"),id:"mobile_simple_color_fcd000"},y.default.createElement("span",{className:"add-nowrap",style:{backgroundColor:"#fcd000"}})),y.default.createElement("li",{className:"simple-color-0488f8 "+("simple_color_0488f8"===e.state.useStrokeColor?"active":""),onClick:e.changeStrokeColorClick.bind(e,"simple_color_0488f8","0488f8"),id:"mobile_simple_color_0488f8"},y.default.createElement("span",{className:"add-nowrap",style:{backgroundColor:"#0488f8"}}))))):void 0,v&&"mobile"===TK.SDKTYPE?y.default.createElement("li",{className:"tool-li tl-measure "+("whiteboard_tool_vessel_measure"===B?"active more":""),id:"whiteboard_tool_vessel_measure",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_measure"),style:{display:v?void 0:"none"}},y.default.createElement("button",{className:"header-tool  tool-measure  tool-more",title:k.default.language.languageData.header.tool.measure.title,id:"tool_measure_list",onClick:e.selectExtendExtraTool.bind(e,{extendToolId:"whiteboard_tool_vessel_measure"})},y.default.createElement("span",{className:"tool-img-wrap"},y.default.createElement("em",{style:{width:("tool_color_measure_small"===x?.1:"tool_color_measure_middle"===x?.2:.3)+"rem",height:("tool_color_measure_small"===x?.1:"tool_color_measure_middle"===x?.2:.3)+"rem"}}))),y.default.createElement("div",{className:"header-tool-extend tool-measure-extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("ul",{className:"clear-float"},y.default.createElement("li",{id:"tool_color_measure_small",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_small",{pencil:5,text:25,eraser:50,shape:5}),className:"h-tool-measure-mobile h-tool-measure-small-mobile "+("tool_color_measure_small"===x?"active":"")},y.default.createElement("span",{className:"add-nowrap",style:{width:"0.1rem",height:"0.1rem"}})),y.default.createElement("li",{id:"tool_color_measure_middle",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_middle",{pencil:15,text:50,eraser:100,shape:15}),className:"h-tool-measure-mobile h-tool-measure-middle-mobile "+("tool_color_measure_middle"===x?"active":"")},y.default.createElement("span",{className:"add-nowrap",style:{width:"0.2rem",height:"0.2rem"}})),y.default.createElement("li",{id:"tool_color_measure_big",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_big",{pencil:30,text:100,eraser:200,shape:30}),className:"h-tool-measure-mobile h-tool-measure-big-mobile "+("tool_color_measure_big"===x?"active":"")},y.default.createElement("span",{className:"add-nowrap",style:{width:"0.3rem",height:"0.3rem"}}))))):void 0,c?y.default.createElement("li",{className:"tool-li tl-undo",id:"whiteboard_tool_vessel_undo",style:{display:c?void 0:"none"}},y.default.createElement("button",{disabled:C.disabled,className:"header-tool not-active "+(C.disabled?"disabled":""),id:"tool_operation_undo",title:k.default.language.languageData.header.tool.undo.title,onClick:e.useWhiteboardAction.bind(e,{actionId:"action_undo"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,h?y.default.createElement("li",{className:"tool-li tl-redo",id:"whiteboard_tool_vessel_redo",style:{display:h?void 0:"none"}},y.default.createElement("button",{disabled:w.disabled,className:"header-tool not-active "+(w.disabled?"disabled":""),id:"tool_operation_redo",title:k.default.language.languageData.header.tool.redo.title,onClick:e.useWhiteboardAction.bind(e,{actionId:"action_redo"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,m?y.default.createElement("li",{className:"tool-li tl-eraser "+("tool_eraser"===P?"active":""),id:"whiteboard_tool_vessel_eraser",style:{display:m?void 0:"none"}},y.default.createElement("button",{className:"header-tool tool-eraser",title:k.default.language.languageData.header.tool.eraser.title,id:"tool_eraser",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_eraser"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,g?y.default.createElement("li",{className:"tool-li tl-clear",id:"whiteboard_tool_vessel_clear",style:{display:g?void 0:"none"}},y.default.createElement("button",{disabled:S.disabled,className:"header-tool not-active "+(S.disabled?"disabled":""),id:"tool_operation_clear",title:k.default.language.languageData.header.tool.clear.title,onClick:e.useWhiteboardAction.bind(e,{actionId:"action_clear"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,f?y.default.createElement("li",{className:"tool-li tl-color "+("whiteboard_tool_vessel_color_strokesize"===B?"active more":""),id:"whiteboard_tool_vessel_color_strokesize",onMouseLeave:e.allLiMouseLeave.bind(e,"whiteboard_tool_vessel_color_strokesize"),style:{display:f?void 0:"none"}},y.default.createElement("button",{className:"header-tool",id:"tool_stroke_color_vessel",title:k.default.language.languageData.header.tool.colorAndMeasure.title,onClick:e.selectExtendExtraTool.bind(e,{extendToolId:"whiteboard_tool_vessel_color_strokesize"})},y.default.createElement("span",{id:"tool_stroke_color",className:"tool-img-wrap h-tool-color no-hover"},y.default.createElement("span",{tkcustomdatacurrtype:"simple",tkcustomdatacurrcolor:"000000",className:"tool-color-show tk-tool-color",id:"header_curr_color",style:{backgroundColor:"#"+e.state.selectColor}},y.default.createElement("span",{className:"tool_triangle"})))),y.default.createElement("div",{className:"header-tool-extend tool-color-extend clear-float tk-tool-color-extend",style:{right:t>1.45||0==t?"100%":void 0,left:t<1.4&&"number"==typeof t?"100%":void 0}},y.default.createElement("div",{className:"tool-measure-container add-fl",id:"tool_measure"},y.default.createElement("div",{className:"h-tool-measure-title"},y.default.createElement("span",null,k.default.language.languageData.header.tool.colorAndMeasure.selectMeasure)),y.default.createElement("div",{id:"tool_color_measure_small",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_small",{pencil:5,text:18,eraser:30,shape:5}),className:"h-tool-measure h-tool-measure-small "+("tool_color_measure_small"===x?"active":"")},y.default.createElement("span",null)),y.default.createElement("div",{id:"tool_color_measure_middle",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_middle",{pencil:15,text:36,eraser:90,shape:15}),className:"h-tool-measure h-tool-measure-middle "+("tool_color_measure_middle"===x?"active":"")},y.default.createElement("span",null)),y.default.createElement("div",{id:"tool_color_measure_big",onClick:e.changeStrokeSizeClick.bind(e,"tool_color_measure_big",{pencil:30,text:72,eraser:150,shape:30}),className:"h-tool-measure h-tool-measure-big "+("tool_color_measure_big"===x?"active":"")},y.default.createElement("span",null))),y.default.createElement("div",{className:"tool-color-container add-fl"},y.default.createElement("div",{className:"header-tool-extend-option-wrap  header-tool-extend-option-color "},y.default.createElement("div",{className:"h-tool-extend-option-title"},k.default.language.languageData.header.tool.colorAndMeasure.selectColorText),y.default.createElement("div",{className:"h-tool-extend-option-content"},y.default.createElement("div",{className:"h-curr-color-wrap",id:"header_curr_select_color"},y.default.createElement("span",{className:"h-curr-color",style:{backgroundColor:"#"+this.state.selectColor}})),y.default.createElement("div",{className:"h-color-list-wrap clear-float",id:"header_color_list"},y.default.createElement("div",{className:"h-color-simple add-fl"},y.default.createElement("ul",{className:"clear-float"},n)),y.default.createElement("div",{className:"h-color-more add-fl"},i))))))):void 0):y.default.createElement("ol",{className:"add-fl clear-float h-tool tool-whiteboard-container phone ",id:"header_tool_vessel",style:{display:e.state.show?"":"none"}}," ",s?y.default.createElement("li",{className:"tool-li tl-mouse "+("tool_mouse"===P?"active":""),id:"whiteboard_tool_vessel_mouse",style:{display:s?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.mouse.title,id:"tool_mouse",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_mouse"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,l?y.default.createElement("li",{className:"tool-li tl-pencil "+("tool_pencil"===P?"active":""),id:"whiteboard_tool_vessel_pencil",style:{display:l?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.pencil.title,id:"tool_pencil",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_pencil"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,d?y.default.createElement("li",{className:"tool-li tl-text "+("tool_text"===P?"active":""),id:"whiteboard_tool_vessel_text",style:{display:d?void 0:"none"}},y.default.createElement("button",{className:"header-tool",title:k.default.language.languageData.header.tool.text.title,id:"tool_text",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_text"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,m?y.default.createElement("li",{className:"tool-li tl-eraser "+("tool_eraser"===P?"active":""),id:"whiteboard_tool_vessel_eraser",style:{display:m?void 0:"none"}},y.default.createElement("button",{className:"header-tool tool-eraser",title:k.default.language.languageData.header.tool.eraser.title,id:"tool_eraser",onClick:e.selectCurrentUseTool.bind(e,{toolId:"tool_eraser"})},y.default.createElement("span",{className:"tool-img-wrap"}))):void 0,p?y.default.createElement("li",{className:"tool-li  tl-color simple-color-000000 "+("simple_color_000000"===e.state.useStrokeColor?"active":""),id:"whiteboard_tool_vessel_color_000000",style:{display:p?void 0:"none"}},y.default.createElement("button",{className:"header-tool",id:"tool_color_000000",onClick:e.changeStrokeColorClick.bind(e,"simple_color_000000","000000")},y.default.createElement("span",{className:"tool-img-wrap",style:{backgroundColor:"#000000"}}))):void 0,p?y.default.createElement("li",{className:"tool-li tl-color  simple-color-ff0001 "+("simple_color_ff0001"===e.state.useStrokeColor?"active":""),id:"whiteboard_tool_vessel_color_ff0001",style:{display:p?void 0:"none"}},y.default.createElement("button",{className:"header-tool",id:"tool_color_ff0001",onClick:e.changeStrokeColorClick.bind(e,"simple_color_ff0001","ff0001")},y.default.createElement("span",{className:"tool-img-wrap",style:{backgroundColor:"#ff0001"}}))):void 0,p?y.default.createElement("li",{className:"tool-li  tl-color simple-color-fcd000 "+("simple_color_fcd000"===e.state.useStrokeColor?"active":""),id:"whiteboard_tool_vessel_color_fcd000",style:{display:p?void 0:"none"}},y.default.createElement("button",{className:"header-tool",id:"tool_color_fcd000",onClick:e.changeStrokeColorClick.bind(e,"simple_color_fcd000","fcd000")},y.default.createElement("span",{className:"tool-img-wrap",style:{backgroundColor:"#fcd000"}}))):void 0,p?y.default.createElement("li",{className:"tool-li  tl-color simple-color-0488f8 "+("simple_color_0488f8"===e.state.useStrokeColor?"active":""),id:"whiteboard_tool_vessel_color_0488f8",style:{display:p?void 0:"none"}},y.default.createElement("button",{className:"header-tool",id:"tool_color_0488f8",onClick:e.changeStrokeColorClick.bind(e,"simple_color_0488f8","0488f8")},y.default.createElement("span",{className:"tool-img-wrap",style:{backgroundColor:"#0488f8"}}))):void 0))}}]),t}(y.default.Component);t.default=I},Kh5d:function(e,t,a){var n=a("sB3e"),i=a("PzxK");a("uqUo")("getPrototypeOf",function(){return function(e){return i(n(e))}})},KmDb:function(e,t,a){e.exports={default:a("XxZZ"),__esModule:!0}},KyAL:function(e,t,a){function n(e){return a(i(e))}function i(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./i18_chinese.js":"ppOE","./i18_complex.js":"2vo4","./i18_english.js":"yZ13"};n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id="KyAL"},L2Bt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),r={},s=function(e){var t=this;this.options=e||{},this.isResized=!1,this.sendMessagePermission=this.options.sendMessagePermission||!0,this.recvRemoteDataing=this.options.recvRemoteDataing||!1,this.isOpenPptFile=!1,r.newPptAynamicPPT={that:t},this.aynamicPptData={old:{slide:null,step:null,fileid:null},now:{slide:null,step:null,fileid:null}},this.remoteData={},this.recvCount=0};s.prototype={constructor:s,sendMessageToRemote:function(e,t,a){var n=r.newPptAynamicPPT.that;a=void 0==a||a;var i={};a&&n.remoteData&&(i.pptslide=n.remoteData.slide+1,i.currpage=n.remoteData.slide+1,i.pptstep=n.remoteData.step>=0?n.remoteData.step:0,i.steptotal=n.remoteData.stepTotal);for(var s in e)i[s]=e[s];i.pagenum=n.remoteData.slidesCount;var o=n.isInitiative(t);$(document).trigger("sendPPTMessageEvent",[i,o])},resizeUpdatePPT:function(e){e.scale=1,$(window).trigger("resize")},resizeHandler:function(e){var e=e||this;e.isOpenPptFile&&e.autoChangePptSize(e)},autoChangePptSize:function(e){e=e||this},changeAynamicPptData:function(){var e=this,t=e.remoteData;if(void 0!=t.slide&&void 0!=t.step){var a={slide:t.slide+1,step:t.step};for(var n in e.aynamicPptData.now)e.aynamicPptData.old[n]=e.aynamicPptData.now[n];e.aynamicPptData.now.fileid=e.fileid,e.aynamicPptData.now.slide=a.slide,e.aynamicPptData.now.step=a.step}},playerControlClass:{HandleSlideChange:function(e){var t=r.newPptAynamicPPT.that;$("#curr_ppt_page").html(e+1),$("#all_ppt_page").html(t.remoteData.slidesCount);var a={pptslide:e+1,currpage:e+1,fileid:t.fileid,pagenum:t.remoteData.slidesCount};$(document).trigger("slideChangeToLcData",[a])}},changeFileElementProperty:function(){var e=r.newPptAynamicPPT.that,t=e.remoteData;if(void 0!==t.step||void 0!==t.stepTotal||void 0!==t.slide){var a=t.stepTotal,n=t.slide+1,i=t.step;n<=1&&i<=0?$("#ppt_prev_page_slide[data-set-disabled=yes] ,#prev_page_phone_slide[data-set-disabled=yes]").removeClass("disabled").addClass("disabled").attr("disabled","disabled"):$("#ppt_prev_page_slide[data-set-disabled=yes] ,#prev_page_phone_slide[data-set-disabled=yes]").removeClass("disabled").removeAttr("disabled"),n>=e.remoteData.slidesCount&&i>=a-1?$("#ppt_next_page_slide[data-set-disabled=yes] ,#next_page_phone_slide[data-set-disabled=yes]").removeClass("disabled").addClass("disabled").attr("disabled","disabled"):$("#ppt_next_page_slide[data-set-disabled=yes] ,#next_page_phone_slide[data-set-disabled=yes]").removeClass("disabled").removeAttr("disabled"),$(document).trigger("newppt_changeFileElementProperty",{pptstep:t.step,steptotal:t.stepTotal})}},setSendMessagePermission:function(e){r.newPptAynamicPPT.that.sendMessagePermission=e},setRPathAndPres:function(e){var t=r.newPptAynamicPPT.that;e=e||{},t.rPathAddress=e.rPathAddress,t.PresAddress=e.PresAddress,t.fileid=e.fileid||null,t.currScale=1;var a=e.slideIndex||1,n=e.stepIndex||0;t.remoteSlide=a,t.remoteStep=n,t.needUpdateSlideAndStep=!0,t.isInitFinsh=!1,t.loading.loadingStart()},setNewPptFrameSrc:function(e){console.log("set newppt src:",e),e?$("#newppt_frame").attr("src",e):$("#newppt_frame").removeAttr("src")},clearAll:function(){var e=this;e.isResized=!1,e.isOpenPptFile=!1,e.firstLoaded=!1,e.sendMessagePermission=this.options.sendMessagePermission||!0,e.recvRemoteDataing=this.options.recvRemoteDataing||!1,e.contentHolder=null,e.contentHolderParent=null,e.pptVesselElemnt=null,e.pptZoomElemnt=null,e.lcToolContainer=null,e.presSettings={},e.aynamicPptData={old:{slide:null,step:null,fileid:null},now:{slide:null,step:null,fileid:null}},e.recvCount=0,e.setNewPptFrameSrc(""),e.newpptFrame=null},recvInitEventHandler:function(e,t){var a=this;a.isInitFinsh=!0,a.changeAynamicPptData(),a.playerControlClass.HandleSlideChange(e),a.onInitaliseSettingsHandler(),a.changeFileElementProperty(),a.needUpdateSlideAndStep&&(null!=a.remoteSlide&&null!=a.remoteStep&&(a.jumpToAnim(a.remoteSlide,a.remoteStep),a.remoteSlide=null,a.remoteStep=null),a.needUpdateSlideAndStep=!1),a.remoteActionData&&(a.postMessage(a.remoteActionData),a.remoteActionData=null);var n={Width:a.remoteData.view.width,Height:a.remoteData.view.height};$(document).trigger("updateLcScaleWhenAynicPPTInit",[n]),a.loading.loadingEnd()},recvSlideChangeEventHandler:function(e,t){var a=this;a.changeAynamicPptData(),a.playerControlClass.HandleSlideChange(e),a.changeFileElementProperty(),(a.isLoadInitSlideAndStep||(a.isLoadInitSlideAndStep=!0,0!==a.remoteData.slide||0!==a.remoteData.step))&&a.sendMessageToRemote({action:"slide"},t)},recvStepChangeEventHandler:function(e,t){var a=this;a.changeAynamicPptData(),a.changeFileElementProperty(),(a.isLoadInitSlideAndStep||(a.isLoadInitSlideAndStep=!0,0!==a.remoteData.slide||0!==a.remoteData.step))&&a.sendMessageToRemote({action:"step"},t)},newDopPresentation:function(e,t){var a=r.newPptAynamicPPT.that;if(a.options=e||a.options,a.resetParameter(a.options),a.playbackController=null,a.remoteData.slidesCount=null,a.isPlayedPresentation=null,a.remoteData.view=null,a.presentation=null,a.isLoadInitSlideAndStep=!1,a.isResized||(a.resizeUpdatePPT(a),a.isResized=!0),!a.firstLoaded){a.firstLoaded=!0,$("#ppt_prev_page , #ppt_next_page , #btnPause , #btnPlay , #ppt_next_page_slide ,#ppt_prev_page_slide , #btnGoto , #resizer , #aynamic_ppt_click  , #tool_zoom_big_ppt , #tool_zoom_small_ppt , #prev_page_phone_slide , #next_page_phone_slide").off("click mousedown"),$("#ppt_prev_page_slide,#prev_page_phone_slide").click(function(){if("newppt"==$(this).attr("data-plugs"))return a.recvCount=0,a.gotoPreviousStep(),!1}),$("#ppt_next_page_slide,#next_page_phone_slide").click(function(){if("newppt"==$(this).attr("data-plugs"))return a.recvCount=0,a.gotoNextStep(),!1}),$("#tool_zoom_big_ppt").off("click"),$("#tool_zoom_big_ppt").click(function(){"newppt"==$(this).attr("data-plugs")&&(a.currScale+=.5,a.currScale>=3&&(a.currScale=3),a.checkZoomStatus(),a.autoChangePptSize(a))}),$("#tool_zoom_small_ppt").off("click"),$("#tool_zoom_small_ppt").click(function(){"newppt"==$(this).attr("data-plugs")&&(a.currScale-=.5,a.currScale<=1&&(a.currScale=1),a.checkZoomStatus(),a.autoChangePptSize(a))}),a.checkZoomStatus();var n={eventSelector:"#ppt_prev_page , #ppt_next_page , #btnPause , #btnPlay , #ppt_next_page_slide ,#ppt_prev_page_slide , #btnGoto , #resizer , #aynamic_ppt_click , #prev_page_phone_slide , #next_page_phone_slide ",eventName:"click mousedown",rolePermissionNotExecute:"chairman",needClassBegin:!0};$(document).trigger("cancelEvent",[n])}return a},checkZoomStatus:function(){var e=this;e.currScale>=3?$("#tool_zoom_big_ppt").addClass("disabled").attr("disabled","disabled"):$("#tool_zoom_big_ppt").removeClass("disabled").removeAttr("disabled"),e.currScale<=1?$("#tool_zoom_small_ppt").addClass("disabled").attr("disabled","disabled"):$("#tool_zoom_small_ppt").removeClass("disabled").removeAttr("disabled"),$(document).trigger("updateLcScale",[e.currScale])},resetParameter:function(e){this.playbackController=null,this.slidesCount=null,this.isPlayedPresentation=null,this.view=null,this.presentation=null,this.options=e||this.options||{},this.rPathAddress=e.rPathAddress,this.PresAddress=e.PresAddress,this.fileid=e.fileid||null,this.remoteSlide=e.remoteSlide||null,this.remoteStep=e.remoteStep||null,this.needUpdateSlideAndStep=!1,this.currScale=1,this.recvCount=0,this.isOpenPptFile=!1,this.aynamicPptData={old:{slide:null,step:null,fileid:null},now:{slide:null,step:null,fileid:null}},this.formatedTotalTime=null,this.presSettings={},this.isTouchDevice=null,this.ipadKeyPadFlg=null,this.isPlaying=!1,this.remoteData={}},postMessage:function(e){var t=this;if(t.newpptFrame=t.newpptFrame||document.getElementById("newppt_frame"),t.newpptFrame.getAttribute("src")){var a={source:"tk_dynamicPPT",data:e};a=(0,i.default)(a),t.newpptFrame&&t.newpptFrame.contentWindow?t.newpptFrame.contentWindow.postMessage(a,"*"):console.error("postMessage error【that.newpptFrame ，that.newpptFrame.contentWindow 】:",t.newpptFrame,t.newpptFrame.contentWindow)}},jumpToAnim:function(e,t,a,n,i){var s=r.newPptAynamicPPT.that;if(s.jumpToAnimTimer=s.jumpToAnimTimer||null,s.isInitFinsh){var o={action:"jumpToAnim",data:{slide:e,step:t,timeOffset:n,autoStart:i,initiative:a}};s.postMessage(o)}else this.remoteSlide=e,this.remoteStep=t},onInitaliseSettingsHandler:function(){var e=r.newPptAynamicPPT.that;$(document).trigger("updateSlidesCountToLcElement",{pagenum:e.remoteData.slidesCount})},gotoPreviousStep:function(){var e=this;if(e.isInitFinsh){var t={action:"gotoPreviousStep"};e.postMessage(t)}},gotoNextStep:function(){var e=this;if(e.isInitFinsh){e.recvCount=0;var t={action:"gotoNextStep"};e.postMessage(t)}},gotoNextSlide:function(e){var t=this;if(t.isInitFinsh){var a=t.remoteData;if(void 0==a.slide||void 0==a.step)return;var n={slide:a.slide+1,step:a.step};if(t.remoteData.slidesCount&&n.slide<t.remoteData.slidesCount){t.recvCount=0;var i={action:"gotoNextSlide",autoStart:e};t.postMessage(i)}}},gotoPreviousSlide:function(e){var t=this;if(t.isInitFinsh){var a=t.remoteData;if(void 0==a.slide||void 0==a.step)return;var n={slide:a.slide+1,step:a.step};if(t.remoteData.slidesCount&&n.slide>1){t.recvCount=0;var i={action:"gotoPreviousSlide",autoStart:e};t.postMessage(i)}}},isInitiative:function(e){return e&&e.initiative},loading:{loadingStart:function(){$("#preloader_newppt").css("display","block")},loadingEnd:function(){$("#preloader_newppt").css("display","none")}}},t.default=s},LIJb:function(e,t,a){var n=a("EqjI");e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},Mhyx:function(e,t,a){var n=a("/bQp"),i=a("dSzd")("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||r[i]===e)}},"NWt+":function(e,t,a){var n=a("+ZMJ"),i=a("msXi"),r=a("Mhyx"),s=a("77Pl"),o=a("QRG4"),l=a("3fs2"),d={},u={},t=e.exports=function(e,t,a,c,h){var m,g,f,p,v=h?function(){return e}:l(e),b=n(a,c,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(m=o(e.length);m>y;y++)if((p=t?b(s(g=e[y])[0],g[1]):b(e[y]))===d||p===u)return p}else for(f=v.call(e);!(g=f.next()).done;)if((p=i(f,b,g.value,t))===d||p===u)return p};t.BREAK=d,t.RETURN=u},Ovlj:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),r=n(i),s=a("pFYg"),o=n(s),l=a("Zrlr"),d=n(l),u=a("wxAW"),c=n(u),h=a("HUPQ"),m=n(h),g=a("yE5a"),f=n(g),p=a("Sa83"),v=n(p),b=a("VSuD"),y=n(b),S=function(){function e(){(0,d.default)(this,e)}return(0,c.default)(e,[{key:"pubMsg",value:function(e,t,a,n,i,s,l,d){if(v.default.handler.getAppPermissions("pubMsg")&&m.default.appConnected){a=a||"__all";var u=!i;n&&"object"===(void 0===n?"undefined":(0,o.default)(n))&&(n=(0,r.default)(n));var c={msgName:e,msgId:t,toId:a,data:n,save:u,expiresabs:s,associatedMsgID:l,associatedUserID:d,expires:void 0,type:void 0,write2DB:void 0,actions:void 0,do_not_replace:void 0};f.default.getTkRoom().pubMsg(c)}}},{key:"delMsg",value:function(e,t,a,n){if(v.default.handler.getAppPermissions("delMsg")&&m.default.appConnected){a=a||"__all",n&&"object"===(void 0===n?"undefined":(0,o.default)(n))&&(n=(0,r.default)(n));var i={msgName:e,msgId:t,toId:a,data:n};f.default.getTkRoom().delMsg(i)}}},{key:"setProperty",value:function(e,t,a){v.default.handler.getAppPermissions("setProperty")&&m.default.appConnected&&(t=t||"__all",f.default.getTkRoom().changeUserProperty(e,t,a))}},{key:"setParticipantPropertyToAll",value:function(e,t){if(v.default.handler.getAppPermissions("setParticipantPropertyToAll")){var a=this,n=f.default.getTkRoom().getUsers()[e];if(!n)return void L.Logger.error("user is not exist  , user id is "+e+"!");(n.role===y.default.role.roleChairman||n.role===y.default.role.roleStudent||n.role===y.default.role.roleTeachingAssistant&&y.default.joinRoomInfo.assistantOpenMyseftAV||!t||void 0==t.publishstate)&&a.setProperty(e,"__all",t)}}},{key:"sendSignallingDataToParticipant",value:function(e,t,a,n,i,r,s,o,l){if(v.default.handler.getAppPermissions("sendSignallingDataToParticipant")){var d=this;e?d.delMsg(t,a,n,i):(o||"VideoWhiteboard"===t||"ClassBegin"===t||"SharpsChange"===t||"WBPageCount"===t||"ShowPage"===t||"whiteboardMarkTool"===t||(o="ClassBegin"),d.pubMsg(t,a,n,i,r,s,o,l))}}}]),e}();t.default=S},P0xP:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("T+56"),v=n(p),b=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.state={show:!1,blackboardThumbnailImageWidth:a.props.blackboardThumbnailImageWidth||"2rem",blackboardThumbnailImageBackgroundColor:a.props.blackboardThumbnailImageBackgroundColor||"#ffffff",blackboardThumbnailImageId:a.props.blackboardThumbnailImageId||"blackboardThumbnailImageId"},a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this;v.default.CoreController.addEventListener("updateBlackboardThumbnailImageFromMoreBlackboard",e.handlerUpdateBlackboardThumbnailImageFromMoreBlackboard.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;v.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"handlerUpdateBlackboardThumbnailImageFromMoreBlackboard",value:function(e){var t=e.message,a=t.show,n=t.blackboardThumbnailImageId,i=t.blackboardThumbnailImageBackgroundColor;n!==this.state.blackboardThumbnailImageId&&this.setState({blackboardThumbnailImageId:n}),a!==this.state.show&&this.setState({show:a}),i!==this.state.blackboardThumbnailImageBackgroundColor&&this.setState({blackboardThumbnailImageBackgroundColor:i})}},{key:"blackboardThumbnailOnClick",value:function(){this.setState({show:!1}),v.default.CoreController.dispatchEvent({type:"updateBlackboardThumbnailImageFromBlackboardThumbnailImage",message:{action:"magnify"}})}},{key:"render",value:function(){return f.default.createElement("article",{className:"blackboard-thumbnail-image-container add-position-absolute-bottom0-left0",onClick:"mobile"===TK.SDKTYPE?void 0:this.blackboardThumbnailOnClick.bind(this),onTouchStart:"mobile"===TK.SDKTYPE?this.blackboardThumbnailOnClick.bind(this):void 0,style:{display:this.state.show?"block":"none",zIndex:160,border:"mobile"===TK.SDKTYPE?"0.01rem solid rgba(41, 41, 41, 0.81)":"0.01rem solid rgb(40, 54, 88)"}},f.default.createElement("img",{className:"blackboard-thumbnail-img",id:this.state.blackboardThumbnailImageId,style:{display:"block",width:this.state.blackboardThumbnailImageWidth,height:"auto",backgroundColor:this.state.blackboardThumbnailImageBackgroundColor}}),f.default.createElement("span",{className:"blackboard-thumbnail-imageDescribe add-position-absolute-bottom0-left0 add-nowrap",id:this.state.blackboardThumbnailImageId+"_imageDescribe",style:{display:"block",width:this.state.blackboardThumbnailImageWidth,height:"auto",fontSize:"0.2rem"}}))}}]),t}(f.default.Component);t.default=b},PRvV:function(e,t){},PqAP:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=a("GiK3"),r=n(i),s=a("O27J"),o=n(s),l=a("Sa83"),d=n(l),u=a("rkp3"),c=n(u);d.default.handler.loadSystemRequiredInfo(),o.default.render(r.default.createElement(c.default,null),document.getElementById("tk_app"))},"RY/4":function(e,t,a){var n=a("R9M2"),i=a("dSzd")("toStringTag"),r="Arguments"==n(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,a,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(a=s(t=Object(e),i))?a:r?n(t):"Object"==(o=n(t))&&"function"==typeof t.callee?"Arguments":o}},RkqK:function(e,t,a){var n=a("kM2E"),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var a,n,r=0,s=0,o=arguments.length,l=0;s<o;)a=i(arguments[s++]),l<a?(n=l/a,r=r*n*n+1,l=a):a>0?(n=a/l,r+=n*n):r+=a;return l===1/0?1/0:l*Math.sqrt(r)}})},Sa83:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("T+56"),r=n(i),s=a("GrKX"),o=n(s),l=a("VSuD"),d=n(l),u=a("HUPQ"),c=n(u),h=a("DrPG"),m=n(h),g=a("0jvK"),f=n(g),p=a("ZZXC"),v=n(p),b=a("yE5a"),y=n(b),S=TK.EventDispatcher({});r.default.CoreController=S,S.handler={},S.handler.loadSystemRequiredInfo=function(){if(TK.tkLogPrintConfig)if(d.default.DEV){var e={debug:!0},t={development:!0,logLevel:d.default.LOGLEVEL.DEBUG},a={webrtcLogDebug:!0};TK.tkLogPrintConfig(e,t,a)}else{var n={debug:!1},i={development:!1,logLevel:d.default.LOGLEVEL.INFO},r={webrtcLogDebug:!1};TK.tkLogPrintConfig(n,i,r)}v.default.getAppLanguageInfo(function(e){c.default.language=e}),y.default.setTkRoom(TK.Room()),o.default.registerEventToRoom()},S.handler.setAppPermissions=function(e,t){f.default.setAppPermissions(e,t)},S.handler.getAppPermissions=function(e){return f.default.getAppPermissions(e)},S.handler.initAppPermissions=function(e){f.default.initAppPermissions(e)},S.handler.addEventListenerOnCoreController=function(){document.oncontextmenu=null,document.oncontextmenu=function(){return!1},window.onbeforeunload=null,window.onbeforeunload=function(){},$(document).off("selectstart"),$(document).bind("selectstart",function(){return!0}),$(window).off("resize"),$(window).resize(function(){document.getElementById("tk_app")?(c.default.windowInnerWidth=document.getElementById("tk_app").clientWidth,c.default.windowInnerHeight=document.getElementById("tk_app").clientHeight):(c.default.windowInnerWidth=window.innerWidth,c.default.windowInnerHeight=window.innerHeight);var e=c.default.windowInnerWidth/d.default.STANDARDSIZE,t=document.getElementById("all_root")||document.getElementsByTagName("html");if(t){var a=m.default.isArray(t)?t[0]:t;a&&a.style&&(a.style.fontSize=e+"px")}r.default.Window.dispatchEvent({type:d.default.EVENTTYPE.WindowEvent.onResize,message:{defalutFontSize:e}})}),$(window).resize();var e=function(e){r.default.Window.dispatchEvent({type:d.default.EVENTTYPE.WindowEvent.onMessage,message:{event:e}})};m.default.tool.removeEvent(window,"message",e),m.default.tool.addEvent(window,"message",e,!1),"mobile"===TK.SDKTYPE&&S.handler.addEventfRromMobileUICoreEventManager()},S.handler.addEventfRromMobileUICoreEventManager=function(){"mobile"===TK.SDKTYPE&&(TK.mobileUICoreEventManager.addEventListener("mobileSdk_closeDynamicPptWebPlay",function(e){r.default.CoreController.dispatchEvent(e)}),TK.mobileUICoreEventManager.addEventListener("mobileSdk_setInitPageParameterFormPhone",function(e){var t=e.message;c.default.playback=TK.global.initPageParameterFormPhone.playback,d.default.bindServiceinfoToTkConstant(!0),void 0!==t.deviceType&&(c.default.mobileDeviceType=0===TK.global.initPageParameterFormPhone.deviceType?"phone":"pad"),void 0!==t.whiteboardcolor&&(c.default.whiteboardColorNumber=Number(t.whiteboardcolor)-1),r.default.CoreController.dispatchEvent({type:"mobileDeviceTypefrom_mobileSdk_setInitPageParameterFormPhone"})}),TK.mobileUICoreEventManager.addEventListener("mobileSdk_changeInitPageParameterFormPhone",function(e){var t=e.message;void 0===t.serviceUrl&&void 0===t.backupServiceUrl&&void 0===t.phpServiceUrl||d.default.bindServiceinfoToTkConstant(!1),void 0!==t.deviceType&&(c.default.mobileDeviceType=0===TK.global.initPageParameterFormPhone.deviceType?"phone":"pad",r.default.CoreController.dispatchEvent({type:"mobileDeviceTypefrom_mobileSdk_changeInitPageParameterFormPhone"})),t.debugLog}),TK.mobileUICoreEventManager.addEventListener("mobileSdk_fullScreenChangeCallback",function(e){r.default.CoreController.dispatchEvent(e)}),TK.mobileUICoreEventManager.addEventListener("mobileSdk_changeDynamicPptSize",function(e){r.default.CoreController.dispatchEvent(e)}),TK.mobileUICoreEventManager.addEventListener("mobileSdk_playbackPlayAndPauseController",function(e){var t=Object.customAssign({},e);t.type="playbackControl_play_pause",r.default.CoreController.dispatchEvent(t)}))},S.handler.addEventListenerOnCoreController(),t.default=S},"T+56":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};n.Document=TK.EventDispatcher({}),n.Window=TK.EventDispatcher({}),n.Element=TK.EventDispatcher({}),n.Room=TK.EventDispatcher({}),n.Stream=TK.EventDispatcher({}),n.Role=TK.EventDispatcher({}),t.default=n},"T6+d":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("gRE1"),r=n(i),s=a("lHA8"),o=n(s),l=a("c/Tr"),d=n(l),u=a("BO1k"),c=n(u),h=a("Zx67"),m=n(h),g=a("Zrlr"),f=n(g),p=a("wxAW"),v=n(p),b=a("zwoO"),y=n(b),S=a("Pf15"),k=n(S),w=a("GiK3"),C=n(w),T=a("HUPQ"),P=n(T),A=a("VSuD"),D=n(A),_=a("yE5a"),E=n(_),I=a("YRCL"),x=n(I),B=a("adC7"),R=(n(B),a("T+56")),L=n(R),N=a("Sa83"),W=n(N),M=function(e){function t(e){(0,f.default)(this,t);var a=(0,y.default)(this,(t.__proto__||(0,m.default)(t)).call(this,e));return a.state={show:{allTools:!1},disabledBlackBoard:!1,teachExpansionColumnDisplay:null,answerShow:!1,startAndStop:!1,restarting:!1,timeDescArray:[0,5,0,0],initArr:[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],brr:[],crr:[],idA:[],idB:[],idC:[],idD:[],idE:[],idF:[],idG:[],idH:[],allNumbers:0,trueLV:0,allStudentChosseAnswer:{},tableObject:{},round:!1,dialShow:!1,responderShow:!1,beginIsStatus:!1,studentRes:!1,timerShow:!1,userAdmin:"",disabledAnswer:!1,disabledTurnplate:!1,disabledTimer:!1,disabledResponder:!1,isPublished:!1,toolsShow:{answer:!1,turnplate:!1,timer:!1,responder:!1,moreBlackboard:!1},teachToolUl:"",boxToolClick:!1},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.destTopShare=!1,a}return(0,k.default)(t,e),(0,v.default)(t,[{key:"componentDidMount",value:function(){var e=this;L.default.CoreController.addEventListener(D.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener(D.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener(D.default.EVENTTYPE.RoomEvent.roomConnected,e.handlerRoomConnected.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("receive-msglist-timer",e.handlerMsglistTimerShow.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("receive-msglist-dial",e.handlerMsglistDialShow.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("receive-msglist-answer",e.handlerMsglistAnswerShow.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("receive-msglist-qiangDaQi",e.handlerMsglistQiangDaQi.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("receive-msglist-BlackBoard",e.handlerReceive_msglist_BlackBoard.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("callAllWrapOnClick",e.handlerCallAllWrapOnClick.bind(e),e.listernerBackupid),L.default.CoreController.addEventListener("whiteboardToolBox",e.whiteboardToolBox.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;L.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"handlerReceive_msglist_BlackBoard",value:function(e){this.handlerRoomPubmsg(e),"BlackBoard"===e.message.name&&this.setState({disabledBlackBoard:!0})}},{key:"handlerCallAllWrapOnClick",value:function(e){if("mobile"===TK.SDKTYPE){var t=e.message.event,a=this.props.parentId||"teach_header_tool_vessel";t.target.id===a||$(t.target)&&$(t.target).parents("#"+a).length>0||this.whiteboardToolBox()}}},{key:"allLiMouseLeave",value:function(){}},{key:"handlerRoomConnected",value:function(e){this.setState({disabledBlackBoard:!1,disabledAnswer:!1,disabledTurnplate:!1,disabledTimer:!1,disabledResponder:!1})}},{key:"handlerMsglistTimerShow",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=(0,c.default)(e.message.timerShowArr);!(t=(i=r.next()).done);t=!0)i.value,this.setState({disabledTimer:!0})}catch(e){a=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}}},{key:"handlerMsglistDialShow",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=(0,c.default)(e.message.dialShowArr);!(t=(i=r.next()).done);t=!0)i.value,this.setState({disabledTurnplate:!0})}catch(e){a=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}}},{key:"handlerMsglistAnswerShow",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=(0,c.default)(e.message.answerShowArr);!(t=(i=r.next()).done);t=!0)i.value,this.setState({disabledAnswer:!0})}catch(e){a=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}}},{key:"handlerMsglistQiangDaQi",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=(0,c.default)(e.message.qiangDaQiArr);!(t=(i=r.next()).done);t=!0)i.value,this.setState({disabledResponder:!0})}catch(e){a=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}}},{key:"handlerRoomPubmsg",value:function(e){switch(e.message.name){case"BlackBoard":this.setState({disabledBlackBoard:!0});break;case"answer":this.setState({disabledAnswer:!0});break;case"dial":this.setState({disabledTurnplate:!0});break;case"timer":this.setState({disabledTimer:!0});break;case"qiangDaQi":this.setState({disabledResponder:!0})}}},{key:"handlerRoomDelmsg",value:function(e){switch(e.message.name){case"BlackBoard":this.setState({disabledBlackBoard:!1});break;case"answer":this.setState({disabledAnswer:!1});break;case"dial":this.setState({disabledTurnplate:!1});break;case"timer":this.setState({disabledTimer:!1});break;case"qiangDaQi":this.setState({disabledResponder:!1});break;case"ClassBegin":this.setState({disabledAnswer:!1,disabledTurnplate:!1,disabledTimer:!1,disabledResponder:!1,disabledBlackBoard:!1})}}},{key:"handlerInitAppPermissions",value:function(){var e={answer:P.default.classBegin&&D.default.joinRoomInfo.toolBox.answer&&(D.default.hasRole.roleChairman||D.default.hasRole.roleTeachingAssistant),turnplate:P.default.classBegin&&D.default.joinRoomInfo.toolBox.turnplate&&(D.default.hasRole.roleChairman||D.default.hasRole.roleTeachingAssistant),timer:P.default.classBegin&&D.default.joinRoomInfo.toolBox.timer&&(D.default.hasRole.roleChairman||D.default.hasRole.roleTeachingAssistant),responder:P.default.classBegin&&D.default.joinRoomInfo.toolBox.responder&&!D.default.hasRoomtype.oneToOne&&(D.default.hasRole.roleChairman||D.default.hasRole.roleTeachingAssistant),moreBlackboard:P.default.classBegin&&D.default.joinRoomInfo.toolBox.moreBlackboard&&(D.default.hasRole.roleChairman||D.default.hasRole.roleTeachingAssistant)};Object.customAssign(this.state.toolsShow,e),this.state.show.allTools=W.default.handler.getAppPermissions("allUserTools"),this.setState({show:this.state.show,toolsShow:this.state.toolsShow})}},{key:"teachExpansionController",value:function(e){e.preventDefault(),this.state.boxToolClick=!this.state.boxToolClick,this.setState({boxToolClick:this.state.boxToolClick}),this.state.boxToolClick?(this.state.teachExpansionColumnDisplay="block",this.state.teachToolUl="block",this.setState({teachExpansionColumnDisplay:this.state.teachExpansionColumnDisplay,teachToolUl:this.state.teachToolUl}),L.default.CoreController.dispatchEvent({type:"teacherToolBox"})):this.teachBoxLeftMouseOut()}},{key:"whiteboardToolBox",value:function(){this.teachBoxLeftMouseOut()}},{key:"teachBoxLeftMouseOut",value:function(){this.state.boxToolClick=!1,this.setState({boxToolClick:this.state.boxToolClick}),this.state.teachExpansionColumnDisplay="none",this.setState({teachExpansionColumnDisplay:this.state.teachExpansionColumnDisplay})}},{key:"answerAssemblyShowHandel",value:function(e){if(this.state.disabledAnswer)return!1;e.preventDefault(),this.state.teachToolUl="none",this.state.answerShow=!0,this.setState({answerShow:this.state.answerShow,teachToolUl:this.state.teachToolUl}),this.teachBoxLeftMouseOut();var t=this.state.round,a=this.state.initArr,n=this.state.brr,i=this.state.trueLV,r=this.state.allNumbers,s=this.state.allStudentChosseAnswer,l=this.state.idA,u=this.state.idB,c=this.state.idC,h=this.state.idD,m=this.state.idE,g=this.state.idF,f=this.state.idG,p=this.state.idH,v=this.state.tableObject,b=this.state.isPublished,y=document.getElementById("result-teach-mytime").textContent,S=(0,d.default)(new o.default(this.state.crr));S=S.sort();var k=this.state.answerShow,w={optionalAnswers:a,quizTimes:y,rightAnswers:S,isRound:t,studentSelect:n,trueLV:i,allNumbers:r,dataChoose:s,dataTable:v,isPublished:b,idAS:l,idBS:u,idCS:c,idDS:h,idES:m,idFS:g,idGS:f,idHS:p,isShow:k};x.default.sendSignallingAnswerToStudent(w),L.default.CoreController.dispatchEvent({type:"handleAnswerShow",className:"answer-implement-bg",isShow:k})}},{key:"turntableAssemblyShowHandel",value:function(e){if(this.state.disabledTurnplate)return!1;e.preventDefault(),this.state.teachToolUl="none",this.state.dialShow=!0,this.setState({dialShow:this.state.dialShow,teachToolUl:this.state.teachToolUl}),this.teachBoxLeftMouseOut();var t=this.state.dialShow,a={rotationAngle:"rotate(0deg)",isShow:t};x.default.sendSignallingDialToStudent(a)}},{key:"timerAssemblyShowHandel",value:function(e){if(this.state.disabledTimer)return!1;e.preventDefault(),this.state.teachToolUl="none",this.state.timerShow=!0,this.state.restarting=!1,this.setState({timerShow:this.state.timerShow,restarting:this.state.restarting,teachToolUl:this.state.teachToolUl}),this.teachBoxLeftMouseOut();var t=this.state.startAndStop,a=this.state.timeDescArray,n=this.state.timerShow,i=this.state.restarting,r={isStatus:t,sutdentTimerArry:a,isShow:n,isRestart:i};x.default.sendSignallingTimerToStudent(r),L.default.CoreController.dispatchEvent({type:"handleTurnShow",className:"timer-implement-bg",isShow:n})}},{key:"responderAssemblyShowHandel",value:function(e){var t=this;if(t.state.disabledResponder)return!1;e.preventDefault(),t.state.teachToolUl="none",t.state.responderShow=!0,t.setState({responderShow:t.state.responderShow,teachToolUl:t.state.teachToolUl}),this.teachBoxLeftMouseOut();var a=t.state.responderShow,n=t.state.beginIsStatus,i=this.state.userAdmin,r={isShow:a,begin:n,userAdmin:i};x.default.sendSignallingQiangDaQi(!1,r),L.default.CoreController.dispatchEvent({type:"responderShow",className:"responder-implement-bg",isShow:a})}},{key:"handleBlackBoardClick",value:function(){var e={blackBoardState:"_prepareing",currentTapKey:"blackBoardCommon",currentTapPage:1};x.default.sendSignallingFromBlackBoard(e,!1)}},{key:"render",value:function(){var e=this,t=this.props.left,a=e.state,n=a.show,i=(a.onClick,a.toolsShow),s=n.allTools,o=0,l=0,d=!0,u=!1,h=void 0;try{for(var m,g=(0,c.default)((0,r.default)(i));!(d=(m=g.next()).done);d=!0)if(m.value&&(o++,l++),l>5){l=5;break}}catch(e){u=!0,h=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw h}}return C.default.createElement("ol",{className:"all-participant-function add-fl clear-float  h-tool",id:"teach_header_tool_vessel"}," ",C.default.createElement("li",{className:"tl-all-participant-tools "+("block"===this.state.teachExpansionColumnDisplay?"active":""),id:"tl-all-participant-tools-id",title:P.default.language.languageData.toolCase.toolBox.text,onMouseLeave:e.allLiMouseLeave.bind(this),onClick:this.teachExpansionController.bind(this),style:{display:0===o?"none":s?"block":"none"}},C.default.createElement("button",null,C.default.createElement("span",{className:"tool-box-wrap",id:"tool-box"})),C.default.createElement("div",{className:"teach-expansion-column ",style:{display:this.state.teachExpansionColumnDisplay,width:"calc(100% * "+l+")",right:t<2.5&&"number"==typeof t?"calc(-100% * "+l+")":"100%"}},C.default.createElement("ul",{className:"teach-box-left clear-float",ref:"teachBoxLeftStyle",style:{display:this.state.teachToolUl}},C.default.createElement("li",{className:"answer-implement-bg "+(this.state.disabledAnswer?"disabled":""),disabled:this.state.disabledAnswer,onClick:this.answerAssemblyShowHandel.bind(this),style:{display:i.answer?"":"none"}},C.default.createElement("span",{className:"icon"})),C.default.createElement("li",{className:"turnplate-implement-bg "+(this.state.disabledTurnplate?"disabled":""),disabled:this.state.disabledTurnplate,onClick:this.turntableAssemblyShowHandel.bind(this),style:{display:i.turnplate?"":"none"}},C.default.createElement("span",{className:"icon"})),C.default.createElement("li",{className:"timer-implement-bg "+(this.state.disabledTimer?"disabled":""),disabled:this.state.disabledTimer,onClick:this.timerAssemblyShowHandel.bind(this),style:{display:i.timer?"":"none"}},C.default.createElement("span",{className:"icon"})),C.default.createElement("li",{className:"responder-implement-bg "+(this.state.disabledResponder?"disabled":""),disabled:this.state.disabledResponder,onClick:this.responderAssemblyShowHandel.bind(this),style:{display:i.responder&&0!=E.default.getTkRoom().getRoomProperties().roomtype?"":"none"}},C.default.createElement("span",{className:"icon"})),C.default.createElement("li",{className:"tl-more-black-board "+(this.state.disabledBlackBoard?"disabled":""),title:P.default.language.languageData.header.tool.blackBoard.title.open,disabled:this.state.disabledBlackBoard,id:"more_black_board",style:{display:i.moreBlackboard?"":"none"},onClick:this.handleBlackBoardClick.bind(this)},C.default.createElement("span",{className:"icon"}))))))}}]),t}(C.default.Component);t.default=M},TmV0:function(e,t,a){a("fZOM"),e.exports=a("FeBl").Object.values},UQof:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("O27J"),v=n(p),b=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.state={extendShow:!1,listDirection:"down"},a.maxOptionNumber=5,a.pageSelectListPassivityHideNumber=a.props.pageSelectListPassivityHideNumber,a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){clearTimeout(this.pageSelectListPassivityHideNumbertTimer),this.pageSelectListPassivityHideNumbertTimer=null}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(t.extendShow!==this.state.extendShow&&this._noticeSelectExtendListShowOrHide(this.state.extendShow),void 0!==this.props.pageSelectListPassivityHideNumber&&this.pageSelectListPassivityHideNumber!==this.props.pageSelectListPassivityHideNumber&&(clearTimeout(this.pageSelectListPassivityHideNumbertTimer),this.pageSelectListPassivityHideNumbertTimer=setTimeout(function(){a.pageSelectListPassivityHideNumber=a.props.pageSelectListPassivityHideNumber,a.state.extendShow&&a.setState({extendShow:!1})},150)),this.refs.tkSelectContainer){var n=v.default.findDOMNode(this.refs.tkSelectContainer);if(n){var i=this._getRect(n),r=i.top,s=i.height;window.innerHeight-r>this.maxOptionNumber*s+20?"down"!==this.state.listDirection&&this.setState({listDirection:"down"}):"up"!==this.state.listDirection&&this.setState({listDirection:"up"})}}}},{key:"optionOnClick",value:function(e,t,a){return this.setState({extendShow:!1}),e!==this.props.currentValue&&this.props.onChange&&"function"==typeof this.props.onChange&&this.props.onChange(e,t),a&&a.preventDefault(),!1}},{key:"currentTextOnClick",value:function(e){return this.setState({extendShow:!this.state.extendShow}),e&&e.preventDefault(),!1}},{key:"selectContainerOnMouseLeave",value:function(e){return this.setState({extendShow:!1}),e&&e.preventDefault(),!1}},{key:"_noticeSelectExtendListShowOrHide",value:function(e){this.props.noticeSelectExtendListShowOrHide&&"function"==typeof this.props.noticeSelectExtendListShowOrHide&&this.props.noticeSelectExtendListShowOrHide(e)}},{key:"_getRect",value:function(e){var t=e.getBoundingClientRect(),a=document.documentElement.clientTop,n=document.documentElement.clientLeft;return{top:t.top-a,bottom:t.bottom-a,left:t.left-n,right:t.right-n,width:t.width,height:t.height}}},{key:"render",value:function(){var e=this,t=this.props,a=t.id,n=t.className,i=t.optionClassName,r=t.selectOptions,s=void 0===r?[]:r,o=t.disabled,l=t.isMobile,d=void 0!==l&&l,u=t.currentValue;return f.default.createElement("div",{id:a,ref:"tkSelectContainer",className:"tk-select-container clear-float "+this.state.listDirection+(o?" disabled ":"  ")+(n||"")+(o?" hideExtendList":this.state.extendShow?" showExtendList":" hideExtendList"),onMouseLeave:d?void 0:this.selectContainerOnMouseLeave.bind(this)},f.default.createElement("button",{className:"current-select-text "+(o?"disabled ":" "),disabled:o,onClick:o?void 0:this.currentTextOnClick.bind(this)},u),f.default.createElement("span",{className:"arrow-container "+(o?"disabled ":" ")},f.default.createElement("em",{className:"arrow "})),f.default.createElement("ol",{className:"select-extend-list-container "+this.state.listDirection+(o?" disabled ":"  ")+(o?" hide":this.state.extendShow?" show":" hide"),style:{display:o?"none":this.state.extendShow?"block":"none",maxHeight:"calc("+this.maxOptionNumber+" * 0.5rem)"}},s.map(function(t,a){return f.default.createElement("li",{key:a,className:"select-option "+(i||" ")+(u===t.value?" selected":" "),tkcustomdatalabel:t.label,onClick:o?void 0:e.optionOnClick.bind(e,t.value,a)},t.value)})))}}]),t}(f.default.Component);t.default=b},"Um+6":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),r=n(i),s=a("Zx67"),o=n(s),l=a("Zrlr"),d=n(l),u=a("wxAW"),c=n(u),h=a("zwoO"),m=n(h),g=a("Pf15"),f=n(g),p=a("GiK3"),v=n(p),b=a("O27J"),y=(n(b),a("HUPQ")),S=n(y),k=a("VSuD"),w=n(k),C=a("DrPG"),T=(n(C),a("T+56")),P=n(T),A=a("Sa83"),D=(n(A),a("yE5a")),_=n(D),E=a("YRCL"),I=n(E),x=a("EXAz"),B=n(x),R=function(e){function t(e){(0,d.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.props.id,a.state={responderStudentIsShow:"none",responderTop:"",responderLeft:"",timesRun:3,studentText:"",userName:null,isClick:!1,userSort:{},userArry:[],translateMove:null,isHasTransition:!1,resizeInfo:{width:0,height:0},getUserPublishState:null},a.isHasTransition=!1,a.msglistData=null,a.intervals=void 0,a.timeOutIntervals=void 0,a.temporaryStyle={percentLeft:null,percentTop:null},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this;P.default.CoreController.addEventListener(w.default.EVENTTYPE.RoomEvent.roomUserpropertyChanged,e.handlerRoomUserpropertyChanged.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-qiangDaQi",e.handlerMsglistQiangDaQi.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-QiangDaZhe",e.handlerMsglistQiangDaZhe.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(w.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(w.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-ResponderDrag",e.handlerMsglistResponderDrag.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;P.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){if(t.isHasTransition!==this.state.isHasTransition&&this.state.isHasTransition&&(this.isHasTransition=!1,this.setState({isHasTransition:!1})),t.responderStudentIsShow!==this.state.responderStudentIsShow&&"block"===this.state.responderStudentIsShow){var a=this.props.id,n=document.getElementById(a);if(n){var i=S.default.windowInnerWidth/w.default.STANDARDSIZE;this.state.resizeInfo.width=n.offsetWidth/i,this.state.resizeInfo.height=n.offsetHeight/i,this.setState({resizeInfo:this.state.resizeInfo})}}if(t.getUserPublishState!==this.state.getUserPublishState&&this.state.getUserPublishState>0&&this.msglistData){var s=!0,o=!1,l=void 0;try{for(var d,u=(0,r.default)(this.msglistData);!(s=(d=u.next()).done);s=!0){var c=d.value;this._teacherRecevedServiceQiangDaQiData(c)}}catch(e){o=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(o)throw l}}this.msglistData=null}}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!1)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(_.default.getTkRoom().getMySelf(),a.name){case"qiangDaQi":w.default.hasRole.roleStudent&&this.state.getUserPublishState>0&&t._teacherRecevedServiceQiangDaQiData(a);break;case"QiangDaZhe":w.default.hasRole.roleStudent&&t._teacherRecevedServiceQiangDaZheData(a);break;case"ResponderDrag":t.temporaryStyle.percentLeft=a.data.percentLeft,t.temporaryStyle.percentTop=a.data.percentTop}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"ClassBegin":t.setState({responderStudentIsShow:"none"});break;case"qiangDaQi":t.state.isClick=!1,t.state.timesRun=3,t.state.userArry=[],t.state.userSort={},t.state.studentText=t.state.timesRun,t.setState({userArry:t.state.userArry,userSort:t.state.userSort,responderStudentIsShow:"none",isClick:t.state.isClick,timesRun:t.state.timesRun,studentText:t.state.studentText})}}},{key:"handlerMsglistResponderDrag",value:function(e){var t=this;e.message.ResponderDragArray.map(function(e,a){t.temporaryStyle.percentLeft=e.data.percentLeft,t.temporaryStyle.percentTop=e.data.percentTop})}},{key:"handlerRoomUserpropertyChanged",value:function(e){_.default.getTkRoom().getMySelf().id===e.user.id&&void 0!=e.message.publishstate&&this.setState({getUserPublishState:e.message.publishstate})}},{key:"handlerMsglistQiangDaQi",value:function(e){_.default.getTkRoom().getMySelf(),w.default.hasRole.roleStudent&&(this.msglistData=e.message.qiangDaQiArr)}},{key:"handlerMsglistQiangDaZhe",value:function(e){var t=this,a=!0,n=!1,i=void 0;try{for(var s,o=(0,r.default)(e.message.QiangDaZheArr);!(a=(s=o.next()).done);a=!0){var l=s.value;w.default.hasRole.roleStudent&&t._teacherRecevedServiceQiangDaZheData(l)}}catch(e){n=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"_teacherRecevedServiceQiangDaQiData",value:function(e){var t=this,a=t.props,n=a.id,i=a.draggableData,r=document.getElementById(n),s=document.querySelector(i.dragBounds),o=S.default.serviceTime/1e3-e.ts;if(e.data.begin){if(o>=8){var l=void 0,d=void 0;null===t.temporaryStyle.percentLeft?(l=.5,d=0):(l=t.temporaryStyle.percentLeft,d=t.temporaryStyle.percentTop),i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:0,top:0,percentLeft:l,percentTop:d,isDrag:!0},!1),t.state.studentText=S.default.language.languageData.responder.noContest.text,t.setState({studentText:t.state.studentText})}else t.intervals=setInterval(function(){t.state.timesRun-=1,0==t.state.timesRun&&i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:0,top:0,percentLeft:.2,percentTop:.2,isDrag:!0},!1),1==t.state.timesRun&&i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:0,top:0,percentLeft:.4,percentTop:.6,isDrag:!0},!1),2==t.state.timesRun&&i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:0,top:0,percentLeft:.7,percentTop:.2,isDrag:!0},!1),t.state.studentText=t.state.timesRun,t.setState({timesRun:t.state.timesRun,studentText:t.state.studentText}),t.state.timesRun<=0&&(clearInterval(t.intervals),t.state.studentText=S.default.language.languageData.responder.answer.text,t.setState({studentText:t.state.studentText}),0==t.state.isClick&&(t.timeOutIntervals=setTimeout(function(){var e=void 0,a=void 0;null===t.temporaryStyle.percentLeft?(e=.5,a=0):(e=t.temporaryStyle.percentLeft,a=t.temporaryStyle.percentTop);var o=e*(s.offsetWidth-r.offsetWidth),l=a*(s.offsetHeight-r.offsetHeight);t.isHasTransition=!0,t.state.studentText=S.default.language.languageData.responder.noContest.text,i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:o,top:l,percentLeft:e,percentTop:a,isDrag:!0},!1),t.setState({isHasTransition:t.isHasTransition,studentText:t.state.studentText})},4500)))},1e3);t.setState({responderStudentIsShow:"block"})}else e.data.isShow&&(t.state.timesRun=3,t.state.studentText=3,t.setState({timesRun:t.state.timesRun,responderStudentIsShow:"none",studentText:t.state.studentText}))}},{key:"_teacherRecevedServiceQiangDaZheData",value:function(e){var t=this,a=t.props,n=a.id,i=a.draggableData;if(e.data.isClick){t.state.userSort[e.fromID]={},t.state.userSort[e.fromID][e.seq]=e.data.userAdmin,t.setState({userSort:t.state.userSort}),t.state.userArry=[];for(var r in t.state.userSort)for(var s in t.state.userSort[r])t.state.userArry.push(s),t.state.userArry=t.state.userArry.sort(),t.setState({userArry:t.state.userArry}),void 0!=t.state.userSort[r][t.state.userArry[0]]&&(t.state.studentText=t.state.userSort[r][t.state.userArry[0]],t.setState({studentText:t.state.studentText,firstUser:t.state.firstUser}));clearInterval(t.intervals),clearTimeout(t.timeOutIntervals);var o=void 0,l=void 0;null===t.temporaryStyle.percentLeft?(o=.5,l=0):(o=t.temporaryStyle.percentLeft,l=t.temporaryStyle.percentTop),i.changePosition&&"function"==typeof i.changePosition&&i.changePosition(n,{left:0,top:0,percentLeft:o,percentTop:l,isDrag:!0},!1),t.setState({studentText:t.state.studentText})}}},{key:"studentResponder",value:function(){var e=_.default.getTkRoom().getMySelf();if(this.state.getUserPublishState>0&&w.default.hasRole.roleStudent&&this.state.studentText==S.default.language.languageData.responder.answer.text&&0==this.state.isClick){this.state.userAdmin=e.nickname,this.setState({userAdmin:this.state.userAdmin}),this.state.isClick=!0,this.setState({isClick:this.state.isClick});var t=this.state.userAdmin,a=this.state.isClick,n={userAdmin:t,isClick:a};I.default.sendSignallingQiangDaZhe(!1,n)}}},{key:"render",value:function(){var e=this,t=this.state.resizeInfo,a=e.props,n=a.id,i=a.studentResponderDrag,r=a.draggableData,s={display:this.state.responderStudentIsShow,transitionProperty:this.isHasTransition?"all":void 0,transitionDuration:this.isHasTransition?"0.5s":void 0},o=Object.customAssign({id:n,size:t,percentPosition:{percentLeft:i.percentLeft,percentTop:i.percentTop}},r);return v.default.createElement(B.default,o,v.default.createElement("div",{className:"responder-circle-student touch-select-select ",id:n,style:s},v.default.createElement("div",{className:"responder-black-circle-student"}),v.default.createElement("div",{className:"responder-begin-circle-student "+("number"==typeof this.state.studentText?"disabled":""),onClick:this.studentResponder.bind(this)},this.state.studentText)))}}]),t}(v.default.Component);t.default=R},VSuD:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("HSQo"),r=n(i),s=a("DrPG"),o=n(s),l=a("T+56"),d=n(l),u=a("HUPQ"),c=n(u),h=a("yE5a"),m=n(h),g={},f="v2.1.0",p="2017120622",v=!1;try{f="2.1.7",p=2018050221,v=!1}catch(a){L.Logger.warning("There is no configuration version number and version time[__VERSIONS__ , __VERSIONSTIME__]!"),L.Logger.warning("There is no configuration dev mark[__DEV__]!")}g.VERSIONS=f,g.VERSIONSTIME=p,g.newpptVersions=2017091401,g.remoteNewpptUpdateTime=2018032113,g.debugFromAddress=!!o.default.getUrlParams("debug")&&""!=o.default.getUrlParams("debug"),g.DEV=v||g.debugFromAddress,g.role={},(0,r.default)(g.role,{roleChairman:{value:0,writable:!1},roleTeachingAssistant:{value:1,writable:!1},roleStudent:{value:2,writable:!1},roleAudit:{value:3,writable:!1},rolePatrol:{value:4,writable:!1},rolePlayback:{value:-1,writable:!1}});var b={};(0,r.default)(b,{roomConnected:{value:"room-connected",writable:!1,enumerable:!0},roomParticipantJoin:{value:"room-participant_join",writable:!1,enumerable:!0},roomParticipantLeave:{value:"room-participant_leave",writable:!1,enumerable:!0},roomPubmsg:{value:"room-pubmsg",writable:!1,enumerable:!0},roomDelmsg:{value:"room-delmsg",writable:!1,enumerable:!0},roomUserpropertyChanged:{value:"room-userproperty-changed",writable:!1,enumerable:!0},roomDisconnected:{value:"room-disconnected",writable:!1,enumerable:!0},roomMsglistFromConnected:{value:"room-msglist-from-connected",writable:!1,enumerable:!0},roomMsglist:{value:"room-msglist",writable:!1,enumerable:!0},roomPlaybackClearAll:{value:"room-playback-clear_all",writable:!1,enumerable:!0},roomPlaybackClearAllFromPlaybackController:{value:"room-playback-clear_all-from-playback-controller",writable:!1,enumerable:!0},roomTransmitWindowSize:{value:"transmitWindowSize",writable:!1,enumerable:!0}});var y={};(0,r.default)(y,{onResize:{value:"onResize",writable:!1}}),(0,r.default)(y,{onMessage:{value:"onMessage",writable:!1}});var S={};(0,r.default)(S,{onKeydown:{value:"onKeydown",writable:!1},onFullscreenchange:{value:"onFullscreenchange",writable:!1}}),g.EVENTTYPE={},(0,r.default)(g.EVENTTYPE,{RoomEvent:{value:b,writable:!1},WindowEvent:{value:y,writable:!1},DocumentEvent:{value:S,writable:!1}}),g.ROOMTYPE={},(0,r.default)(g.ROOMTYPE,{oneToOne:{value:0,writable:!1}}),g.PUBLISHSTATE={},(0,r.default)(g.PUBLISHSTATE,{PUBLISH_STATE_NONE:{value:TK.PUBLISH_STATE_NONE,writable:!1},PUBLISH_STATE_AUDIOONLY:{value:TK.PUBLISH_STATE_AUDIOONLY,writable:!1},PUBLISH_STATE_VIDEOONLY:{value:TK.PUBLISH_STATE_VIDEOONLY,writable:!1},PUBLISH_STATE_BOTH:{value:TK.PUBLISH_STATE_BOTH,writable:!1},PUBLISH_STATE_MUTEALL:{value:TK.PUBLISH_STATE_MUTEALL,writable:!1}}),g.STANDARDSIZE=15.8,g.companyidToCompanyName={10035:{value:"icoachu",writable:!1,enumerable:!0},10036:{value:"stupidBird",writable:!1,enumerable:!0},10059:{value:"17zuoye",writable:!1,enumerable:!0}},g.LOGLEVEL={},(0,r.default)(g.LOGLEVEL,{DEBUG:{value:0,writable:!1},TRACE:{value:1,writable:!1},INFO:{value:2,writable:!1},WARNING:{value:3,writable:!1},ERROR:{value:4,writable:!1},NONE:{value:5,writable:!1}}),g.SERVICEINFO={},g.bindServiceinfoToTkConstant=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[],a=[],n=[];try{TK.global.initPageParameterFormPhone.serviceUrl.address&&(t=TK.global.initPageParameterFormPhone.serviceUrl.address.split("://")),TK.global.initPageParameterFormPhone.backupServiceUrl.address&&(a=TK.global.initPageParameterFormPhone.backupServiceUrl.address.split("://")),TK.global.initPageParameterFormPhone.phpServiceUrl.address&&(n=TK.global.initPageParameterFormPhone.phpServiceUrl.address.split("://"))}catch(e){L.Logger.error("bindServiceinfoToTkConstant error:",e)}var i=t[0]||"https",r=n[1]||"global.talk-cloud.net",s=TK.global.initPageParameterFormPhone.phpServiceUrl.port||443,l=t[1]||r,u=TK.global.initPageParameterFormPhone.serviceUrl.port||s,h=a[1]||r,f=TK.global.initPageParameterFormPhone.backupServiceUrl.port||s,p={protocol:i,hostname:r,port:s,sdkPort:443,protocolAndHostname:i+"://"+r,address:i+"://"+r+":"+s,docHostname:l,docPort:u,docAddress:i+"://"+l+":"+u,backupDocHostname:h,backupDocPort:f,backupDocAddress:i+"://"+h+":"+f};if(e&&(p.joinUrl=o.default.encrypt(window.location.href)),Object.customAssign(g.SERVICEINFO,p),c.default.docAddressList[0]=g.SERVICEINFO.docAddress,c.default.docAddressList[1]=g.SERVICEINFO.backupDocAddress,!c.default.isGetDocAddressIndexByLocalStorageItem)if("mobile"===TK.SDKTYPE)try{m.default&&m.default.getTkRoom()&&"function"==typeof m.default.getTkRoom().getLocalStorageItem&&m.default.getTkRoom().getLocalStorageItem("tkDocAddressIndex",function(e){c.default.isGetDocAddressIndexByLocalStorageItem=!0,e&&"number"==typeof Number(e)&&e!==c.default.docAddressIndex&&(c.default.docAddressIndex=Number(e)%c.default.docAddressList.length,c.default.nowUseDocAddress=c.default.docAddressList[c.default.docAddressIndex]||g.SERVICEINFO.docAddress)})}catch(e){L.Logger.error("getLocalStorageItem error:",e)}else{var v=L.Utils.localStorage.getItem("tkDocAddressIndex");v&&"number"==typeof Number(v)&&v!==c.default.docAddressIndex&&(c.default.docAddressIndex=Number(v)%c.default.docAddressList.length,c.default.nowUseDocAddress=c.default.docAddressList[c.default.docAddressIndex]||g.SERVICEINFO.docAddress),c.default.isGetDocAddressIndexByLocalStorageItem=!0}c.default.docAddressIndex=c.default.docAddressIndex%c.default.docAddressList.length,c.default.nowUseDocAddress=c.default.docAddressList[c.default.docAddressIndex]||g.SERVICEINFO.docAddress,e&&console.info("encrypt_tk_info:\n",g.SERVICEINFO.joinUrl),d.default&&d.default.CoreController&&d.default.CoreController.dispatchEvent&&d.default.CoreController.dispatchEvent({type:"bindServiceinfoToTkConstant",message:{SERVICEINFO:g.SERVICEINFO}})},g.joinRoomInfo={},g.bindRoomInfoToTkConstant=function(e){if(!e)return void L.Logger.error("joinRoomInfo is not exist!");L.Logger.debug("joinRoomInfo:",e),g.joinRoomInfo=e,d.default.CoreController.dispatchEvent({type:"bindRoomInfoToTkConstant",message:{joinRoomInfo:g.joinRoomInfo}})},g.hasRole={},g.bindParticipantHasRoleToTkConstant=function(){if(!g.joinRoomInfo)return void L.Logger.error("TkConstant.joinRoomInfo is not exist!");(0,r.default)(g.hasRole,{roleChairman:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.roleChairman,writable:!1},roleTeachingAssistant:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.roleTeachingAssistant,writable:!1},roleStudent:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.roleStudent,writable:!1},roleAudit:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.roleAudit,writable:!1},rolePatrol:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.rolePatrol,writable:!1},rolePlayback:{value:g.joinRoomInfo&&g.joinRoomInfo.roomrole===g.role.rolePlayback,writable:!1}}),d.default.CoreController.dispatchEvent({type:"bindParticipantHasRoleToTkConstant",message:{hasRole:g.hasRole}})},g.hasRoomtype={},g.bindParticipantHasRoomtypeToTkConstant=function(){if(!g.joinRoomInfo)return void L.Logger.error("TkConstant.joinRoomInfo is not exist!");(0,r.default)(g.hasRoomtype,{oneToOne:{value:g.joinRoomInfo&&g.joinRoomInfo.roomtype===g.ROOMTYPE.oneToOne,writable:!1}}),d.default.CoreController.dispatchEvent({type:"bindParticipantHasRoomtypeToTkConstant",message:{hasRoomtype:g.hasRoomtype}})},window.TkConstant=g,t.default=g},W3Iv:function(e,t,a){e.exports={default:a("wEtr"),__esModule:!0}},WcKi:function(e,t){},Wi6Q:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),r=n(i),s=a("BO1k"),o=n(s),l=a("Zrlr"),d=n(l),u=a("wxAW"),c=n(u),h=a("VSuD"),m=n(h),g=a("yE5a"),f=(n(g),a("0jvK")),p=n(f),v=a("T+56"),b=(n(v),a("HUPQ")),y=n(b),S=a("Sa83"),k=(n(S),function(){function e(t){(0,d.default)(this,e),this.role=t}return(0,c.default)(e,[{key:"getRoleHasDefalutAppPermissions",value:function(e){var t=e||p.default.productionDefaultAppAppPermissions();if(m.default.joinRoomInfo&&void 0!=m.default.joinRoomInfo.roomrole)switch(m.default.joinRoomInfo.roomrole){case m.default.role.roleChairman:if(y.default.classBegin){var a=!0,n=!1,i=void 0;try{for(var s,l=(0,o.default)((0,r.default)(t));!(a=(s=l.next()).done);a=!0)t[s.value]=!0}catch(e){n=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw i}}Object.customAssign(t,{raisehand:!1,dialCircleClick:!1,isShowCoursewareRemarks:m.default.joinRoomInfo.hasCoursewareRemarks})}else Object.customAssign(t,{dynamicPptActionClick:!0,whiteboardPagingPage:!0,newpptPagingPage:!0,h5DocumentPagingPage:!0,jumpPage:!0,pubMsg:!0,delMsg:!0,setProperty:!0,sendSignallingFromShowPage:!0,sendSignallingFromDynamicPptShowPage:!0,sendSignallingFromH5ShowPage:!0,sendSignallingFromGeneralShowPage:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,h5DocumentActionClick:!0,endClassbeginRevertToStartupLayout:!0,isShowCoursewareRemarks:m.default.joinRoomInfo.hasCoursewareRemarks,sendSignallingFromRemoteControl:!0});break;case m.default.role.roleTeachingAssistant:if(y.default.classBegin){var d=!0,u=!1,c=void 0;try{for(var h,g=(0,o.default)((0,r.default)(t));!(d=(h=g.next()).done);d=!0)t[h.value]=!0}catch(e){u=!0,c=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw c}}Object.customAssign(t,{laser:!1,endClassbeginRevertToStartupLayout:!1,isShowCoursewareRemarks:m.default.joinRoomInfo.hasCoursewareRemarks})}else Object.customAssign(t,{dynamicPptActionClick:!0,whiteboardPagingPage:!0,newpptPagingPage:!0,h5DocumentPagingPage:!0,jumpPage:!0,sendSignallingFromShowPage:!0,sendSignallingFromDynamicPptShowPage:!0,sendSignallingFromH5ShowPage:!0,sendSignallingFromGeneralShowPage:!0,pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,endClassbeginRevertToStartupLayout:m.default.joinRoomInfo.isClassOverNotLeave,h5DocumentActionClick:!0,isShowCoursewareRemarks:m.default.joinRoomInfo.hasCoursewareRemarks,sendSignallingFromRemoteControl:!0});break;case m.default.role.rolePatrol:y.default.classBegin?Object.customAssign(t,{pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,whiteboardPagingPage:!1,newpptPagingPage:!1,h5DocumentPagingPage:!1,sendSignallingFromRemoteControl:!0}):Object.customAssign(t,{pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,whiteboardPagingPage:!1,newpptPagingPage:!1,h5DocumentPagingPage:!1,endClassbeginRevertToStartupLayout:m.default.joinRoomInfo.isClassOverNotLeave,sendSignallingFromRemoteControl:!0});break;case m.default.role.roleStudent:y.default.classBegin?Object.customAssign(t,{whiteboardPagingPage:m.default.joinRoomInfo.isSupportPageTrun,newpptPagingPage:m.default.joinRoomInfo.isSupportPageTrun,h5DocumentPagingPage:m.default.joinRoomInfo.isSupportPageTrun,jumpPage:m.default.joinRoomInfo.isSupportPageTrun,sendSignallingFromShowPage:!0,sendSignallingFromDynamicPptShowPage:!0,sendSignallingFromH5ShowPage:!0,sendSignallingFromGeneralShowPage:!0,pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,sendSignallingFromSharpsChange:!0,sendSignallingFromRemoteControl:!0}):Object.customAssign(t,{whiteboardPagingPage:m.default.joinRoomInfo.isSupportPageTrun,newpptPagingPage:m.default.joinRoomInfo.isSupportPageTrun,h5DocumentPagingPage:m.default.joinRoomInfo.isSupportPageTrun,jumpPage:m.default.joinRoomInfo.isSupportPageTrun,h5DocumentActionClick:m.default.joinRoomInfo.isSupportPageTrun,dynamicPptActionClick:m.default.joinRoomInfo.isSupportPageTrun,sendSignallingFromShowPage:!0,sendSignallingFromDynamicPptShowPage:!0,sendSignallingFromH5ShowPage:!0,sendSignallingFromGeneralShowPage:!0,pubMsg:!0,delMsg:!0,setProperty:!0,setParticipantPropertyToAll:!0,sendSignallingDataToParticipant:!0,endClassbeginRevertToStartupLayout:m.default.joinRoomInfo.isClassOverNotLeave,sendSignallingFromRemoteControl:!0});break;case m.default.role.rolePlayback:y.default.classBegin,Object.customAssign(t,{pubMsg:!1,delMsg:!1,setProperty:!1,setParticipantPropertyToAll:!1,sendSignallingDataToParticipant:!1});break;case m.default.role.roleAudit:var f=!0,v=!1,b=void 0;try{for(var S,k=(0,o.default)((0,r.default)(t));!(f=(S=k.next()).done);f=!0)t[S.value]=!1}catch(e){v=!0,b=e}finally{try{!f&&k.return&&k.return()}finally{if(v)throw b}}Object.customAssign(t,{pubMsg:!0,sendSignallingDataToParticipant:!0})}return t}},{key:"addEventListenerToRoomHandler",value:function(){}}]),e}()),w=new k;w.addEventListenerToRoomHandler(),t.default=w},Xd32:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("5PlU")},XxZZ:function(e,t,a){a("RkqK"),e.exports=a("FeBl").Math.hypot},YRCL:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("Ovlj"),f=n(g),p=a("yE5a"),v=n(p),b=a("DrPG"),y=(n(b),a("VSuD")),S=(n(y),a("Sa83")),k=n(S),w=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,m.default)(t,e),(0,d.default)(t,[{key:"sendSignallingFromUpdateTime",value:function(e){if(k.default.handler.getAppPermissions("sendSignallingFromUpdateTime")){var t=this,a=e||"__all",n={};t.sendSignallingDataToParticipant(!1,"UpdateTime","UpdateTime",a,n,!0)}}},{key:"sendSignallingFromSharpsChange",value:function(e,t,a,n,i,r,s,o,l){if(k.default.handler.getAppPermissions("sendSignallingFromSharpsChange")){var d=this;e&&(r=!0),d.sendSignallingDataToParticipant(e,t,a,n,i,r,s,o,l)}}},{key:"sendSignallingFromWBPageCount",value:function(e){k.default.handler.getAppPermissions("sendSignallingFromWBPageCount")&&this.sendSignallingDataToParticipant(!1,"WBPageCount","WBPageCount","__allExceptSender",e,void 0)}},{key:"sendSignallingFromShowPage",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"__all";if(k.default.handler.getAppPermissions("sendSignallingFromShowPage")){if(!a)return void L.Logger.error("sendSignallingFromShowPage data is not exist!");a&&"string"==typeof a&&(a=JSON.parse(a)),a.isDynamicPPT&&!k.default.handler.getAppPermissions("sendSignallingFromDynamicPptShowPage")||a.isH5Document&&!k.default.handler.getAppPermissions("sendSignallingFromH5ShowPage")||a.isGeneralFile&&!k.default.handler.getAppPermissions("sendSignallingFromGeneralShowPage")||this.sendSignallingDataToParticipant(e,"ShowPage",t,n,a)}}},{key:"sendSignallingFromRemoteControl",value:function(e,t){if(k.default.handler.getAppPermissions("sendSignallingFromRemoteControl")){var a=e||"__all";this.sendSignallingDataToParticipant(!1,"RemoteControl","RemoteControl",a,t,!0)}}},{key:"sendSignallingFromDynamicPptTriggerActionClick",value:function(e){k.default.handler.getAppPermissions("sendSignallingFromDynamicPptTriggerActionClick")&&this.sendSignallingDataToParticipant(!1,"NewPptTriggerActionClick","NewPptTriggerActionClick","__allExceptSender",e,!1)}},{key:"sendSignallingFromPptVolumeControl",value:function(e){k.default.handler.getAppPermissions("sendSignallingFromPptVolumeControl")&&this.sendSignallingDataToParticipant(!1,"PptVolumeControl","PptVolumeControl","__allExceptSender",e,!1)}},{key:"sendSignallingFromH5DocumentAction",value:function(e){k.default.handler.getAppPermissions("sendSignallingFromH5DocumentAction")&&this.sendSignallingDataToParticipant(!1,"H5DocumentAction","H5DocumentAction","__allExceptSender",e,!1)}},{key:"sendSignallingFromVideoDraghandle",value:function(e,t){if(k.default.handler.getAppPermissions("sendSignallingFromVideoDraghandle")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"videoDraghandle","videoDraghandle",t,e,!1)}}},{key:"sendSignallingFromCaptureImg",value:function(e,t,a){if(k.default.handler.getAppPermissions("isSendSignallingFromCaptureImg")){var n=this;a=a||!1,n.sendSignallingDataToParticipant(a,"CaptureImg",e,"__all",t,!1)}}},{key:"sendSignallingFromCaptureImgDrag",value:function(e,t,a){k.default.handler.getAppPermissions("isSendSignallingFromCaptureImgDrag")&&this.sendSignallingDataToParticipant(!1,"CaptureImgDrag",t,"__allExceptSender",e,!1,void 0,a)}},{key:"sendSignallingFromCaptureImgResize",value:function(e,t,a){k.default.handler.getAppPermissions("isSendCaptureImgResize")&&this.sendSignallingDataToParticipant(!1,"CaptureImgResize",t,"__allExceptSender",e,!1,void 0,a)}},{key:"sendMarkToolMouseIsSelect",value:function(e,t,a){if(k.default.handler.getAppPermissions("sendWhiteboardMarkTool")){var n=this,i={selectMouse:e};t&&(i.selectElementLiId=t),a&&(i.selectElementId=a),n.sendSignallingDataToParticipant(!1,"whiteboardMarkTool","whiteboardMarkTool","__allExceptSender",i)}}},{key:"sendSignallingFromBlackBoard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.default.handler.getAppPermissions("sendSignallingFromBlackBoard")&&this.sendSignallingDataToParticipant(t,"BlackBoard","BlackBoard","__all",e)}},{key:"sendSignallingTimerToStudent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!k.default.handler.getAppPermissions("sendSignallingTimerToStudent"))return!1;this.sendSignallingDataToParticipant(t,"timer","timerMesg","__all",e)}},{key:"sendSignallingFromBlackBoardDrag",value:function(e,t){if(k.default.handler.getAppPermissions("sendSignallingFromBlackBoardDrag")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"BlackBoardDrag","BlackBoardDrag",t,e,!1,void 0,"BlackBoard")}}},{key:"sendSignallingDialToStudent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.default.handler.getAppPermissions("sendSignallingDialToStudent")&&this.sendSignallingDataToParticipant(t,"dial","dialMesg","__all",e)}},{key:"sendSignallingAnswerToStudent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!k.default.handler.getAppPermissions("sendSignallingAnswerToStudent"))return!1;this.sendSignallingDataToParticipant(t,"answer","answerMesg","__all",e)}},{key:"sendSignallingDataStudentToTeacherAnswer",value:function(e,t){if(!k.default.handler.getAppPermissions("sendSignallingDataStudentToTeacherAnswer"))return!1;var a=this,n="submitAnswers_"+v.default.getTkRoom().getMySelf().id;a.sendSignallingDataToParticipant(e,"submitAnswers",n,"__allSuperUsers",t,void 0,void 0,"answerMesg")}},{key:"sendSignallingQiangDaQi",value:function(e,t){if(!k.default.handler.getAppPermissions("sendSignallingQiangDaQi"))return!1;this.sendSignallingDataToParticipant(e,"qiangDaQi","qiangDaQiMesg","__all",t)}},{key:"sendSignallingQiangDaZhe",value:function(e,t){if(!k.default.handler.getAppPermissions("sendSignallingQiangDaZhe"))return!1;var a=this,n="QiangDaZhe_"+v.default.getTkRoom().getMySelf().id;a.sendSignallingDataToParticipant(e,"QiangDaZhe",n,"__all",t,void 0,void 0,"qiangDaQiMesg")}},{key:"sendSignallingFromDialDrag",value:function(e,t){if(k.default.handler.getAppPermissions("sendSignallingFromDialDrag")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"DialDrag","DialDrag",t,e,!1,void 0,"dialMesg")}}},{key:"sendSignallingFromResponderDrag",value:function(e,t){if(k.default.handler.getAppPermissions("isSendSignallingFromResponderDrag")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"ResponderDrag","ResponderDrag",t,e,!1,void 0,"qiangDaQiMesg")}}},{key:"sendSignallingFromTimerDrag",value:function(e,t){if(k.default.handler.getAppPermissions("isSendSignallingFromTimerDrag")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"TimerDrag","TimerDrag",t,e,!1,void 0,"timerMesg")}}},{key:"sendSignallingFromAnswerDrag",value:function(e,t){if(k.default.handler.getAppPermissions("isSendSignallingFromAnswerDrag")){var a=this;t=t||"__allExceptSender",a.sendSignallingDataToParticipant(!1,"AnswerDrag","AnswerDrag",t,e,!1,void 0,"answerMesg")}}}]),t}(f.default),C=new w;t.default=C},Z5jD:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("O27J"),v=(n(p),a("HUPQ")),b=n(v),y=a("VSuD"),S=n(y),k=a("DrPG"),w=(n(k),a("T+56")),C=n(w),T=a("Sa83"),P=n(T),A=a("yE5a"),D=(n(A),a("YRCL")),_=n(D),E=a("EXAz"),I=n(E),x=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.props.id,a.state={hoursDiv:"",secondsDiv:"",number:"",timeDescArray:[0,5,0,0],triangleStyle:"",againBtnStyle:"",startBtnStyle:"",numContentBorder:"",timerTeachToolWrapDisplay:"none",timerStuStyle:"",restarting:!1,studentInit:!1,startAndStop:!1,startAndStopImg:"none",isShow:!1,againUnClickableStyle:"block",resizeInfo:{width:0,height:0},servicerTimes:""},a.isSetDefaultPosition=!1,a.stop=null,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this;C.default.CoreController.addEventListener("handleTurnShow",e.handleTurnShow.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener("receive-msglist-timer",e.handlerMsglistTimerShow.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),C.default.CoreController.addEventListener(S.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;C.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){if(t.timerTeachToolWrapDisplay!==this.state.timerTeachToolWrapDisplay&&"block"===this.state.timerTeachToolWrapDisplay){var a=this.props.id,n=document.getElementById(a);if(n){var i=b.default.windowInnerWidth/S.default.STANDARDSIZE;this.state.resizeInfo.width=n.offsetWidth/i,this.state.resizeInfo.height=n.offsetHeight/i}this.isSetDefaultPosition&&(this.isSetDefaultPosition=!1,this.setDefaultPosition())}}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!0)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"timer":(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant||S.default.hasRole.rolePatrol||b.default.playback)&&t.handleTimerShow(a);break;case"UpdateTime":t.state.servicerTimes=a.ts,t.setState({servicerTimes:t.state.servicerTimes})}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"ClassBegin":t.setState({timerTeachToolWrapDisplay:"none"});break;case"timer":clearInterval(t.stop),t.state.startAndStopImg="none",t.state.timeDescArray=[0,5,0,0],t.setState({timerTeachToolWrapDisplay:"none",startAndStopImg:t.state.startAndStopImg,timeDescArray:t.state.timeDescArray})}}},{key:"handlerMsglistTimerShow",value:function(e){var t=this,a=e.message.timerShowArr[0];(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant||S.default.hasRole.rolePatrol||b.default.playback)&&t.handleTimerShow(a)}},{key:"handleTimerShow",value:function(e){var t=this;t.state.timeDescArray=e.data.sutdentTimerArry;var a=((new Date).getTime()/1e3).toFixed(0)-e.ts,n=600*t.state.timeDescArray[0]+60*t.state.timeDescArray[1]+10*t.state.timeDescArray[2]+1*t.state.timeDescArray[3];setTimeout(function(){if(e.data.isShow)t.state.startBtnStyle="block",t.state.againBtnStyle="none",t.state.numContentBorder="black",t.state.againUnClickableStyle="block",t.state.startAndStopImg="none",t.state.triangleStyle="visible",t.setState({timeDescArray:t.state.timeDescArray,timerTeachToolWrapDisplay:"block",againUnClickableStyle:t.state.againUnClickableStyle,startBtnStyle:t.state.startBtnStyle,startAndStopImg:t.state.startAndStopImg});else if(e.data.isStatus)if(clearInterval(t.stop),t.state.againBtnStyle="block",t.state.startBtnStyle="none",t.state.againUnClickableStyle="none",t.state.numContentBorder="black",t.state.triangleStyle="hidden",t.state.startAndStopImg="block",t.setState({startAndStopImg:t.state.startAndStopImg,timerTeachToolWrapDisplay:"block",startBtnStyle:t.state.startBtnStyle,numContentBorder:t.state.numContentBorder,againBtnStyle:t.state.againBtnStyle,triangleStyle:t.state.triangleStyle,againUnClickableStyle:t.state.againUnClickableStyle}),t.state.servicerTimes<e.ts)t.stop=setInterval(function(){var i=((new Date).getTime()/1e3).toFixed(0)-a,r=n-(i-e.ts);if(r>0){r>n&&(r=n);var s=parseInt(r/60)<10?"0"+parseInt(r/60):parseInt(r/60),o=parseInt(r%60)<10?"0"+parseInt(r%60):parseInt(r%60);t.state.timeDescArray[0]=parseInt(s/10),t.state.timeDescArray[1]=parseInt(s%10),t.state.timeDescArray[2]=parseInt(o/10),t.state.timeDescArray[3]=parseInt(o%10),t.setState({timeDescArray:t.state.timeDescArray})}else clearInterval(t.stop),t.playAudioToAudiooutput(),t.state.timeDescArray[0]=0,t.state.timeDescArray[1]=0,t.state.timeDescArray[2]=0,t.state.timeDescArray[3]=0,t.state.numContentBorder="red",t.state.startAndStopImg="block",t.setState({timeDescArray:t.state.timeDescArray,numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg})},1e3);else{var i=t.state.servicerTimes-e.ts;t.stop=setInterval(function(){var r=((new Date).getTime()/1e3).toFixed(0)-a,s=n-i-(r-e.ts)-3;if(s>0){s>n&&(s=n);var o=parseInt(s/60)<10?"0"+parseInt(s/60):parseInt(s/60),l=parseInt(s%60)<10?"0"+parseInt(s%60):parseInt(s%60);t.state.timeDescArray[0]=parseInt(o/10),t.state.timeDescArray[1]=parseInt(o%10),t.state.timeDescArray[2]=parseInt(l/10),t.state.timeDescArray[3]=parseInt(l%10),t.setState({timeDescArray:t.state.timeDescArray})}else clearInterval(t.stop),t.playAudioToAudiooutput(),t.state.timeDescArray[0]=0,t.state.timeDescArray[1]=0,t.state.timeDescArray[2]=0,t.state.timeDescArray[3]=0,t.state.numContentBorder="red",t.state.startAndStopImg="block",t.setState({timeDescArray:t.state.timeDescArray,numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg})},1e3)}else e.data.isRestart?(clearInterval(t.stop),t.state.timeDescArray=e.data.sutdentTimerArry,t.state.againUnClickableStyle="block",t.state.startBtnStyle="block",t.state.againBtnStyle="none",t.state.triangleStyle="visible",t.state.startAndStop=!1,t.state.numContentBorder="black",t.state.startAndStopImg="none",t.setState({timeDescArray:t.state.timeDescArray,timerTeachToolWrapDisplay:"block",numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg,startBtnStyle:t.state.startBtnStyle,againBtnStyle:t.state.againBtnStyle,triangleStyle:t.state.triangleStyle,startAndStop:t.state.startAndStop,againUnClickableStyle:t.state.againUnClickableStyle})):(t.state.timeDescArray=e.data.sutdentTimerArry,t.state.startBtnStyle="block",t.state.againBtnStyle="block",t.state.againUnClickableStyle="none",t.state.triangleStyle="hidden",t.state.startAndStop=!1,t.state.numContentBorder="black",t.state.startAndStopImg="none",t.setState({timeDescArray:t.state.timeDescArray,timerTeachToolWrapDisplay:"block",numContentBorder:t.state.numContentBorder,startAndStopImg:t.state.startAndStopImg,startBtnStyle:t.state.startBtnStyle,againBtnStyle:t.state.againBtnStyle,triangleStyle:t.state.triangleStyle,startAndStop:t.state.startAndStop,againUnClickableStyle:t.state.againUnClickableStyle}),clearInterval(t.stop))},10)}},{key:"handleTurnShow",value:function(e){var t=this;"timer-implement-bg"==e.className&&"none"==t.state.timerTeachToolWrapDisplay&&(t.state.startBtnStyle="block",t.state.againBtnStyle="none",t.state.startAndStopImg="none",t.state.triangleStyle="visible",t.state.againUnClickableStyle="block",t.state.startAndStop=!1,t.state.numContentBorder="black",clearInterval(t.stop),t.state.timeDescArray=[0,5,0,0],this.isSetDefaultPosition=!0,t.setState({timerTeachToolWrapDisplay:"block",startAndStop:t.state.startAndStop,startBtnStyle:t.state.startBtnStyle,againBtnStyle:t.state.againBtnStyle,triangleStyle:t.state.triangleStyle,numContentBorder:t.state.numContentBorder,timeDescArray:t.state.timeDescArray,againUnClickableStyle:t.state.againUnClickableStyle,startAndStopImg:t.state.startAndStopImg}))}},{key:"handlerInitAppPermissions",value:function(){this.state.studentInit=P.default.handler.getAppPermissions("studentInit"),this.setState({studentInit:this.state.studentInit}),this.state.studentInit&&(this.state.triangleStyle="visible",this.state.againBtnStyle="none",this.state.againUnClickableStyle="block",this.state.startBtnStyle="block",this.state.startAndStopImg="none",this.setState({triangleStyle:this.state.triangleStyles,againStuBtnStyle:this.state.againStuBtnStyle,startStuBtnStyle:this.state.startStuBtnStyle,startAndStopImg:this.state.startAndStopImg,againUnClickableStyle:this.state.againUnClickableStyle}))}},{key:"handlerRoomPlaybackClearAll",value:function(){if(!b.default.playback)return void L.Logger.error("No playback environment, no execution event[roomPlaybackClearAll] handler ");this.setState({hoursDiv:"",secondsDiv:"",number:"",timeDescArray:[0,5,0,0],triangleStyle:"",againBtnStyle:"",startBtnStyle:"",numContentBorder:"",timerTeachToolWrapDisplay:"none",timerStuStyle:"",restarting:!1,studentInit:!1,startAndStop:!1,startAndStopImg:"none",isShow:!1,againUnClickableStyle:"block"}),this.stop=null}},{key:"_loadTimeDescArray",value:function(e){var t=this,a=[],n=[];return e.forEach(function(e,i){var r=f.default.createElement("div",{className:"timer-teachTool-num-div",key:i},f.default.createElement("div",{className:"timer-teachTool-triangle-top",style:{visibility:t.state.triangleStyle},onClick:t.AddHandel.bind(t,i)}),f.default.createElement("div",{className:"timer-teachTool-num-content",style:{color:t.state.numContentBorder}},e),f.default.createElement("div",{className:"timer-teachTool-triangle-down",style:{visibility:t.state.triangleStyle},onClick:t.ReduceHandel.bind(t,i)}));i>1?n.push(r):a.push(r)}),{afterArray:n,beforeArray:a}}},{key:"AddHandel",value:function(e,t){(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant)&&(0===e&&(t.target.nextSibling.textContent++,this.state.timeDescArray[0]=t.target.nextSibling.textContent,t.target.nextSibling.textContent>9&&(t.target.nextSibling.textContent=0,this.state.timeDescArray[0]=t.target.nextSibling.textContent)),1===e&&(t.target.nextSibling.textContent++,this.state.timeDescArray[1]=t.target.nextSibling.textContent,t.target.nextSibling.textContent>9&&(t.target.nextSibling.textContent=0,this.state.timeDescArray[1]=t.target.nextSibling.textContent)),2===e&&(t.target.nextSibling.textContent++,this.state.timeDescArray[2]=t.target.nextSibling.textContent,t.target.nextSibling.textContent>5&&(t.target.nextSibling.textContent=0,this.state.timeDescArray[2]=t.target.nextSibling.textContent)),3===e&&(t.target.nextSibling.textContent++,this.state.timeDescArray[3]=t.target.nextSibling.textContent,t.target.nextSibling.textContent>9&&(t.target.nextSibling.textContent=0,this.state.timeDescArray[3]=t.target.nextSibling.textContent=0)),this.setState({timeDescArray:this.state.timeDescArray}))}},{key:"ReduceHandel",value:function(e,t){(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant)&&(0===e&&(t.target.previousSibling.textContent--,this.state.timeDescArray[0]=t.target.previousSibling.textContent,t.target.previousSibling.textContent<0&&(t.target.previousSibling.textContent=9,this.state.timeDescArray[0]=t.target.previousSibling.textContent)),1===e&&(t.target.previousSibling.textContent--,this.state.timeDescArray[1]=t.target.previousSibling.textContent,t.target.previousSibling.textContent<0&&(t.target.previousSibling.textContent=9,this.state.timeDescArray[1]=t.target.previousSibling.textContent)),2===e&&(t.target.previousSibling.textContent--,this.state.timeDescArray[2]=t.target.previousSibling.textContent,t.target.previousSibling.textContent<0&&(t.target.previousSibling.textContent=5,this.state.timeDescArray[2]=t.target.previousSibling.textContent)),3===e&&(t.target.previousSibling.textContent--,this.state.timeDescArray[3]=t.target.previousSibling.textContent,t.target.previousSibling.textContent<0&&(t.target.previousSibling.textContent=9,this.state.timeDescArray[3]=t.target.previousSibling.textContent)),this.setState({timeDescArray:this.state.timeDescArray}))}},{key:"startBtnHandel",value:function(e){if(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant){clearInterval(this.stop),this.state.numContentBorder="black",this.state.startAndStop=!0,this.state.restarting=!1,this.setState({startAndStop:this.state.startAndStop,numContentBorder:this.state.numContentBorder,restarting:this.state.restarting}),this.state.startBtnStyle="none",this.state.startAndStopImg="block",this.state.triangleStyle="hidden",this.state.againBtnStyle="block",this.state.againUnClickableStyle="none",this.setState({startAndStopImg:this.state.startAndStopImg,startBtnStyle:this.state.startBtnStyle,againBtnStyle:this.state.againBtnStyle,triangleStyle:this.state.triangleStyle,againUnClickableStyle:this.state.againUnClickableStyle}),0===this.state.timeDescArray[0]&&0===this.state.timeDescArray[1]&&0===this.state.timeDescArray[2]&&0===this.state.timeDescArray[3]&&(this.state.timeDescArray=[0,0,0,0],this.state.numContentBorder="red",clearInterval(this.stop));var t=this.state.startAndStop,a=this.state.timeDescArray,n=this.state.isShow,i=this.state.restarting,r={isStatus:t,sutdentTimerArry:a,isShow:n,isRestart:i};_.default.sendSignallingTimerToStudent(r)}}},{key:"stopBtnHandel",value:function(){if(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant){this.state.startAndStop=!1,this.state.restarting=!1,this.state.startAndStopImg="none",this.state.triangleStyle="hidden",this.state.startBtnStyle="block",this.state.againUnClickableStyle="none",this.state.againBtnStyle="block",this.setState({startAndStopImg:this.state.startAndStopImg,startBtnStyle:this.state.startBtnStyle,againBtnStyle:this.state.againBtnStyle,startAndStop:this.state.startAndStop,triangleStyle:this.state.triangleStyle,againUnClickableStyle:this.state.againUnClickableStyle}),clearInterval(this.stop);var e=this.state.startAndStop,t=this.state.isShow,a=this.state.timeDescArray,n=this.state.restarting,i={isStatus:e,sutdentTimerArry:a,isShow:t,isRestart:n};_.default.sendSignallingTimerToStudent(i)}}},{key:"firstArr",value:function(){var e=this;this.handlersetAnswerMessage(recvEventData),this.state.optionUl=this.state.initArr.map(function(t,a){return f.default.createElement("li",{className:"answer-teach-lis",key:t.id,onClick:e.changeColor.bind(e,a)},t.name)}),this.setState({optionUl:this.state.optionUl})}},{key:"againBtnHandel",value:function(e){if(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant){this.state.numContentBorder="black",this.setState({numContentBorder:this.state.numContentBorder}),this.state.restarting=!0,this.state.startAndStop=!1,this.state.triangleStyle="visible",this.state.againBtnStyle="none",this.state.startAndStopImg="none",this.state.startBtnStyle="block",this.state.againUnClickableStyle="block",clearInterval(this.stop),this.state.numContentBorder="black",this.state.timeDescArray=[0,5,0,0],this.setState({triangleStyle:this.state.triangleStyle,againBtnStyle:this.state.againBtnStyle,startBtnStyle:this.state.startBtnStyle,timeDescArray:this.state.timeDescArray,startAndStopImg:this.state.startAndStopImg,startAndStop:this.state.startAndStop,restarting:this.state.restarting,numContentBorder:this.state.numContentBorder,againUnClickableStyle:this.state.againUnClickableStyle});var t=this.state.startAndStop,a=this.state.timeDescArray,n=this.state.isShow,i=this.state.restarting,r={isStatus:t,sutdentTimerArry:a,isShow:n,isRestart:i};_.default.sendSignallingTimerToStudent(r)}}},{key:"timerCloseHandel",value:function(){if(S.default.hasRole.roleChairman||S.default.hasRole.roleTeachingAssistant){this.state.timeDescArray=[0,5,0,0],this.state.triangleStyle="visible",this.state.startAndStop=!1,this.state.againBtnStyle="none",this.state.startAndStopImg="none",this.state.numContentBorder="black",this.state.againUnClickableStyle="block",clearInterval(this.stop),this.setState({timeDescArray:this.state.timeDescArray,triangleStyle:this.state.triangleStyle,startAndStop:this.state.startAndStop,numContentBorder:this.state.numContentBorder,startAndStopImg:this.state.startAndStopImg,againBtnStyle:this.state.againBtnStyle,againUnClickableStyle:this.state.againUnClickableStyle,timerTeachToolWrapDisplay:"none"});var e=this.state.startAndStop,t=this.state.isShow,a=this.state.timeDescArray,n={isStatus:e,sutdentTimerArry:a,isShow:t};_.default.sendSignallingTimerToStudent(n,!0)}}},{key:"playAudioToAudiooutput",value:function(){var e=document.getElementById("ring_audio");L.Utils.mediaPlay(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.timeDescArray,n=t.resizeInfo,i=this._loadTimeDescArray(a),r=i.afterArray,s=i.beforeArray,o=e.props,l=o.id,d=o.draggableData,u=o.timerDrag,c=Object.customAssign({id:l,size:n,percentPosition:{percentLeft:u.percentLeft,percentTop:u.percentTop}},d);return f.default.createElement(I.default,c,f.default.createElement("div",{id:l,className:"timer-teachTool-wrap touch-select-select ",style:{display:this.state.timerTeachToolWrapDisplay},ref:"timerTeachToolWrap"},f.default.createElement("div",{className:"timer-teachTool-header"},f.default.createElement("span",null),f.default.createElement("span",null,b.default.language.languageData.timers.timerSetInterval.text),f.default.createElement("span",{className:"timer-teachTool-closeSpan",onClick:this.timerCloseHandel.bind(this)})),s,f.default.createElement("div",{className:"timer-teachTool-colon"},f.default.createElement("div",null),f.default.createElement("div",null)),r,f.default.createElement("div",{className:"timer-teachTool-startBtn",ref:"timerStartBtn",style:{display:this.state.startBtnStyle},onClick:this.startBtnHandel.bind(this),title:b.default.language.languageData.timers.timerBegin.text}),f.default.createElement("div",{className:"timer-teachTool-stopBtn",style:{display:this.state.startAndStopImg},onClick:this.stopBtnHandel.bind(this),title:b.default.language.languageData.timers.timerStop.text}),f.default.createElement("div",{className:"timer-teachTool-againBtn",style:{display:this.state.againBtnStyle},onClick:this.againBtnHandel.bind(this),title:b.default.language.languageData.timers.again.text}),f.default.createElement("div",{className:"timer-teachTool-againBtn-unclickable",style:{display:this.state.againUnClickableStyle},title:b.default.language.languageData.timers.again.text}),f.default.createElement("audio",{id:"ring_audio",src:"./music/ring.mp3?ts="+this.listernerBackupid,className:"audio-play"})))}}]),t}(f.default.Component);t.default=x},ZZXC:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("DrPG"),r=n(i),s=a("HUPQ"),o=n(s),l=a("VSuD"),d=(n(l),a("yE5a")),u=(n(d),a("T+56")),c=(n(u),a("YRCL")),h=(n(c),{getAppLanguageInfo:function(e,t){var n=t||o.default.languageName,i={};o.default.language=o.default.language||{},i.name=n,i.languageData=a("KyAL")("./i18_"+n+".js").default,e&&"function"==typeof e&&e(i),document.body.className=document.body.className.replace(/(chinese|english|complex)/g,"")+" "+i.name,document.body.setAttribute("data-language",i.name)},TkUtils:r.default});t.default=h},Zx67:function(e,t,a){e.exports={default:a("fS6E"),__esModule:!0}},adC7:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("HUPQ"),r=n(i),s=a("T+56"),o=n(s),l={showAlert:function(e,t){o.default.CoreController.dispatchEvent({type:"showAlert",message:{data:{title:e.title,message:e.message,ok:e.ok,callback:function(e){t&&"function"==typeof t&&t(e)}}}})},showConfirm:function(e,t){o.default.CoreController.dispatchEvent({type:"showConfirm",message:{data:{title:e.title,message:e.message,isOk:{cancel:e.button.cancel,ok:e.button.ok},callback:function(e){t&&"function"==typeof t&&t(e)}}}})}},d={showError:function(e,t,a,n){var i={message:e,title:a||r.default.language.languageData.alertWin.title.showError.text,ok:n||r.default.language.languageData.alertWin.ok.showError.text};l.showAlert(i,t)},showPrompt:function(e,t,a,n){var i={message:e,title:a||r.default.language.languageData.alertWin.title.showPrompt.text,ok:n||r.default.language.languageData.alertWin.ok.showPrompt.text};l.showAlert(i,t)},showConfirm:function(e,t,a,n,i){var s={title:a||r.default.language.languageData.alertWin.title.showConfirm.text,button:{cancel:i||r.default.language.languageData.alertWin.ok.showConfirm.cancel,ok:n||r.default.language.languageData.alertWin.ok.showConfirm.ok},message:e};l.showConfirm(s,t)}};t.default=d},bMTV:function(e,t){},bRrM:function(e,t,a){"use strict";var n=a("7KvD"),i=a("FeBl"),r=a("evD5"),s=a("+E39"),o=a("dSzd")("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];s&&t&&!t[o]&&r.f(t,o,{configurable:!0,get:function(){return this}})}},buLY:function(e,t,a){"use strict";var n={error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)},log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,e)},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)},trace:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.trace.apply(console,e)},debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.debug.apply(console,e)}};window.Log=n},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},d7EF:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=a("us/S"),r=n(i),s=a("BO1k"),o=n(s);t.default=function(){function e(e,t){var a=[],n=!0,i=!1,r=void 0;try{for(var s,l=(0,o.default)(e);!(n=(s=l.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){i=!0,r=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw r}}return a}return function(t,a){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},dY0y:function(e,t,a){var n=a("dSzd")("iterator"),i=!1;try{var r=[7][n]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var a=!1;try{var r=[7],s=r[n]();s.next=function(){return{done:a=!0}},r[n]=function(){return s},e(r)}catch(e){}return a}},eLkf:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("T+56"),v=n(p),b=a("DrPG"),y=(n(b),a("HUPQ")),S=n(y),k=a("Sa83"),w=n(k),C=a("EXAz"),T=n(C),P=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.state={isShowRemarksBox:!1,remarksInfo:""},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this;v.default.CoreController.addEventListener("handleHasRemarks",e.handleHasRemarks.bind(e),e.listernerBackupid),v.default.CoreController.addEventListener("handleIsShowRemarksBox",e.handleIsShowRemarksBox.bind(e),e.listernerBackupid),v.default.CoreController.addEventListener("renderRemarks",e.renderRemarks.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;v.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){t.isShowRemarksBox!==this.state.isShowRemarksBox&&this.state.isShowRemarksBox&&this.setDefaultPosition()}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=S.default.windowInnerWidth/TkConstant.STANDARDSIZE,s=document.querySelector("#page_wrap"),o=s?s.offsetWidth:0,l=(i.offsetWidth-n.offsetWidth)/2+(o/2-.4*r),d=i.offsetHeight-n.offsetHeight-.9*r,u=l/(i.offsetWidth-n.offsetWidth),c=d/(i.offsetHeight-n.offsetHeight);u=isNaN(u)||null===u||u<0?0:u,c=isNaN(c)||null===c||c<0?0:c,a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:l,top:d,percentLeft:u,percentTop:c,isDrag:!1},!1)}}},{key:"handleHasRemarks",value:function(e){var t=e.message.data.hasRemarks,a=[];e.message.data.remarksInfo&&e.message.data.remarksInfo.split("\n").map(function(e,t){e&&""!==e&&a.push(f.default.createElement("p",{key:t},e))}),this.setState({isShowRemarksBox:t,remarksInfo:a})}},{key:"remarksCloseClick",value:function(){this.setState({isShowRemarksBox:!1})}},{key:"handleIsShowRemarksBox",value:function(e){var t=e.message.data.isShowRemarksBox;this.setState({isShowRemarksBox:t})}},{key:"renderRemarks",value:function(){this.setState({isShowRemarksBox:this.state.isShowRemarksBox})}},{key:"render",value:function(){var e=this,t=e.props,a=t.id,n=t.coursewareRemarks,i=t.draggableData,r={display:e.state.isShowRemarksBox&&w.default.handler.getAppPermissions("isShowCoursewareRemarks")?"block":"none",position:"absolute",left:0,top:0},s=Object.customAssign({id:a,percentPosition:{percentLeft:n.percentLeft,percentTop:n.percentTop}},i);return f.default.createElement(T.default,s,f.default.createElement("div",{id:a,className:"courseware-remarks-box",style:r},f.default.createElement("div",{className:"remarks-title"},f.default.createElement("p",{className:"remarks-title-text"},S.default.language.languageData.coursewareRemarks.remarks),f.default.createElement("button",{className:"remarks-close",onClick:e.remarksCloseClick.bind(e),title:S.default.language.languageData.coursewareRemarks.close})),f.default.createElement("div",{className:"remarks-content"},e.state.remarksInfo)))}}]),t}(f.default.Component);t.default=P},eldM:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("W3Iv"),r=n(i),s=a("BO1k"),o=n(s),l=a("d7EF"),d=n(l),u=a("Zx67"),c=n(u),h=a("Zrlr"),m=n(h),g=a("wxAW"),f=n(g),p=a("zwoO"),v=n(p),b=a("Pf15"),y=n(b),S=a("GiK3"),k=n(S),w=a("vDoF"),C=n(w),T=a("hDMf"),P=n(T),A=a("T+56"),D=n(A),_=a("Geq7"),E=n(_),I=function(e){function t(e){(0,m.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return a.state={fileTypeMark:"general",literallyWrapClass:"",literallyWrapStyle:{}},a.fatherContainerId="white_board_outer_layout",a.whiteboardContainerId="big_literally_wrap",a}return(0,y.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"changeFileTypeMark",value:function(e){this.state.fileTypeMark!==e&&(D.default.CoreController.dispatchEvent({type:"changeFileTypeMark",message:{fileTypeMark:e}}),this.setState({fileTypeMark:e}))}},{key:"resizeWhiteboardSizeCallback",value:function(e){e&&void 0!==e.addClassName&&(this.state.literallyWrapClass=e.addClassName,delete e.addClassName);var t=$("#"+this.whiteboardContainerId),a=!1,n=!1,i=!0,s=!1,l=void 0;try{for(var u,c=(0,o.default)((0,r.default)(e));!(i=(u=c.next()).done);i=!0){var h=u.value,m=(0,d.default)(h,2),g=m[0],f=m[1];"marginTop"!==g||0===Number(f.replace(/(px|%)/g,""))?"marginLeft"!==g||0===Number(f.replace(/(px|%)/g,""))?("width"!==g&&"height"!==g||(this.state.literallyWrapStyle[g]=f),t[0].style[g]=f):n=!0:a=!0}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}if(a){var p=t.height();t.css({"margin-top":-p/2+"px"})}if(n){var v=t.width();t.css({"margin-left":-v/2+"px"})}this.setState({literallyWrapClass:this.state.literallyWrapClass,literallyWrapStyle:this.state.literallyWrapStyle})}},{key:"render",value:function(){var e=this;return k.default.createElement("div",{id:e.fatherContainerId,className:"white-board-outer-layout"},"  ",k.default.createElement("div",{id:e.whiteboardContainerId,className:"big-literally-wrap "+this.state.literallyWrapClass}," ",k.default.createElement(C.default,{instanceId:"default",resizeWhiteboardSizeCallback:e.resizeWhiteboardSizeCallback.bind(e),fatherContainerId:e.fatherContainerId,fileTypeMark:e.state.fileTypeMark,changeFileTypeMark:e.changeFileTypeMark.bind(e)}),k.default.createElement(P.default,{styleJson:this.state.literallyWrapStyle,fileTypeMark:e.state.fileTypeMark,changeFileTypeMark:e.changeFileTypeMark.bind(e)}),k.default.createElement(E.default,{styleJson:this.state.literallyWrapStyle,fileTypeMark:e.state.fileTypeMark,changeFileTypeMark:e.changeFileTypeMark.bind(e)})))}}]),t}(k.default.Component);t.default=I},fBQ2:function(e,t,a){"use strict";var n=a("evD5"),i=a("X8DO");e.exports=function(e,t,a){t in e?n.f(e,t,i(0,a)):e[t]=a}},fS6E:function(e,t,a){a("Kh5d"),e.exports=a("FeBl").Object.getPrototypeOf},fZOM:function(e,t,a){var n=a("kM2E"),i=a("mbce")(!1);n(n.S,"Object",{values:function(e){return i(e)}})},fZjL:function(e,t,a){e.exports={default:a("jFbC"),__esModule:!0}},fxRn:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("g8Ux")},g4PW:function(e,t,a){e.exports={default:a("4O1h"),__esModule:!0}},g8Ux:function(e,t,a){var n=a("77Pl"),i=a("3fs2");e.exports=a("FeBl").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},gDty:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=a("woOf"),r=n(i),s=a("pFYg"),o=n(s),l=function(e){return"object"===(void 0===e?"undefined":(0,o.default)(e))&&"[object object]"===Object.prototype.toString.call(e).toLowerCase()&&!e.length};if(!(Object&&Object.shallowAssign&&Object&&Object.customAssign)){var d=function(e){try{return r.default.apply(r.default,arguments)}catch(r){for(var t=e,a=1;a<arguments.length;a++){var n=arguments[a];if(n&&"object"===(void 0===n?"undefined":(0,o.default)(n)))for(var i in n)t[i]=n[i]}return e}};Object&&Object.shallowAssign||(Object.shallowAssign=d),Object&&Object.customAssign||(Object.customAssign=d)}Object&&Object.deepAssign||(Object.deepAssign=function(e){for(var t=e,a=1;a<arguments.length;a++){var n=arguments[a];if(n&&"object"===(void 0===n?"undefined":(0,o.default)(n)))for(var i in n)void 0===t[i]?"object"===(0,o.default)(n[i])&&(Array.isArray(n[i])||l(n[i]))?t[i]=Object.deepAssign(Array.isArray(n[i])?[]:{},n[i]):t[i]=n[i]:"object"===(0,o.default)(n[i])&&(Array.isArray(n[i])||l(n[i]))?t[i]=Object.deepAssign(Array.isArray(n[i])?[]:{},"object"===(0,o.default)(t[i])?t[i]:Array.isArray(n[i])?[]:{},n[i]):t[i]=n[i]}return e})},gRE1:function(e,t,a){e.exports={default:a("TmV0"),__esModule:!0}},gSvA:function(e,t,a){var n=a("kM2E"),i=a("mbce")(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},hDMf:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),r=n(i),s=a("+6Bu"),o=n(s),l=a("BO1k"),d=n(l),u=a("pFYg"),c=n(u),h=a("Zx67"),m=n(h),g=a("Zrlr"),f=n(g),p=a("wxAW"),v=n(p),b=a("zwoO"),y=n(b),S=a("Pf15"),k=n(S),w=a("GiK3"),C=n(w),T=a("T+56"),P=n(T),A=a("DrPG"),D=n(A),_=a("HUPQ"),E=n(_),I=a("VSuD"),x=n(I),B=a("Sa83"),R=n(B),N=a("yE5a"),W=n(N),M=a("ZZXC"),F=n(M),O=a("YRCL"),H=n(O),U=a("L2Bt"),z=n(U),j=function(e){function t(e){(0,f.default)(this,t);var a=(0,y.default)(this,(t.__proto__||(0,m.default)(t)).call(this,e));return a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.fileid=void 0,a.pptvideoStream=void 0,a.state={dynamicPptLoading:!1,updateState:!1,volumeValue:1},a.dynamicPptFileSrc="",a.forceReloadNumber=0,a.changeDocLineReloadNumber=0,a.maxForceReloadNumber=10,a.dynamicPptIsOnload=!1,a.newPptActionJson={},a.awaitHandleActionArray=[],a.dynamicPptOpen=!1,a}return(0,k.default)(t,e),(0,v.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;t._lcInit(),P.default.Window.addEventListener(x.default.EVENTTYPE.WindowEvent.onMessage,t.handlerOnMessage.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomPubmsg,t.handlerRoomPubmsg.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomDelmsg,t.handlerRoomDelmsg.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.streamAdded_media,t.handlerStreamAdded_media.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("mobileSdk_closeDynamicPptWebPlay",t.handlerMobileSdk_closeDynamicPptWebPlay.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("mobileSdk_changeDynamicPptSize",t.handlermobileSdk_changeDynamicPptSize.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-ShowPage-lastDocument",t.handlerReceiveMsglistShowPageLastDocument.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("setNewPptFrameSrc",t.handlerSetNewPptFrameSrc.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("updateAppPermissions_newpptPagingPage",t.handlerUpdateAppPermissions_newpptPagingPage.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("updateAppPermissions_publishDynamicPptMediaPermission_video",t.handlerUpdateAppPermissions_publishDynamicPptMediaPermission_video.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("updateAppPermissions_dynamicPptActionClick",t.handlerUpdateAppPermissions_dynamicPptActionClick.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("initAppPermissions",t.handlerInitAppPermissions.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("openDocuemntOrMediaFile",t.handlerOpenDocuemntOrMediaFile.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("newpptPrevStepClick",t.handlerNewpptPrevStepClick.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("newpptNextStepClick",t.handlerNewpptNextStepClick.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("newpptPrevSlideClick",t.handlerNewpptPrevSlideClick.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("newpptNextSlideClick",t.handlerNewpptNextSlideClick.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-ClassBegin",t.handlerReceiveMsglistClassBegin.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("playDynamicPPTMediaStream",t.handlerPlayDynamicPPTMediaStream.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("skipPage_dynamicPPT",t.handlerSkipPage_dynamicPPT.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("playbackControl_play_pause",t.handlerPlaybackControl_play_pause.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("volumeChangeDispatch",t.volumeChangeDispatch.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-PptVolumeControl",t.handlerReceiveMsglistPptVolumeControl.bind(t),t.listernerBackupid),P.default.CoreController.addEventListener("changeLine",t.handlerChangeLine.bind(t),t.listernerBackupid),$(document).off("sendPPTMessageEvent"),$(document).on("sendPPTMessageEvent",function(e,a,n){t._handlerSendPPTMessageEvent(a,n)}),$(document).off("updateSlidesCountToLcElement"),$(document).on("updateSlidesCountToLcElement",function(e,t){if(t){var a=function(e){Object.customAssign(e,t),P.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}})};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:a}})}}),$(document).off("slideChangeToLcData"),$(document).on("slideChangeToLcData",function(e,t){if(t){P.default.CoreController.dispatchEvent({type:"saveLcStackToStorage",message:{}});var a=function(e){Object.customAssign(e,t),P.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),P.default.CoreController.dispatchEvent({type:"recoverCurrpageLcData"})};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:a}})}}),$(document).off("updateLcScaleWhenAynicPPTInit"),$(document).on("updateLcScaleWhenAynicPPTInit",function(e,a){a&&a.Width&&a.Height&&t._updateLcScaleWhenAynicPPTInitHandler(a.Width/a.Height)}),$(document).off("updateLcScale"),$(document).on("updateLcScale",function(e,t){P.default.CoreController.dispatchEvent({type:"resizeHandler",message:{eleWHPercent:t}})}),$(document).off("newppt_changeFileElementProperty"),$(document).on("newppt_changeFileElementProperty",function(e,t){var a=function(e){Object.customAssign(e,t),P.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),P.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"newppt",data:e}})};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:a}})}),document.getElementById("newppt_frame").onload=function(){return clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.dynamicPptFileSrc&&!e.dynamicPptIsOnload&&e.forceReloadNumber<e.maxForceReloadNumber&&e._setReloadIframeTimeout("awitIframeNoticeLoadFinish"),!1}}},{key:"componentWillUnmount",value:function(){var e=this;P.default.CoreController.removeBackupListerner(e.listernerBackupid),P.default.Window.removeBackupListerner(e.listernerBackupid),$(document).off("sendPPTMessageEvent"),$(document).off("slideChangeToLcData"),$(document).off("updateSlidesCountToLcElement"),$(document).off("updateLcScaleWhenAynicPPTInit"),$(document).off("updateLcScale"),$(document).off("newppt_changeFileElementProperty")}},{key:"handlerChangeLine",value:function(){if("dynamicPPT"===this.props.fileTypeMark){var e=x.default.newpptVersions,t=x.default.remoteNewpptUpdateTime,a=void 0,n=function(e){a=e};if(P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:n}}),a){var i=a,r=i.fileid,s=i.swfpath,o=i.pptslide,l=i.pptstep,d={rPathAddress:s+"/",PresAddress:"newppt.html?versions="+e+"&fileid="+r+"&playback="+E.default.playback+"&classbegin="+E.default.classBegin+"&publishDynamicPptMediaPermission_video="+R.default.handler.getAppPermissions("publishDynamicPptMediaPermission_video")+"&remoteNewpptUpdateTime="+t+"&role="+(x.default.joinRoomInfo?x.default.joinRoomInfo.roomrole:void 0)+"&dynamicPptActionClick="+R.default.handler.getAppPermissions("dynamicPptActionClick")+"&newpptPagingPage="+R.default.handler.getAppPermissions("newpptPagingPage")+"&dynamicPptDebug="+x.default.DEV+"&PptVolumeValue="+this.state.volumeValue+"&PptVolumeMute="+this.state.zhikeTeachingAssistantMute+"&ts="+(new Date).getTime(),slideIndex:o,stepIndex:l,fileid:r};this.ServiceNewPptAynamicPPT.setRPathAndPres(d)}this.changeDocLineReloadNumber++,this.setState({updateState:!this.state.updateState})}}},{key:"_setReloadIframeTimeout",value:function(e){var t=this;clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=null,this.dynamicPptFileSrc&&!this.dynamicPptIsOnload&&this.forceReloadNumber<this.maxForceReloadNumber&&(clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=setTimeout(function(){if(t.dynamicPptFileSrc&&!t.dynamicPptIsOnload&&t.forceReloadNumber<t.maxForceReloadNumber){t.forceReloadNumber++;var a=E.default.docAddressList[E.default.docAddressIndex]||x.default.SERVICEINFO.docAddress;if(E.default.docAddressIndex=++E.default.docAddressIndex%E.default.docAddressList.length,"mobile"===TK.SDKTYPE?"function"==typeof W.default.getTkRoom().setLocalStorageItem&&W.default.getTkRoom().setLocalStorageItem("tkDocAddressIndex",E.default.docAddressIndex):L.Utils.localStorage.setItem("tkDocAddressIndex",E.default.docAddressIndex),E.default.nowUseDocAddress=E.default.docAddressList[E.default.docAddressIndex]||x.default.SERVICEINFO.docAddress,L.Logger.info("[reload dynamic ppt]change doc address , old address is "+a+" , now address is "+E.default.nowUseDocAddress),L.Logger.info("["+e+"]load dynamic ppt failure , reload file , old url is "+document.getElementById("newppt_frame").src+" , now url is "+(t.dynamicPptFileSrc?E.default.nowUseDocAddress+t.dynamicPptFileSrc+(t.forceReloadNumber?"?forceReloadNumber="+t.forceReloadNumber:""):"")+" , reload number is "+t.forceReloadNumber),"dynamicPPT"===t.props.fileTypeMark){var n=x.default.newpptVersions,i=x.default.remoteNewpptUpdateTime,r=void 0,s=function(e){r=e};if(P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:s}}),r){var o=r,l=o.fileid,d=o.swfpath,u=o.pptslide,c=o.pptstep,h={rPathAddress:d+"/",PresAddress:"newppt.html?versions="+n+"&fileid="+l+"&playback="+E.default.playback+"&classbegin="+E.default.classBegin+"&publishDynamicPptMediaPermission_video="+R.default.handler.getAppPermissions("publishDynamicPptMediaPermission_video")+"&remoteNewpptUpdateTime="+i+"&role="+(x.default.joinRoomInfo?x.default.joinRoomInfo.roomrole:void 0)+"&dynamicPptActionClick="+R.default.handler.getAppPermissions("dynamicPptActionClick")+"&newpptPagingPage="+R.default.handler.getAppPermissions("newpptPagingPage")+"&dynamicPptDebug="+x.default.DEV+"&PptVolumeValue="+t.state.volumeValue+"&PptVolumeMute="+t.state.zhikeTeachingAssistantMute+"&ts="+(new Date).getTime(),slideIndex:u,stepIndex:c,fileid:l};t.ServiceNewPptAynamicPPT.setRPathAndPres(h)}}t.setState({updateState:!t.state.updateState}),t._setReloadIframeTimeout("reload")}},6e4))}},{key:"handlerPlaybackControl_play_pause",value:function(e){if(E.default.playback){var t=e.message.play,a={action:t?"playDynamicPpt":"stopDynamicPpt"};this._postMessage(a)}}},{key:"handlermobileSdk_changeDynamicPptSize",value:function(e){if("mobile"===TK.SDKTYPE&&e.message&&"object"===(0,c.default)(e.message)){var t={action:"resizeHandler"};Object.customAssign(t,e.message),this._postMessage(t)}}},{key:"handlerOnMessage",value:function(e){var t=this,a=e.message.event;t.handlerIframeMessage(a)}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=this,n=e.message;switch(n.name){case"ShowPage":var i=a._saveFileidReturnOpen(n.data);a._handlerReceiveShowPageSignalling({message:{data:n.data,open:i,source:"room-pubmsg"}});break;case"NewPptTriggerActionClick":if(!0===a.ServiceNewPptAynamicPPT.isOpenPptFile){var r=n.data,s=r.slide,o=r.fileid;s+=1;var l=function(e){var a=e.currpage,n=e.fileid;a===s&&o===n||!E.default.playback||(t.newPptActionJson[s]&&t.newPptActionJson[s].length>0?t.newPptActionJson[s].push(r):(t.newPptActionJson[s]=[],t.newPptActionJson[s].push(r)))};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:l}}),this._postMessage(n.data)}break;case"ClassBegin":a.handlerClassBeginCloseDynamicPptVideo(),a._handlerClassBeginStartOrEnd();break;case"PptVolumeControl":a.recvEventDataPptVolumeControl(n)}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"ClassBegin":t._handlerClassBeginStartOrEnd()}}},{key:"handlerStreamAdded_media",value:function(e){if("pc"===TK.SDKTYPE){var t=e.stream,a=t.getAttributes();if(a&&"media"===a.type){var n={action:"closeDynamicPptAutoVideo"};this._postMessage(n)}}}},{key:"handlerReceiveMsglistPptVolumeControl",value:function(e){var t=e.message.PptVolumeControlArr[0];this.recvEventDataPptVolumeControl(t)}},{key:"recvEventDataPptVolumeControl",value:function(e){var t=this;t.state.volumeValue=e.data.volume,t.setState({volumeValue:t.state.volumeValue});var a={action:"PptVolumeControl",volumeValue:e.data.volume};this._postMessage(a)}},{key:"handlerMobileSdk_closeDynamicPptWebPlay",value:function(e){if("mobile"===TK.SDKTYPE){var t={action:"closeDynamicPptAutoVideo"};this._postMessage(t)}}},{key:"handlerIframeMessage",value:function(e){var t=this,a=this;if(e.data){var n=void 0,i=void 0;try{i=JSON.parse(e.data),n=i.data}catch(t){return void L.Logger.warning("iframe message data can't be converted to JSON , iframe data:",e.data)}if("tk_dynamicPPT"===i.source)switch(L.Logger.debug("[dynamicPpt]receive remote iframe data form "+e.origin+":",e),n.action){case"initEvent":if(this.dynamicPptIsOnload=!0,clearTimeout(this.forceReloadNumberTimer),this.forceReloadNumberTimer=null,this.setState({dynamicPptLoading:!1}),a.ServiceNewPptAynamicPPT.remoteData.view=n.view,a.ServiceNewPptAynamicPPT.remoteData.slidesCount=n.slidesCount,a.ServiceNewPptAynamicPPT.remoteData.slide=n.slide,a.ServiceNewPptAynamicPPT.remoteData.step=n.step,a.ServiceNewPptAynamicPPT.remoteData.stepTotal=n.stepTotal,a.ServiceNewPptAynamicPPT.recvInitEventHandler(n.slide,n.step,n.externalData),a.dynamicPptOpen=!0,a.awaitHandleActionArray&&a.awaitHandleActionArray.length>0){var r=!0,s=!1,o=void 0;try{for(var l,u=(0,d.default)(a.awaitHandleActionArray);!(r=(l=u.next()).done);r=!0){var c=l.value;c&&"function"==typeof c&&c()}}catch(e){s=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(s)throw o}}}a.awaitHandleActionArray.length=0;break;case"slideChangeEvent":var h=function(e){var a=e.currpage;!D.default.isEmpty(t.newPptActionJson)&&t.newPptActionJson[a]&&0!==t.newPptActionJson[a].length&&(t.newPptActionJson[a].map(function(e,a){t._postMessage(e)}),t.newPptActionJson={})};a.ServiceNewPptAynamicPPT.remoteData.slide=n.slide,a.ServiceNewPptAynamicPPT.remoteData.step=n.step,a.ServiceNewPptAynamicPPT.remoteData.stepTotal=n.stepTotal,a.ServiceNewPptAynamicPPT.recvSlideChangeEventHandler(n.slide,n.externalData),P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:h}}),a.ServiceNewPptAynamicPPT.isInitiative(n.externalData)&&P.default.CoreController.dispatchEvent({type:"resetAllLeftToolButtonOpenStateToFalse"});break;case"stepChangeEvent":var m=function(e){var a=e.currpage;!D.default.isEmpty(t.newPptActionJson)&&t.newPptActionJson[a]&&0!==t.newPptActionJson[a].length&&(t.newPptActionJson[a].map(function(e,a){t._postMessage(e)}),t.newPptActionJson={})};a.ServiceNewPptAynamicPPT.remoteData.slide=n.slide,a.ServiceNewPptAynamicPPT.remoteData.step=n.step,a.ServiceNewPptAynamicPPT.remoteData.stepTotal=n.stepTotal,a.ServiceNewPptAynamicPPT.recvStepChangeEventHandler(n.step,n.externalData),P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:m}}),a.ServiceNewPptAynamicPPT.isInitiative(n.externalData)&&P.default.CoreController.dispatchEvent({type:"resetAllLeftToolButtonOpenStateToFalse"});break;case"autoPlayVideoInNewPpt":var g=n,f=g.isvideo,p=g.url,v=g.fileid,b=g.pptslide;if(f&&!E.default.playback){var y=E.default.nowUseDocAddress+a.ServiceNewPptAynamicPPT.rPathAddress+p,S={url:y,fileid:v?Number(v):v,isvideo:f,pptslide:b?Number(b):b};a._newpptAutoPlayVideoInNewPpt(S)}break;case"clickNewpptTriggerEvent":if("dynamicPPT"===a.props.fileTypeMark&&R.default.handler.getAppPermissions("sendSignallingFromDynamicPptTriggerActionClick")&&a.ServiceNewPptAynamicPPT.isInitiative(n.externalData)){var k=function(e){var t=e.fileid;n.fileid=t};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:k}}),H.default.sendSignallingFromDynamicPptTriggerActionClick(n),P.default.CoreController.dispatchEvent({type:"resetAllLeftToolButtonOpenStateToFalse"})}break;case"clickLink":"dynamicPPT"===a.props.fileTypeMark&&R.default.handler.getAppPermissions("sendSignallingFromDynamicPptTriggerClickLink")&&a.ServiceNewPptAynamicPPT.isInitiative(n.externalData)}}}},{key:"handlerSetNewPptFrameSrc",value:function(e){this.dynamicPptIsOnload=!1,this.dynamicPptFileSrc=e.message.src||"",this.forceReloadNumber=0,this._setReloadIframeTimeout("open"),this.setState({updateState:!this.state.updateState,dynamicPptLoading:!!this.dynamicPptFileSrc})}},{key:"handlerReceiveMsglistShowPageLastDocument",value:function(e){var t=this,a=t._saveFileidReturnOpen(e.message.data);e.message.open=a,t._handlerReceiveShowPageSignalling(e)}},{key:"handlerUpdateAppPermissions_newpptPagingPage",value:function(){if("dynamicPPT"===this.props.fileTypeMark){var e=function(e){P.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"newppt",data:e}})};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:e}});var t={action:"changeNewpptPagingPage",newpptPagingPage:R.default.handler.getAppPermissions("newpptPagingPage")};this._postMessage(t)}}},{key:"handlerInitAppPermissions",value:function(){var e=this;e.handlerUpdateAppPermissions_newpptPagingPage(),e.handlerUpdateAppPermissions_publishDynamicPptMediaPermission_video(),e.handlerUpdateAppPermissions_dynamicPptActionClick()}},{key:"handlerUpdateAppPermissions_publishDynamicPptMediaPermission_video",value:function(){var e={action:"changePublishDynamicPptMediaPermission_video",publishDynamicPptMediaPermission_video:R.default.handler.getAppPermissions("publishDynamicPptMediaPermission_video")};this._postMessage(e)}},{key:"handlerOpenDocuemntOrMediaFile",value:function(e){var t=this,a=e.message,n=t._saveFileidReturnOpen(a);a.isDynamicPPT&&t._handlerReceiveShowPageSignalling({message:{data:a,open:n,source:"newpptFileClickEvent"}})}},{key:"handlerNewpptPrevStepClick",value:function(){var e=this;e.ServiceNewPptAynamicPPT.recvCount=0,e.ServiceNewPptAynamicPPT.gotoPreviousStep()}},{key:"handlerNewpptNextStepClick",value:function(){var e=this;e.ServiceNewPptAynamicPPT.recvCount=0,e.ServiceNewPptAynamicPPT.gotoNextStep()}},{key:"handlerNewpptPrevSlideClick",value:function(){var e=this;e.ServiceNewPptAynamicPPT.recvCount=0,e.ServiceNewPptAynamicPPT.gotoPreviousSlide(!0)}},{key:"handlerNewpptNextSlideClick",value:function(){var e=this;e.ServiceNewPptAynamicPPT.recvCount=0,e.ServiceNewPptAynamicPPT.gotoNextSlide(!0)}},{key:"handlerReceiveMsglistClassBegin",value:function(){this._handlerClassBeginStartOrEnd()}},{key:"handlerPlayDynamicPPTMediaStream",value:function(e){var t=this,a=e.message;a.show,a.stream,t.handlerUpdateAppPermissions_newpptPagingPage()}},{key:"handlerSkipPage_dynamicPPT",value:function(e){var t=this;if("dynamicPPT"===t.props.fileTypeMark){var a=e.message.currpage;t._skipDynamicPPTPaging(a)}}},{key:"handlerUpdateAppPermissions_dynamicPptActionClick",value:function(){this.setState({updateState:!this.state.updateState});var e={action:"changeDynamicPptActionClick",dynamicPptActionClick:R.default.handler.getAppPermissions("dynamicPptActionClick")};this._postMessage(e)}},{key:"_openAynamicPPTHandler",value:function(e){var t=this;t.props.changeFileTypeMark("dynamicPPT"),P.default.CoreController.dispatchEvent({type:"saveLcStackToStorage",message:{}}),P.default.CoreController.dispatchEvent({type:"setFileDataToLcElement",message:{filedata:e}}),P.default.CoreController.dispatchEvent({type:"recoverCurrpageLcData"}),P.default.CoreController.dispatchEvent({type:"resetLcDefault"}),P.default.CoreController.dispatchEvent({type:"setH5FileFrameSrc",message:{src:""}});var a=e.fileid,n=e.swfpath,i=e.pptslide,r=e.pptstep,s=x.default.newpptVersions,o=x.default.remoteNewpptUpdateTime,l={rPathAddress:n+"/",PresAddress:"newppt.html?versions="+s+"&fileid="+a+"&playback="+E.default.playback+"&classbegin="+E.default.classBegin+"&publishDynamicPptMediaPermission_video="+R.default.handler.getAppPermissions("publishDynamicPptMediaPermission_video")+"&remoteNewpptUpdateTime="+o+"&role="+(x.default.joinRoomInfo?x.default.joinRoomInfo.roomrole:void 0)+"&dynamicPptActionClick="+R.default.handler.getAppPermissions("dynamicPptActionClick")+"&newpptPagingPage="+R.default.handler.getAppPermissions("newpptPagingPage")+"&dynamicPptDebug="+x.default.DEV+"&PptVolumeValue="+t.state.volumeValue+"&ts="+(new Date).getTime(),slideIndex:i,stepIndex:r,fileid:a};this.setState({updateState:!this.state.updateState}),P.default.CoreController.dispatchEvent({type:"closeLoading"}),t._updateLcScaleWhenAynicPPTInitHandler(16/9),t.awaitHandleActionArray.length=0,t.dynamicPptOpen=!1,t.ServiceNewPptAynamicPPT.setRPathAndPres(l),this.dynamicPptIsOnload=!1,this.dynamicPptFileSrc=l.rPathAddress+l.PresAddress,this.forceReloadNumber=0,this._setReloadIframeTimeout("open"),this.setState({updateState:!this.state.updateState,dynamicPptLoading:!!this.dynamicPptFileSrc}),P.default.CoreController.dispatchEvent({type:"checkSelectMouseState",message:{fileTypeMark:"dynamicPPT"}})}},{key:"_aynamicPPTJumpToAnim",value:function(e,t){this.ServiceNewPptAynamicPPT.jumpToAnim(e,t)}},{key:"_updateLcScaleWhenAynicPPTInitHandler",value:function(e){P.default.CoreController.dispatchEvent({type:"updateLcScaleWhenAynicPPTInitHandler",message:{lcLitellyScalc:e}})}},{key:"_handlerReceiveShowPageSignalling",value:function(e){var t=this,a=e.message,n=a.data,i=a.open,r=n;!r.isMedia&&r.isDynamicPPT&&t._reveiveNewpptDataHandler(r.filedata,i,!0)}},{key:"_reveiveNewpptDataHandler",value:function(e,t,a){var n=this;if(a&&n.ServiceNewPptAynamicPPT.recvCount++,t)return void n._openAynamicPPTHandler(e);n._aynamicPPTJumpToAnim(e.pptslide,e.pptstep)}},{key:"_handlerSendPPTMessageEvent",value:function(e,t){var a=this,n=function(n){var i=n,r=a._replaceSendPPTMessageData(i,e);P.default.CoreController.dispatchEvent({type:"documentPageChange",message:r}),t&&a._sendSignallingFromDynamicPptShowPage(r)};P.default.CoreController.dispatchEvent({type:"getFileDataFromLcElement",message:{callback:n}})}},{key:"_lcInit",value:function(){var e=this;e.ServiceNewPptAynamicPPT=e.ServiceNewPptAynamicPPT||new z.default,e.ServiceNewPptAynamicPPT.clearAll(),e.ServiceNewPptAynamicPPT.newDopPresentation()}},{key:"_replaceSendPPTMessageData",value:function(e,t){return t&&(e.pagenum=void 0!=t.pagenum?t.pagenum:e.pagenum,e.pptslide=void 0!=t.pptslide?t.pptslide:e.pptslide,e.pptstep=void 0!=t.pptstep?t.pptstep:e.pptstep,e.steptotal=void 0!=t.steptotal?t.steptotal:e.steptotal,e.currpage=void 0!=t.currpage?t.currpage:e.currpage),{isGeneralFile:!1,isMedia:!1,isDynamicPPT:!0,isH5Document:!1,action:t.action||"",mediaType:"",filedata:e}}},{key:"_sendSignallingFromDynamicPptShowPage",value:function(e){R.default.handler.getAppPermissions("sendSignallingFromDynamicPptShowPage")&&H.default.sendSignallingFromShowPage(!1,"DocumentFilePage_ShowPage",e)}},{key:"_newpptAutoPlayVideoInNewPpt",value:function(e){var t=this;if("mobile"===TK.SDKTYPE)W.default.getTkRoom().dynamicPptVideoAutoPlay(e);else if("pc"===TK.SDKTYPE){var a={source:"dynamicPPT",filename:"",fileid:e.fileid,type:"media"};E.default.classBegin||(a.toID=W.default.getTkRoom().getMySelf().id),t.pptvideoStream=TK.Stream({video:e.isvideo,audio:!0,url:e.url,extensionId:W.default.getTkRoom().getMySelf().id+":media",attributes:a},E.default.isClient),F.default.unpublishAllMediaStream(function(e,a){switch(e){case-1:case 1:if(!R.default.handler.getAppPermissions("publishMediaStream")||!R.default.handler.getAppPermissions("publishDynamicPptMediaPermission_video"))return!1;E.default.playPptVideoing=!0,t.handlerPlayDynamicPPTMediaStream({type:"playDynamicPPTMediaStream",message:{show:!0,stream:t.pptvideoStream}}),H.default.publishMediaStream(t.pptvideoStream)}})}}},{key:"_saveFileidReturnOpen",value:function(e){var t=this,a=void 0;if(!e.isMedia){var n=e.filedata.fileid;a=t.fileid!=n,t.fileid=n}return a}},{key:"_handlerClassBeginStartOrEnd",value:function(){var e={action:"changeClassBegin",classbegin:E.default.classBegin};this._postMessage(e)}},{key:"handlerClassBeginCloseDynamicPptVideo",value:function(){var e={action:"closeDynamicPptAutoVideo"};this._postMessage(e)}},{key:"_skipDynamicPPTPaging",value:function(e){var t=this;t.ServiceNewPptAynamicPPT.recvCount=0;var a=e;t.ServiceNewPptAynamicPPT.jumpToAnim(a,0,!0)}},{key:"_postMessage",value:function(e){var t=this;this.dynamicPptOpen?this.ServiceNewPptAynamicPPT.postMessage(e):this.awaitHandleActionArray.push(function(){t.ServiceNewPptAynamicPPT.postMessage(e)})}},{key:"volumeChangeDispatch",value:function(e){var t=this;t.state.volumeValue=e.message.data.volume,t.setState({volumeValue:t.state.volumeValue});var a={action:"PptVolumeControl",volumeValue:t.state.volumeValue};t._postMessage(a)}},{key:"render",value:function(){var e=this,t=e.props,a=t.fileTypeMark,n=(0,o.default)(t,["fileTypeMark"]);e.ServiceNewPptAynamicPPT||(e.ServiceNewPptAynamicPPT=new z.default),e.ServiceNewPptAynamicPPT.isOpenPptFile="dynamicPPT"===a;var i=Object.customAssign({display:"dynamicPPT"!==a?"none":"block"},this.props.styleJson);return C.default.createElement("div",(0,r.default)({style:i,className:"aynamic-ppt-conwrap add-position-absolute-top0-left0",id:"aynamic_ppt_newppt"},D.default.filterContainDataAttribute(n)),"  ",C.default.createElement("div",{className:"ppt-vessel",id:"ppt_vessel_newppt"},C.default.createElement("div",{className:"ppt-zoom-container",id:"ppt_zoom_container_newppt"},C.default.createElement("div",{id:"contentHolderNewppt",className:"aynamic-ppt-container"},C.default.createElement("iframe",{allow:"autoplay",allowFullScreen:!0,scrolling:"no",id:"newppt_frame",src:this.dynamicPptFileSrc?E.default.nowUseDocAddress+this.dynamicPptFileSrc+(this.forceReloadNumber?"&forceReloadNumber="+this.forceReloadNumber:"")+(this.changeDocLineReloadNumber?"&changeDocLineReloadNumber="+this.changeDocLineReloadNumber:""):"",name:"myframe"}),C.default.createElement("div",{id:"preloader_newppt",className:"ppt-loading-container add-position-absolute-top0-left0"},C.default.createElement("span",{className:"tk-loading-reload-number",style:{display:E.default.reloadFileShowReloadNumber&&this.forceReloadNumber?"block":"none"}},E.default.language.languageData.reloadDoucumentHint.one+this.forceReloadNumber+E.default.language.languageData.reloadDoucumentHint.two)),C.default.createElement("div",{id:"ppt_not_click_newppt",className:"ppt-not-click-newppt add-position-absolute-top0-left0"}),C.default.createElement("div",{className:"add-position-absolute-top0-left0",style:{width:"100%",height:"100%",zIndex:1,display:R.default.handler.getAppPermissions("dynamicPptActionClick")?"none":"block"}})))))}}]),t}(C.default.Component);t.default=j},hHPy:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),r=n(i),s=a("Zx67"),o=n(s),l=a("Zrlr"),d=n(l),u=a("wxAW"),c=n(u),h=a("zwoO"),m=n(h),g=a("Pf15"),f=n(g),p=a("GiK3"),v=n(p),b=a("O27J"),y=(n(b),a("HUPQ")),S=n(y),k=a("VSuD"),w=n(k),C=a("DrPG"),T=(n(C),a("T+56")),P=n(T),A=a("Sa83"),D=(n(A),a("yE5a")),_=(n(D),a("YRCL")),E=n(_),I=a("EXAz"),x=n(I),B=function(e){function t(e){(0,d.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.props.id,a.state={responderIsShow:"none",closeImg:"none",restartImg:"none",startAngle:-.5*Math.PI,tmpAngle:-.5*Math.PI,answerText:S.default.language.languageData.responder.begin.text,responderShow:!1,beginIsStatus:!1,studentRes:!1,userAdmin:"",firstUser:!1,userSort:{},userArry:[],teacherTimeOut:null,beginTimeOut:null},a.isSetDefaultPosition=!1,a.stop=void 0,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.mH=300,a.mW=300,a.r=a.mW/2,a.cR=a.r-10,a.endAngle=a.startAngle+2*Math.PI,a.xAngle=Math.PI/180*1,a.fontSize=35,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this;P.default.CoreController.addEventListener("responderShow",e.responderShow.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-qiangDaQi",e.handlerMsglistQiangDaQi.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener("receive-msglist-QiangDaZhe",e.handlerMsglistQiangDaZhe.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(w.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(w.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;P.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){t.responderIsShow!==this.state.responderIsShow&&"block"===this.state.responderIsShow&&this.isSetDefaultPosition&&(this.isSetDefaultPosition=!1,this.setDefaultPosition())}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!0)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"qiangDaQi":(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant||w.default.hasRole.rolePatrol||S.default.playback)&&t._teacherRecevedServiceQiangDaQiData(a);break;case"QiangDaZhe":(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant||w.default.hasRole.rolePatrol||S.default.playback)&&t._teacherRecevedServiceQiangDaZheData(a)}}},{key:"handlerRoomDelmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"ClassBegin":t.setState({responderIsShow:"none"});break;case"qiangDaQi":if(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant||w.default.hasRole.rolePatrol||S.default.playback){a.data.isShow?(clearTimeout(t.state.teacherTimeOut),window.cancelAnimationFrame(t.state.stop),t.state.beginIsStatus=!1,t.state.firstUser=!1,t.state.userSort={},t.state.userArry=[],t.setState({teacherTimeOut:t.state.teacherTimeOut,responderIsShow:"block",beginIsStatus:t.state.beginIsStatus,firstUser:t.state.firstUser,userSort:t.state.userSort,userArry:t.state.userArry})):(t.state.teacherTimeOut="",t.setState({teacherTimeOut:t.state.teacherTimeOut,responderIsShow:"none"}));break}}}},{key:"handlerMsglistQiangDaQi",value:function(e){var t=this,a=!0,n=!1,i=void 0;try{for(var s,o=(0,r.default)(e.message.qiangDaQiArr);!(a=(s=o.next()).done);a=!0){var l=s.value;(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant||w.default.hasRole.rolePatrol||S.default.playback)&&t._teacherRecevedServiceQiangDaQiData(l)}}catch(e){n=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"handlerMsglistQiangDaZhe",value:function(e){var t=this,a=!0,n=!1,i=void 0;try{for(var s,o=(0,r.default)(e.message.QiangDaZheArr);!(a=(s=o.next()).done);a=!0){var l=s.value;(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant||w.default.hasRole.rolePatrol||S.default.playback)&&t._teacherRecevedServiceQiangDaZheData(l)}}catch(e){n=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"_teacherRecevedServiceQiangDaQiData",value:function(e){var t=this,a=S.default.serviceTime/1e3-e.ts;e.data.isShow&&(t.state.closeImg="block",t.state.restartImg="none",t.state.answerText=S.default.language.languageData.responder.begin.text,document.getElementById("myCanvas").style.display="block",t.setState({responderIsShow:"block",closeImg:t.state.closeImg,restartImg:t.state.restartImg,answerText:t.state.answerText}),clearTimeout(t.state.teacherTimeOut),e.data.begin&&(a>=8?(clearTimeout(t.state.teacherTimeOut),t.state.closeImg="block",t.state.restartImg="block",0==t.state.firstUser?(t.clearCanvasData(),t.state.answerText=S.default.language.languageData.responder.noContest.text,t.setState({answerText:t.state.answerText})):(t.state.answerText=t.state.answerText,t.setState({answerText:t.state.answerText})),t.setState({answerText:t.state.answerText,closeImg:t.state.closeImg,restartImg:t.state.restartImg,responderIsShow:"block"})):(t.canvasDraw(),t.state.closeImg="none",t.state.beginIsStatus=e.data.begin,t.state.answerText=S.default.language.languageData.responder.inAnswer.text,t.setState({beginIsStatus:t.state.beginIsStatus,closeImg:t.state.closeImg,answerText:t.state.answerText}),t.state.teacherTimeOut=setTimeout(function(){t.state.closeImg="block",t.state.restartImg="block",0==t.state.firstUser?(t.clearCanvasData(),t.state.answerText=S.default.language.languageData.responder.noContest.text,t.setState({answerText:t.state.answerText})):(t.state.answerText=t.state.answerText,t.setState({answerText:t.state.answerText})),t.setState({teacherTimeOut:t.state.teacherTimeOut,answerText:t.state.answerText,closeImg:t.state.closeImg,restartImg:t.state.restartImg,responderIsShow:"block",beginIsStatus:t.state.beginIsStatus})},8e3))))}},{key:"_teacherRecevedServiceQiangDaZheData",value:function(e){var t=this;if(e.data.isClick){clearTimeout(t.state.teacherTimeOut),t.clearCanvasData(),t.state.closeImg="block",t.state.restartImg="block",t.state.userSort[e.fromID]={},t.state.userSort[e.fromID][e.seq]=e.data.userAdmin,t.setState({userSort:t.state.userSort}),t.state.userArry=[];for(var a in t.state.userSort)for(var n in t.state.userSort[a])t.state.userArry.push(n),t.state.userArry=t.state.userArry.sort(),t.setState({userArry:t.state.userArry}),void 0!=t.state.userSort[a][t.state.userArry[0]]&&(t.state.answerText=t.state.userSort[a][t.state.userArry[0]],t.setState({answerText:t.state.answerText,firstUser:t.state.firstUser}));t.state.firstUser=!0,t.setState({firstUser:t.state.firstUser})}else t.state.firstUser=!1,t.setState({firstUser:t.state.firstUser})}},{key:"responderShow",value:function(e){var t=this;"responder-implement-bg"==e.className&&"none"==t.state.responderIsShow&&(document.getElementById("myCanvas").style.display="block",t.state.closeImg="block",this.isSetDefaultPosition=!0,t.setState({responderIsShow:"block",closeImg:t.state.closeImg}))}},{key:"canvasDraw",value:function(){window.cancelAnimationFrame(this.state.stop);var e=this;e.c=document.getElementById("myCanvas"),e.ctx=e.c.getContext("2d"),e.c.width=300,e.c.height=300,e.ctx.clearRect(0,0,300,300),e.state.tmpAngle>=e.endAngle||(e.state.tmpAngle+e.xAngle>e.endAngle?e.state.tmpAngle=e.endAngle:e.state.tmpAngle+=e.xAngle,e.ctx.clearRect(0,0,e.mW,e.mH),e.ctx.beginPath(),e.ctx.lineWidth=9,e.ctx.strokeStyle="#1e2b49",e.ctx.arc(e.r,e.r,e.cR,e.state.startAngle,e.state.tmpAngle),e.ctx.stroke(),e.ctx.closePath(),e.stop=requestAnimationFrame(e.canvasDraw.bind(e)))}},{key:"beginResponder",value:function(){var e=this;if((w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant)&&0==this.state.beginIsStatus){this.canvasDraw(),this.state.responderShow=!0,this.state.beginIsStatus=!0,clearTimeout(this.state.beginTimeOut),this.state.beginTimeOut=setTimeout(function(){e.state.closeImg="block",e.state.restartImg="block",e.setState({closeImg:e.state.closeImg,restartImg:e.state.restartImg}),0==e.state.firstUser&&(e.state.answerText=S.default.language.languageData.responder.noContest.text,e.setState({answerText:e.state.answerText})),document.getElementById("myCanvas").style.display="none"},8e3);var t=this.state.responderShow,a=this.state.beginIsStatus,n=this.state.userAdmin,i={isShow:t,begin:a,userAdmin:n};E.default.sendSignallingQiangDaQi(!1,i),this.state.answerText=S.default.language.languageData.responder.inAnswer.text,this.setState({answerText:this.state.answerText,responderShow:this.state.responderShow,beginTimeOut:this.state.beginTimeOut})}}},{key:"closeResponder",value:function(){if(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant){var e=this;document.getElementById("myCanvas").style.display="none",e.state.beginIsStatus=!1,e.state.responderShow=!1,e.state.userSort={},e.state.userArry=[],e.state.closeImg="none",e.state.restartImg="none",e.state.answerText=S.default.language.languageData.responder.begin.text,e.setState({closeImg:e.state.closeImg,restartImg:e.state.restartImg,answerText:e.state.answerText,responderIsShow:"none",beginIsStatus:e.state.beginIsStatus,responderShow:e.state.responderShow});var t={isShow:!1};E.default.sendSignallingQiangDaQi(!0,t),e.clearCanvasData()}}},{key:"restartResponder",value:function(){if(w.default.hasRole.roleChairman||w.default.hasRole.roleTeachingAssistant){this.clearCanvasData(),document.getElementById("myCanvas").style.display="block",this.state.closeImg="none",this.state.restartImg="none",this.state.answerText=S.default.language.languageData.responder.begin.text,this.state.beginIsStatus=!1,this.state.responderShow=!0,this.state.firstUser=!1,this.state.userSort={},this.state.userArry=[],this.setState({firstUser:this.state.firstUser,responderShow:this.state.responderShow,beginIsStatus:this.state.beginIsStatus,userSort:this.state.userSort,userArry:this.state.userArry});var e=this.state.responderShow,t=this.state.beginIsStatus,a=this.state.userAdmin,n={isShow:e,begin:t,userAdmin:a},i=!0;E.default.sendSignallingQiangDaQi(i,n),i=!1,E.default.sendSignallingQiangDaQi(i,n),this.setState({beginIsStatus:this.state.beginIsStatus,startAngle:this.state.startAngle,tmpAngle:this.state.tmpAngle,closeImg:this.state.closeImg,restartImg:this.state.restartImg});var r=this.props,s=r.id,o=r.responderDrag,l=r.draggableData;l.changePosition&&"function"==typeof l.changePosition&&l.changePosition(s,o,!0)}}},{key:"clearCanvasData",value:function(){var e=document.getElementById("myCanvas"),t=e.getContext("2d"),a=e.width=300,n=e.height=300;t.clearRect(0,0,a,n),window.cancelAnimationFrame(this.state.stop),this.state.startAngle=-.5*Math.PI,this.endAngle=this.state.startAngle+2*Math.PI,this.xAngle=Math.PI/180*1,this.fontSize=35,this.state.tmpAngle=this.state.startAngle}},{key:"render",value:function(){var e=this,t=e.props,a=t.id,n=t.responderDrag,i=t.draggableData,r={display:this.state.responderIsShow},s=Object.customAssign({id:a,percentPosition:{percentLeft:n.percentLeft,percentTop:n.percentTop}},i);return v.default.createElement(x.default,s,v.default.createElement("div",{id:a,className:"responder-circle touch-select-select",style:r},v.default.createElement("canvas",{id:"myCanvas"},S.default.language.languageData.responder.update.text),v.default.createElement("div",{className:"myCanvas-bg-div"}),v.default.createElement("div",{className:"responder-black-circle"}),v.default.createElement("div",{className:"responder-begin-circle "+(this.state.beginIsStatus?"disabled":""),onClick:this.beginResponder.bind(this)},this.state.answerText),v.default.createElement("div",{className:"responder-close-img",onClick:this.closeResponder.bind(this),style:{display:this.state.closeImg}},S.default.language.languageData.responder.close.text),v.default.createElement("div",{className:"responder-restart-img",onClick:this.restartResponder.bind(this),style:{display:this.state.restartImg}},S.default.language.languageData.responder.restart.text)))}}]),t}(v.default.Component);t.default=B},iCxh:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),r=n(i),s=a("BO1k"),o=n(s),l=a("Zx67"),d=n(l),u=a("Zrlr"),c=n(u),h=a("wxAW"),m=n(h),g=a("zwoO"),f=n(g),p=a("Pf15"),v=n(p),b=a("GiK3"),y=n(b),S=a("HUPQ"),k=n(S),w=a("VSuD"),C=n(w),T=a("T+56"),P=n(T),A=a("YRCL"),D=n(A),_=a("DrPG"),E=(n(_),a("EXAz")),I=n(E),x=function(e){function t(e){(0,c.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.state={dialTeachComponentBgDisplay:"none",dialIconClose:!1,turnTableDeg:"rotate(0)",dialShow:!1,deg:50,numdeg:0,num:0,isClick:!1,msgDeg:!1},a.isSetDefaultPosition=!1,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,v.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){var e=this;P.default.CoreController.addEventListener("receive-msglist-dial",e.handlerMsglistDialShow.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomUserpropertyChanged,e.handlerroomUserpropertyChanged.bind(e),e.listernerBackupid),P.default.CoreController.addEventListener(C.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;P.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){t.dialTeachComponentBgDisplay!==this.state.dialTeachComponentBgDisplay&&"block"===this.state.dialTeachComponentBgDisplay&&this.isSetDefaultPosition&&(this.isSetDefaultPosition=!1,this.setDefaultPosition())}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!0)}}},{key:"handlerroomUserpropertyChanged",value:function(e){var t=e.message,a=(e.user,!0),n=!1,i=void 0;try{for(var s,l=(0,o.default)((0,r.default)(t));!(a=(s=l.next()).done);a=!0)s.value}catch(e){n=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw i}}}},{key:"handlerMsglistDialShow",value:function(e){var t=this;this.state.msgDeg=!0,this.setState({msgDeg:this.state.msgDeg});var a=!0,n=!1,i=void 0;try{for(var r,s=(0,o.default)(e.message.dialShowArr);!(a=(r=s.next()).done);a=!0){var l=r.value;C.default.hasRole.roleChairman||C.default.hasRole.roleTeachingAssistant||C.default.hasRole.rolePatrol||k.default.playback?l.data.isShow?(t.state.turnTableDeg="rotate(0)",t.state.dialIconClose=!0,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose})):(t.state.turnTableDeg=l.data.rotationAngle,t.state.dialIconClose=!0,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose,isClick:t.state.isClick})):l.data.isShow?(t.state.turnTableDeg="rotate(0)",t.state.dialIconClose=!1,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose})):(t.state.turnTableDeg=l.data.rotationAngle,t.state.dialIconClose=!1,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose}))}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"dial":t.handlerDisplayTeachTool(a)}}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"dial":this.props.id,t.state.num=0,t.state.numdeg=0,t.state.deg=50,t.setState({dialTeachComponentBgDisplay:"none",num:t.state.num,numdeg:t.state.numdeg,deg:t.state.deg});break;case"ClassBegin":t.setState({dialTeachComponentBgDisplay:"none"})}}},{key:"handlerDisplayTeachTool",value:function(e){var t=this;this.isSetDefaultPosition=!0,C.default.hasRole.roleChairman||C.default.hasRole.roleTeachingAssistant||C.default.hasRole.rolePatrol||k.default.playback?e.data.isShow?(t.state.dialIconClose=!0,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose})):(t.state.turnTableDeg=e.data.rotationAngle,t.state.dialIconClose=!1,t.state.msgDeg=!1,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose,msgDeg:t.state.msgDeg}),setTimeout(function(){t.state.dialIconClose=!0,t.state.isClick=!1,t.setState({dialIconClose:t.state.dialIconClose,isClick:t.state.isClick})},4e3)):e.data.isShow?(t.state.turnTableDeg="rotate(0)",t.state.dialIconClose=!1,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose})):(t.state.turnTableDeg=e.data.rotationAngle,t.state.dialIconClose=!1,t.setState({dialTeachComponentBgDisplay:"block",turnTableDeg:t.state.turnTableDeg,dialIconClose:t.state.dialIconClose}))}},{key:"handlerRoomPlaybackClearAll",value:function(){if(!k.default.playback)return void L.Logger.error("No playback environment, no execution event[roomPlaybackClearAll] handler ");this.setState({dialTeachComponentBgDisplay:"none",dialIconClose:!1,turnTableDeg:"rotate(0)",dialShow:!1})}},{key:"opointer",value:function(e){if(C.default.hasRole.roleStudent||!0===this.state.isClick||C.default.hasRole.rolePatrol)return!1;if(this.state.isClick)return!1;this.state.msgDeg&&(this.state.turnTableDeg="rotate(0)"),this.state.msgDeg=!1,this.state.isClick=!0,this.state.dialShow=!1;var t=Math.floor(5*Math.random()+1);this.state.num=t+this.state.num,this.state.numdeg+=t*this.state.deg+360*Math.floor(2*Math.random()+3),90!=this.state.numdeg.toString().substr(-2)&&30!=this.state.numdeg.toString().substr(-2)&&10!=this.state.numdeg.toString().substr(-2)&&50!=this.state.numdeg.toString().substr(-2)&&70!=this.state.numdeg.toString().substr(-2)||(this.state.numdeg=this.state.numdeg+30),this.setState({dialShow:this.state.dialShow,num:this.state.num,numdeg:this.state.numdeg,deg:this.state.deg,isClick:this.state.isClick,msgDeg:this.state.msgDeg});var a=this.state.dialShow,n={rotationAngle:"rotate("+this.state.numdeg+"deg)",isShow:a};D.default.sendSignallingDialToStudent(n)}},{key:"dialClosePHandle",value:function(){if(C.default.hasRole.roleChairman||C.default.hasRole.roleTeachingAssistant){this.state.num=0,this.state.numdeg=0,this.state.deg=50,this.state.turnTableDeg="rotate(0)",this.setState({dialTeachComponentBgDisplay:"none",turnTableDeg:this.state.turnTableDeg,num:this.state.num,numdeg:this.state.numdeg,deg:this.state.deg});var e={dialClose:"none"};D.default.sendSignallingDialToStudent(e,!0),this.state.studentNameArr=[],this.setState({studentNameArr:this.state.studentNameArr})}}},{key:"render",value:function(){var e=(this.state.studentNameArr,this.props),t=e.id,a=e.dialDrag,n=e.draggableData,i={position:"absolute",zIndex:130,borderRadius:C.default.hasRole.roleStudent?"50%":void 0,display:this.state.dialTeachComponentBgDisplay,left:0,top:0},r=Object.customAssign({id:t,defaultSize:C.default.hasRole.roleStudent?{width:3,height:3}:{width:3.2,height:3.4},size:C.default.hasRole.roleStudent?{width:3,height:3}:{width:3.2,height:3.4},percentPosition:{percentLeft:a.percentLeft,percentTop:a.percentTop}},n);return y.default.createElement(I.default,r,y.default.createElement("div",{id:"dialDrag",style:i},y.default.createElement("div",{className:"dial-teachComponent-bg touch-select-select ",ref:"dialTeachComponentBg",style:{display:this.state.dialTeachComponentBgDisplay,top:C.default.hasRole.roleStudent?"0":"0.4rem"}},y.default.createElement("button",{alt:"pointer",style:{backgroundColor:this.state.a},className:"dial-teachComponent-pointer-button",onClick:this.opointer.bind(this)}),y.default.createElement("div",{className:"dial-teachComponent-turntable",ref:"turnTable",style:{transition:"transform 4s ease",transform:this.state.turnTableDeg}}),y.default.createElement("div",{className:"dialCloseP",onClick:this.dialClosePHandle.bind(this),style:{display:this.state.dialIconClose?"block":"none"}}))))}}]),t}(y.default.Component);t.default=x},ioQ5:function(e,t,a){a("HpRW")("Set")},jEnx:function(e,t,a){var n=a("kM2E");n(n.S,"Object",{is:a("CmP/")})},jFbC:function(e,t,a){a("Cdx3"),e.exports=a("FeBl").Object.keys},lHA8:function(e,t,a){e.exports={default:a("pPW7"),__esModule:!0}},"m/zC":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.webRequestFail=t.webRequestSuccess=void 0;var i=a("Zrlr"),r=n(i),s=a("wxAW"),o=n(s),l=a("VSuD"),d=n(l),u=a("HUPQ"),c=(n(u),a("T+56")),h=(n(c),t.webRequestSuccess=1,t.webRequestFail=0,function(){function e(){(0,r.default)(this,e)}return(0,o.default)(e,[{key:"baseAjax",value:function(e,t){t=t||{},$.ajax({type:e.type||"post",url:e.url,dataType:e.dataType||"json",async:e.async||!1,data:e.data}).done(function(a){L.Logger.debug((e.remark?"["+e.remark+"]":"")+"success:ajax request  response:",a),t&&t.doneCallback&&"function"==typeof t.doneCallback&&t.doneCallback(a)}).fail(function(a){L.Logger.error((e.remark?"["+e.remark+"]":"")+"fail:ajax request  error:",a),t&&t.failCallback&&"function"==typeof t.failCallback&&t.failCallback(a)})}},{key:"getFileRemark",value:function(e,t){var a=this,n={fileid:e},i={type:"post",url:d.default.SERVICEINFO.address+"/ClientAPI/getfileremark?ts="+(new Date).getTime(),data:n,async:!0,remark:"获取课件备注"};a.baseAjax(i,t)}}]),e}()),m=new h;t.default=m},m9gC:function(e,t,a){var n=a("RY/4"),i=a("4WTo");e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},mbce:function(e,t,a){var n=a("lktj"),i=a("TcQ7"),r=a("NpIQ").f;e.exports=function(e){return function(t){for(var a,s=i(t),o=n(s),l=o.length,d=0,u=[];l>d;)r.call(s,a=o[d++])&&u.push(e?[a,s[a]]:s[a]);return u}}},msXi:function(e,t,a){var n=a("77Pl");e.exports=function(e,t,a,i){try{return i?t(n(a)[0],a[1]):t(a)}catch(t){var r=e.return;throw void 0!==r&&n(r.call(e)),t}}},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},oKdf:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("W3Iv"),r=n(i),s=a("d7EF"),o=n(s),l=a("lHA8"),d=n(l),u=a("c/Tr"),c=n(u),h=a("BO1k"),m=n(h),g=a("Zx67"),f=n(g),p=a("Zrlr"),v=n(p),b=a("wxAW"),y=n(b),S=a("zwoO"),k=n(S),w=a("Pf15"),C=n(w),T=a("GiK3"),P=n(T),A=a("O27J"),D=(n(A),a("HUPQ")),_=n(D),E=a("VSuD"),I=n(E),x=a("DrPG"),B=(n(x),a("T+56")),R=n(B),N=a("Sa83"),W=(n(N),a("yE5a")),M=(n(W),a("YRCL")),F=n(M),O=a("EXAz"),H=n(O),U=function(e){function t(e){(0,v.default)(this,t);var a=(0,k.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.state={optionUl:"",initArr:[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],brr:[],allResult:"",allResultX:"",crr:[],trueSelect:"",endQuestion:null,restartQuestion:null,answerTeachWrapDiv:"none",resultTeachDisplay:null,beginStyle:null,lisStyle:!1,flag:null,plusStyle:"#368bcb",reduceStyle:"#368bcb",resultTeachStyleDisplay:null,numz:0,afterArrayA:[],afterArrayB:[],afterArrayC:[],afterArrayD:[],afterArrayE:[],afterArrayF:[],afterArrayG:[],afterArrayH:[],studentNumbers:[],allStudentNameA:[],allStudentNameB:[],allStudentNameC:[],allStudentNameD:[],allStudentNameE:[],allStudentNameF:[],allStudentNameG:[],allStudentNameH:[],allNumbers:0,studentSendArry:[],liA:"hidden",liB:"hidden",liC:"hidden",liD:"hidden",liE:"hidden",liF:"hidden",liG:"hidden",liH:"hidden",idA:[],idB:[],idC:[],idD:[],idE:[],idF:[],idG:[],idH:[],trueNum:0,trueLV:0,allStudentChosseAnswer:{},round:!1,isShow:!1,dataInit:[],publishAnswerText:"",xiangQingText:"",tableStyle:"",columnar:"",isXiangQing:!1,tableArry:[],tableObject:{},isPublished:!1,publishedWarning:"none",publishedWarningColor:"#074496",servicerTimes:"",resizeInfo:{width:0,height:0}},a.isSetDefaultPosition=!1,a.liArr=[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1},{id:4,name:"E",sel:!1},{id:5,name:"F",sel:!1},{id:6,name:"G",sel:!1},{id:7,name:"H",sel:!1}],a.selects=!1,a.stop=null,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,C.default)(t,e),(0,y.default)(t,[{key:"componentDidMount",value:function(){var e=this;e.trueArr(),R.default.CoreController.addEventListener("handleAnswerShow",e.handleAnswerShow.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("receive-msglist-submitAnswers",e.handlerMsglistResultStudent.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener("receive-msglist-answer",e.handlerMsglistAnswerShow.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener(I.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener(I.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),R.default.CoreController.addEventListener(I.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;R.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){if(t.answerTeachWrapDiv!==this.state.answerTeachWrapDiv&&"block"===this.state.answerTeachWrapDiv){var a=this.props.id,n=document.getElementById(a);if(n){var i=_.default.windowInnerWidth/I.default.STANDARDSIZE;this.state.resizeInfo.width=n.offsetWidth/i,this.state.resizeInfo.height=n.offsetHeight/i,this.setState({resizeInfo:this.state.resizeInfo})}this.isSetDefaultPosition&&(this.isSetDefaultPosition=!1,this.setDefaultPosition())}if(t.resultTeachDisplay!==this.state.resultTeachDisplay&&"block"===this.state.resultTeachDisplay){var r=this.props.id,s=document.getElementById(r);if(s){var o=_.default.windowInnerWidth/I.default.STANDARDSIZE;this.state.resizeInfo.width=s.offsetWidth/o,this.state.resizeInfo.height=s.offsetHeight/o,this.setState({resizeInfo:this.state.resizeInfo})}}}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=document.getElementById(t),i=document.querySelector(a.dragBounds);if(n&&i){var r=(i.offsetWidth-n.offsetWidth)/2;a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:r,top:0,percentLeft:.5,percentTop:0,isDrag:!1},!0)}}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"answer":(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant||I.default.hasRole.rolePatrol||_.default.playback)&&t._teacherRecevedServiceDataShow(a);break;case"submitAnswers":t._updateStudentShow(a);break;case"UpdateTime":t.state.servicerTimes=a.ts,t.setState({servicerTimes:t.state.servicerTimes})}}},{key:"handleAnswerShow",value:function(e){var t=this;"answer-implement-bg"==e.className&&"none"==t.state.answerTeachWrapDiv&&(t.state.plusStyle="#368bcb",t.state.reduceStyle="#368bcb",t.clearTeacherShowData(),this.isSetDefaultPosition=!0,t.setState({answerTeachWrapDiv:"block",resultTeachDisplay:"none",plusStyle:t.state.plusStyle,reduceStyle:t.state.plusStyle}))}},{key:"handlerMsglistAnswerShow",value:function(e){var t=this,a=!0,n=!1,i=void 0;try{for(var r,s=(0,m.default)(e.message.answerShowArr);!(a=(r=s.next()).done);a=!0){var o=r.value;(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant||I.default.hasRole.rolePatrol||_.default.playback)&&t._teacherRecevedServiceDataShow(o)}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"_teacherRecevedServiceDataShow",value:function(e){var t=this;setTimeout(function(){t.coordArr(e.data.optionalAnswers),t.state.crr=e.data.rightAnswers,t.state.init=e.data.optionalAnswers,t.state.dataInit=e.data.optionalAnswers,t.setState({crr:t.state.crr,dataInit:t.state.dataInit,initArr:t.state.initArr}),e.data.isShow?(t.clearTeacherShowData(),t.state.initArr=[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],t.state.plusStyle="#368bcb",t.state.reduceStyle="#368bcb",t.state.publishedWarning="none",t.setState({plusStyle:t.state.plusStyle,reduceStyle:t.state.plusStyle,answerTeachWrapDiv:"block",resultTeachDisplay:"none",initArr:t.state.initArr,publishedWarning:t.state.publishedWarning})):e.data.isRound?(clearInterval(t.stop),t.state.endQuestion="none",t.state.restartQuestion="block",t.state.tableArry=[],t.state.xiangQingText=_.default.language.languageData.answers.details.text,t.state.publishAnswerText=_.default.language.languageData.answers.PublishTheAnswer.text,t.state.resultTeachStyleDisplay="block",t.state.crr=e.data.rightAnswers,t.state.dataInit=e.data.optionalAnswers,document.getElementById("result-teach-mytime").textContent="",document.getElementById("result-teach-mytime").textContent=e.data.quizTimes,t.setState({tableArry:t.state.tableArry,publishAnswerText:t.state.publishAnswerText,xiangQingText:t.state.xiangQingText,endQuestion:t.state.endQuestion,restartQuestion:t.state.restartQuestion,crr:t.state.crr,dataInit:t.state.dataInit,answerTeachWrapDiv:"none",resultTeachDisplay:"block",resultTeachStyleDisplay:t.state.resultTeachStyleDisplay}),e.data.isPublished&&(t.state.publishedWarning="none",t.state.publishAnswerText=_.default.language.languageData.answers.published.text,t.setState({publishAnswerText:t.state.publishAnswerText,publishedWarning:t.state.publishedWarning})),t.trueArr(),t.coordArr(t.state.dataInit),t.coordArrX(t.state.dataInit)):(clearInterval(t.stop),t.state.servicerTimes<e.ts?t.state.numz=0:t.state.numz=t.state.servicerTimes-e.ts-1,t.time_fun(),t.state.endQuestion="block",t.state.restartQuestion="none",t.state.resultTeachStyleDisplay="none",t.state.columnar="block",t.state.tableStyle="none",t.state.publishedWarningColor="#074496",t.state.dataInit=e.data.optionalAnswers,t.state.xiangQingText=_.default.language.languageData.answers.details.text,t.state.publishAnswerText=_.default.language.languageData.answers.PublishTheAnswer.text,t.state.afterArrayA=[],t.state.afterArrayB=[],t.state.afterArrayC=[],t.state.afterArrayD=[],t.state.afterArrayE=[],t.state.afterArrayF=[],t.state.afterArrayG=[],t.state.afterArrayH=[],t.state.afterArray=[],t.state.allStudentName=[],t.state.allStudentChosseAnswer={},t.state.publishedWarning="none",t.state.trueLV=0,t.state.allNumbers=0,t.state.idA=[],t.state.idB=[],t.state.idC=[],t.state.idD=[],t.state.idE=[],t.state.idF=[],t.state.idG=[],t.state.idH=[],t.trueArr(),t.coordArr(t.state.dataInit),t.coordArrX(t.state.dataInit),t.setState({numz:t.state.numz,publishedWarningColor:t.state.publishedWarningColor,columnar:t.state.columnar,tableStyle:t.state.tableStyle,publishedWarning:t.state.publishedWarning,publishAnswerText:t.state.publishAnswerText,xiangQingText:t.state.xiangQingText,answerTeachWrapDiv:"none",allStudentChosseAnswer:t.state.allStudentChosseAnswer,resultTeachDisplay:"block",crr:t.state.crr,dataInit:t.state.dataInit,endQuestion:t.state.endQuestion,restartQuestion:t.state.restartQuestion,afterArray:t.state.afterArray,afterArrayA:t.state.afterArrayA,afterArrayB:t.state.afterArrayB,afterArrayC:t.state.afterArrayC,afterArrayD:t.state.afterArrayD,afterArrayE:t.state.afterArrayE,afterArrayF:t.state.afterArrayF,afterArrayG:t.state.afterArrayG,afterArrayH:t.state.afterArrayH,trueLV:t.state.trueLV,allNumbers:t.state.allNumbers,idA:t.state.idA,idB:t.state.idB,idC:t.state.idC,idD:t.state.idD,idE:t.state.idE,idF:t.state.idF,idG:t.state.idG,idH:t.state.idH,resultTeachStyleDisplay:t.state.resultTeachStyleDisplay}))},10)}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"answer":t.state.tableObject={},t.setState({tableObject:t.state.tableObject,answerTeachWrapDiv:"none",resultTeachDisplay:"none"});break;case"ClassBegin":t.setState({answerTeachWrapDiv:"none",resultTeachDisplay:"none"})}}},{key:"handlerMsglistResultStudent",value:function(e){var t=this,a=e.message.submitAnswersArr;if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant||I.default.hasRole.rolePatrol)for(var n in a)t._updateStudentShow(a[n])}},{key:"handlerMsglistAnswerIconShow",value:function(e){this.setState({answerTeachWrapDiv:"block"})}},{key:"handlerRoomPlaybackClearAll",value:function(){if(!_.default.playback)return void L.Logger.error("No playback environment, no execution event[roomPlaybackClearAll] handler ");this.clearTeacherShowData()}},{key:"_updateStudentShow",value:function(e){var t=this;t.state.studentNumbers.push(e.fromID);var a=e.fromID;t.setState({studentNumbers:t.state.studentNumbers});var n=e.data.mySelect,i=e.data.sendStudentName,r=a+"0",s=a+"1",o=a+"2";t.state.tableObject[a]={},t.state.tableObject[a][r]=e.data.sendStudentName,t.state.tableObject[a][s]=e.data.mySelect,t.state.tableObject[a][o]=e.ts-e.data.times,t.state.allStudentChosseAnswer[a]={},t.state.allStudentChosseAnswer[a][i]=n,t.setState({allStudentChosseAnswer:t.state.allStudentChosseAnswer,tableObject:t.state.tableObject});for(var l=0;l<t.state.studentNumbers.length;l++)e.fromID==t.state.studentNumbers[l]&&(t.state.allStudentChosseAnswer[a][i]=n,t.state.tableObject[a][r]=e.data.sendStudentName,t.state.tableObject[a][s]=e.data.mySelect,t.state.tableObject[a][o]=e.ts-e.data.times,t.setState({allStudentChosseAnswer:t.state.allStudentChosseAnswer,tableObject:t.state.tableObject}));var u=(0,c.default)(new d.default(t.state.studentNumbers));t.state.allNumbers=u.length,t.state.idA=[],t.state.idB=[],t.state.idC=[],t.state.idD=[],t.state.idE=[],t.state.idF=[],t.state.idG=[],t.state.idH=[],t.state.afterArrayA=[],t.state.afterArrayB=[],t.state.afterArrayC=[],t.state.afterArrayD=[],t.state.afterArrayE=[],t.state.afterArrayF=[],t.state.afterArrayG=[],t.state.afterArrayH=[],t.state.trueNum=0,t.setState({afterArrayA:t.state.afterArrayA,afterArrayB:t.state.afterArrayB,afterArrayC:t.state.afterArrayC,afterArrayD:t.state.afterArrayD,afterArrayE:t.state.afterArrayE,afterArrayF:t.state.afterArrayF,afterArrayG:t.state.afterArrayG,afterArrayH:t.state.afterArrayH}),e.data.mySelect.length;for(var h in t.state.allStudentChosseAnswer)for(var m in t.state.allStudentChosseAnswer[h])!function(a){var n=a;t.state.allStudentChosseAnswer[h][n].map(function(e,a){if("A"==e){t.state.idA.push(n),t.state.afterArrayA=[],t.setState({afterArray:t.state.afterArray});var i=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idA.length<13?t.state.idA.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idA.length));t.state.afterArrayA.push(i),t.setState({afterArrayA:t.state.afterArrayA,idA:t.state.idA})}if("B"==e){t.state.idB.push(n),t.state.afterArrayB=[],t.setState({afterArray:t.state.afterArray});var r=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idB.length<13?t.state.idB.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idB.length));t.state.afterArrayB.push(r),t.setState({afterArrayB:t.state.afterArrayB,idB:t.state.idB})}if("C"==e){t.state.idC.push(n),t.state.afterArrayC=[],t.setState({afterArray:t.state.afterArray});var s=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idC.length<13?t.state.idC.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idC.length));t.state.afterArrayC.push(s),t.setState({afterArrayC:t.state.afterArrayC,idC:t.state.idC})}if("D"==e){t.state.idD.push(n),t.state.afterArrayD=[];var o=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idD.length<13?t.state.idD.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idD.length));t.state.afterArrayD.push(o),t.setState({afterArrayD:t.state.afterArrayD,idD:t.state.idD})}if("E"==e){t.state.idE.push(n),t.state.afterArrayE=[];var l=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idE.length<13?t.state.idE.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idE.length));t.state.afterArrayE.push(l),t.setState({afterArrayE:t.state.afterArrayE,idE:t.state.idE})}if("F"==e){t.state.idF.push(n),t.state.afterArrayF=[];var d=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idF.length<13?t.state.idF.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idF.length));t.state.afterArrayF.push(d),t.setState({afterArrayF:t.state.afterArrayF,idF:t.state.idF})}if("G"==e){t.state.idG.push(n),t.state.afterArrayG=[];var u=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idG.length<13?t.state.idG.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idG.length));t.state.afterArrayG.push(u),t.setState({afterArrayG:t.state.afterArrayG,idG:t.state.idG})}if("H"==e){t.state.idH.push(n),t.state.afterArrayH=[];var c=P.default.createElement("div",{className:"answer-stu-lis",key:a,style:{height:t.state.idH.length<13?t.state.idH.length/10+"rem":"1.2rem"}},P.default.createElement("p",null,t.state.idH.length));t.state.afterArrayH.push(c),t.setState({afterArrayH:t.state.afterArrayH,idH:t.state.idH})}});var i=e.data.optionalAnswers;t.coordArr(i),t.coordArrX(i);var r=(0,c.default)(new d.default(t.state.crr));r=r.sort(),t.state.allStudentChosseAnswer[h][n].sort().toString()==r.toString()?(t.state.trueNum++,t.setState({trueNum:t.state.trueNum}),t.state.trueLV=t.state.trueNum/t.state.allNumbers*100,t.state.trueLV=t.state.trueLV.toFixed(0),t.setState({trueLV:t.state.trueLV})):((0,c.default)(new d.default(t.state.studentNumbers)),t.state.trueLV=t.state.trueNum/t.state.allNumbers*100,t.state.trueLV=t.state.trueLV.toFixed(0),t.setState({trueLV:t.state.trueLV}))}(m)}},{key:"_loadTableDescArray",value:function(e){var t=[],a=(0,c.default)(new d.default(this.state.crr));a=a.sort();for(var n in e){var i=n+"0",r=n+"1",s=n+"2",o=e[n][r].toString()==a.toString(),l=parseInt(e[n][s]/60)<10?"0"+parseInt(e[n][s]/60):parseInt(e[n][s]/60),u=parseInt(e[n][s]%60)<10?"0"+parseInt(e[n][s]%60):parseInt(e[n][s]%60),h=P.default.createElement("tr",{key:n},P.default.createElement("td",null,e[n][i]),P.default.createElement("td",{className:o?"table-true-result":"table-false-result"},e[n][r]),P.default.createElement("td",null,l,":",u));t.push(h)}return{afterArry:t}}},{key:"_loadTimeDescArray",value:function(e){var t=this,a=[];return e.map(function(e,n){var i=P.default.createElement("li",{className:"answer-teach-lis",key:e.id,style:{background:t.state.initArr[n].sel?"#2196f3":null},onClick:t.changeColor.bind(t,n)},e.name);a.push(i)}),{beforeArray:a}}},{key:"addHandel",value:function(e){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){var t=this.state.initArr.length;if(t>=2&&(this.state.plusStyle="#368bcb",this.state.reduceStyle="#368bcb",this.setState({plusStyle:this.state.plusStyle,reduceStyle:this.state.reduceStyle})),t>7)return this.state.plusStyle="#202C4A",this.setState({plusStyle:this.state.plusStyle}),!1;7==t&&(this.state.plusStyle="#202C4A",this.setState({plusStyle:this.state.plusStyle})),this.liArr[t].sel=!1,this.state.initArr.push(this.liArr[t]),this.setState({optionUl:this.state.optionUl,initArr:this.state.initArr})}}},{key:"reduceHandel",value:function(e){var t=[];if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){var a=this.state.initArr.length;a>=2&&(this.state.plusStyle="#368bcb",this.setState({plusStyle:this.state.plusStyle})),a>=3&&(this.state.initArr.pop(),this.state.reduceStyle="#368bcb",this.setState({reduceStyle:this.state.reduceStyle,plusStyle:this.state.plusStyle})),3==a&&(this.state.reduceStyle="#202C4A",this.setState({reduceStyle:this.state.reduceStyle}));var n=!0,i=!1,s=void 0;try{for(var l,d=(0,m.default)((0,r.default)(this.state.initArr));!(n=(l=d.next()).done);n=!0){var u=l.value,c=(0,o.default)(u,2),h=(c[0],c[1]);t.push(h.sel),t.indexOf(!0)>=0?(this.state.beginStyle="#2196f3",this.setState({beginStyle:this.state.beginStyle})):(this.state.beginStyle="",this.setState({beginStyle:this.state.beginStyle}))}}catch(e){i=!0,s=e}finally{try{!n&&d.return&&d.return()}finally{if(i)throw s}}this.setState({initArr:this.state.initArr})}}},{key:"changeColor",value:function(e,t){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){this.state.crr=[],this.state.initArr[e].sel=!this.state.initArr[e].sel,this.setState({initArr:this.state.initArr,crr:this.state.crr}),0==this.state.initArr[e].sel&&(this.state.beginStyle="",this.setState({beginStyle:this.state.beginStyle}));var a=!0,n=!1,i=void 0;try{for(var r,s=(0,m.default)(this.state.initArr);!(a=(r=s.next()).done);a=!0)r.value.sel&&(this.state.beginStyle="#2196f3",this.setState({beginStyle:this.state.beginStyle}))}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}}},{key:"beginAnswer",value:function(e){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){for(var t=(this.state.initArr.length,0);t<this.state.initArr.length;t++)this.state.initArr[t].sel&&(this.state.crr.push(this.state.initArr[t].name),this.state.crr=(0,c.default)(new d.default(this.state.crr)),this.setState({crr:this.state.crr}));if(""==e.target.style.background)return!1;this.state.afterArrayA=[],this.state.afterArrayB=[],this.state.afterArrayC=[],this.state.afterArrayD=[],this.state.afterArrayE=[],this.state.afterArrayF=[],this.state.afterArrayG=[],this.state.afterArrayH=[],this.state.resultTeachStyleDisplay="none",this.state.endQuestion="block",this.state.restartQuestion="none",this.state.columnar="block",this.state.tableStyle="none",this.state.publishedWarningColor="#074496",this.state.publishAnswerText=_.default.language.languageData.answers.PublishTheAnswer.text,this.state.xiangQingText=_.default.language.languageData.answers.details.text,this.state.isPublished=!1,this.state.publishedWarning="none",this.setState({publishedWarningColor:this.state.publishedWarningColor,columnar:this.state.columnar,tableStyle:this.state.tableStyle,publishedWarning:this.state.publishedWarning,isPublished:this.state.isPublished,xiangQingText:this.state.xiangQingText,publishAnswerText:this.state.publishAnswerText,answerTeachWrapDiv:"none",resultTeachDisplay:"block",resultTeachStyleDisplay:this.state.resultTeachStyleDisplay,endQuestion:this.state.endQuestion,restartQuestion:this.state.restartQuestion,afterArray:this.state.afterArray,afterArrayA:this.state.afterArrayA,afterArrayB:this.state.afterArrayB,afterArrayC:this.state.afterArrayC,afterArrayD:this.state.afterArrayD,afterArrayE:this.state.afterArrayE,afterArrayF:this.state.afterArrayF,afterArrayG:this.state.afterArrayG,afterArrayH:this.state.afterArrayH,trueLV:this.state.trueLV,allNumbers:this.state.allNumbers,idA:this.state.idA,idB:this.state.idB,idC:this.state.idC,idD:this.state.idD,idE:this.state.idE,idF:this.state.idF,idG:this.state.idG,idH:this.state.idH}),clearInterval(this.stop),document.getElementById("result-teach-mytime").textContent="00:00:00",this.trueArr(),this.time_fun();var a=!0,n=!1,i=void 0;try{for(var r,s=(0,m.default)(this.state.initArr);!(a=(r=s.next()).done);a=!0)r.value.sel=!1,this.setState({initArr:this.state.initArr})}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}this.state.isShow=!1,this.setState({isShow:this.state.isShow});var o=this.state.isShow,l=this.state.round,u=this.state.initArr,h=this.state.brr,g=this.state.trueLV,f=this.state.allNumbers,p=this.state.allStudentChosseAnswer,v=this.state.tableObject,b=this.state.idA,y=this.state.idB,S=this.state.idC,k=this.state.idD,w=this.state.idE,C=this.state.idF,T=this.state.idG,P=this.state.idH,A=this.state.isPublished,D=document.getElementById("result-teach-mytime").textContent,E=(0,c.default)(new d.default(this.state.crr));E=E.sort();var x={optionalAnswers:u,quizTimes:D,rightAnswers:E,isRound:l,studentSelect:h,trueLV:g,allNumbers:f,dataChoose:p,dataTable:v,isPublished:A,idAS:b,idBS:y,idCS:S,idDS:k,idES:w,idFS:C,idGS:T,idHS:P,isShow:o};F.default.sendSignallingAnswerToStudent(x),this.coordArr(this.state.initArr),this.coordArrX(this.state.initArr)}}},{key:"coordArrX",value:function(e){this.state.allResultX=e.map(function(t,a){return P.default.createElement("li",{key:a,style:{width:1/e.length*100-5+"%"}},t.name)}),this.setState({allResultX:this.state.allResultX})}},{key:"coordArr",value:function(e){var t=this;this.state.allResult=e.map(function(e,a){return"A"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayA):"B"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayB):"C"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayC):"D"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayD):"E"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayE):"F"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayF):"G"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayG):"H"==e.name?P.default.createElement("li",{key:a,style:{width:"7.5%",left:"0.5%"}},t.state.afterArrayH):void 0}),this.setState({allResult:this.state.allResult})}},{key:"trueArr",value:function(){var e=(0,c.default)(new d.default(this.state.crr));e=e.sort(),this.state.trueSelect=e.map(function(e,t){return P.default.createElement("span",{className:"spans",key:t},e)}),this.setState({trueSelect:this.state.trueSelect})}},{key:"two_char",value:function(e){return e>=10?e:"0"+e}},{key:"time_fun",value:function(){var e=this;e.stop=setInterval(function(){e.setState({numz:e.state.numz+1});var t=new Date(0,0);t.setSeconds(e.state.numz);var a=t.getHours(),n=t.getMinutes(),i=t.getSeconds();document.getElementById("result-teach-mytime").textContent=e.two_char(a)+":"+e.two_char(n)+":"+e.two_char(i)},1e3),e.setState({stop:e.state.stop})}},{key:"endHandel",value:function(){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){clearInterval(this.stop),this.state.endQuestion="none",this.state.restartQuestion="block",this.state.resultTeachStyleDisplay="block",this.state.round=!0,I.default.joinRoomInfo.isShowTheAnswer||(this.state.isPublished=!0),this.setState({endQuestion:this.state.endQuestion,restartQuestion:this.state.restartQuestion,round:this.state.round,resultTeachStyleDisplay:this.state.resultTeachStyleDisplay,isPublished:this.state.isPublished}),this.state.isShow=!1,this.setState({isShow:this.state.isShow});var e=this.state.isShow,t=document.getElementById("result-teach-mytime").textContent,a=this.state.initArr,n=(0,c.default)(new d.default(this.state.crr)),i=n.sort(),r=this.state.brr,s=this.state.trueLV,o=this.state.round,l=this.state.allNumbers,u=this.state.allStudentChosseAnswer,h=this.state.tableObject,m=this.state.isPublished,g=this.state.idA,f=this.state.idB,p=this.state.idC,v=this.state.idD,b=this.state.idE,y=this.state.idF,S=this.state.idG,k=this.state.idH,w={optionalAnswers:a,quizTimes:t,rightAnswers:i,isRound:o,studentSelect:r,trueLV:s,allNumbers:l,dataChoose:u,dataTable:h,isPublished:m,idAS:g,idBS:f,idCS:p,idDS:v,idES:b,idFS:y,idGS:S,idHS:k,isShow:e};F.default.sendSignallingAnswerToStudent(w),this.state.isPublished=!0,this.setState({isPublished:this.state.isPublished})}}},{key:"restartHandel",value:function(){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){this.clearTeacherShowData(),clearInterval(this.stop),document.getElementById("result-teach-mytime").textContent="00:00:00",this.state.initArr=[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],this.state.allStudentName=[],this.state.tableArry=[],this.state.allStudentChosseAnswer={},this.state.round=!1,this.state.crr=[],this.state.brr=[],this.state.trueLV=0,this.state.allNumbers=0,this.state.studentNumbers=[],this.state.tableObject={},this.state.isPublished=!1,this.state.publishAnswerText="",this.state.allResult="",this.setState({allResult:this.state.allResult,publishAnswerText:this.state.publishAnswerText,tableObject:this.state.tableObject,tableArry:this.state.tableArry,allStudentChosseAnswer:this.state.allStudentChosseAnswer,studentNumbers:this.state.studentNumbers,brr:this.state.brr,crr:this.state.crr,trueLV:this.state.trueLV,allNumbers:this.state.allNumbers,answerTeachWrapDiv:"block",allStudentName:this.state.allStudentName,round:this.state.round,initArr:this.state.initArr,isPublished:this.state.isPublished}),this.state.isShow=!0,this.setState({isShow:this.state.isShow});var e=this.state.isShow,t=document.getElementById("result-teach-mytime").textContent,a=this.state.initArr,n=(0,c.default)(new d.default(this.state.crr)),i=n.sort(),r=this.state.brr,s=this.state.trueLV,o=this.state.round,l=this.state.allNumbers,u=this.state.allStudentChosseAnswer,h=this.state.tableObject,m=this.state.isPublished,g=this.state.idA,f=this.state.idB,p=this.state.idC,v=this.state.idD,b=this.state.idE,y=this.state.idF,S=this.state.idG,k=this.state.idH,w={optionalAnswers:a,quizTimes:t,rightAnswers:i,isRound:o,studentSelect:r,trueLV:s,allNumbers:l,dataChoose:u,dataTable:h,isPublished:m,idAS:g,idBS:f,idCS:p,idDS:v,idES:b,idFS:y,idGS:S,idHS:k,isShow:e},C=!0;F.default.sendSignallingAnswerToStudent(w,C),C=!1,F.default.sendSignallingAnswerToStudent(w,C)}}},{key:"publishAnswerHandel",value:function(e){if(0==this.state.isPublished)return this.state.publishedWarning="block",this.setState({publishedWarning:this.state.publishedWarning}),!1;e.target.textContent=_.default.language.languageData.answers.published.text,this.state.publishedWarningColor="#3C75BB",this.state.publishedWarning="none",this.setState({publishAnswerText:this.state.publishAnswerText,publishedWarning:this.state.publishedWarning,publishedWarningColor:this.state.publishedWarningColor});var t=this.state.isShow,a=document.getElementById("result-teach-mytime").textContent,n=this.state.initArr,i=(0,c.default)(new d.default(this.state.crr)),r=i.sort(),s=this.state.brr,o=this.state.trueLV,l=this.state.round,u=this.state.allNumbers,h=this.state.allStudentChosseAnswer,m=this.state.tableObject,g=this.state.isPublished,f=this.state.idA,p=this.state.idB,v=this.state.idC,b=this.state.idD,y=this.state.idE,S=this.state.idF,k=this.state.idG,w=this.state.idH,C={optionalAnswers:n,quizTimes:a,rightAnswers:r,isRound:l,studentSelect:s,trueLV:o,allNumbers:u,dataChoose:h,dataTable:m,isPublished:g,idAS:f,idBS:p,idCS:v,idDS:b,idES:y,idFS:S,idGS:k,idHS:w,isShow:t};F.default.sendSignallingAnswerToStudent(C)}},{key:"xiangQingHandel",value:function(){this.state.isXiangQing=!this.state.isXiangQing,this.state.publishedWarning="none",this.setState({isXiangQing:this.state.isXiangQing,publishedWarning:this.state.publishedWarning}),this.state.isXiangQing?(this.state.columnar="none",this.state.tableStyle="block",this.state.xiangQingText=_.default.language.languageData.answers.statistics.text,this.setState({columnar:this.state.columnar,tableStyle:this.state.tableStyle,xiangQingText:this.state.xiangQingText})):(this.state.columnar="block",this.state.tableStyle="none",this.state.xiangQingText=_.default.language.languageData.answers.details.text,this.setState({columnar:this.state.columnar,tableStyle:this.state.tableStyle,xiangQingText:this.state.xiangQingText}))}},{key:"clearTeacherShowData",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,i=(0,m.default)(this.state.initArr);!(e=(n=i.next()).done);e=!0)n.value.sel=!1}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}clearInterval(this.stop),this.state.trueNum=0,this.state.numz=0,this.state.brr=[],this.state.crr=[],this.state.afterArrayA=[],this.state.afterArrayB=[],this.state.afterArrayC=[],this.state.afterArrayD=[],this.state.afterArrayE=[],this.state.afterArrayF=[],this.state.afterArrayG=[],this.state.afterArrayH=[],this.state.afterArray=[],this.state.studentNumbers=[],this.state.allStudentName=[],this.state.tableObject={},this.state.trueLV=0,this.state.allNumbers=0,this.state.idA=[],this.state.idB=[],this.state.idC=[],this.state.idD=[],this.state.idE=[],this.state.idF=[],this.state.idG=[],this.state.idH=[],this.state.tableArry=[],this.state.initArr=[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],document.getElementById("result-teach-mytime").textContent="00:00:00",this.state.endQuestion="block",this.state.restartQuestion="none",this.state.beginStyle="",this.state.plusStyle="#368bcb",this.state.reduceStyle="#368bcb",this.state.publishedWarning="none",this.setState({numz:this.state.numz,publishedWarning:this.state.publishedWarning,tableObject:this.state.tableObject,tableArry:this.state.tableArry,endQuestion:this.state.endQuestion,studentNumbers:this.state.studentNumbers,restartQuestion:this.state.restartQuestion,answerTeachWrapDiv:this.state.answerTeachWrapDiv,resultTeachDisplay:"none",beginStyle:this.state.beginStyle,brr:this.state.brr,crr:this.state.crr,initArr:this.state.initArr,afterArray:this.state.afterArray,afterArrayA:this.state.afterArrayA,afterArrayB:this.state.afterArrayB,afterArrayC:this.state.afterArrayC,afterArrayD:this.state.afterArrayD,afterArrayE:this.state.afterArrayE,afterArrayF:this.state.afterArrayF,afterArrayG:this.state.afterArrayG,afterArrayH:this.state.afterArrayH,trueLV:this.state.trueLV,allNumbers:this.state.allNumbers,idA:this.state.idA,idB:this.state.idB,idC:this.state.idC,idD:this.state.idD,idE:this.state.idE,idF:this.state.idF,idG:this.state.idG,idH:this.state.idH,trueNum:this.state.trueNum,plusStyle:this.state.plusStyle,reduceStyle:this.state.plusStyle})}},{key:"answerTeachCloseHandel",value:function(){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){this.clearTeacherShowData();var e=!0,t=!1,a=void 0;try{for(var n,i=(0,m.default)(this.state.initArr);!(e=(n=i.next()).done);e=!0)n.value.sel=!1}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}clearInterval(this.stop),this.state.allStudentChosseAnswer={},this.state.tableObject={},this.state.tableArry=[],document.getElementById("result-teach-mytime").textContent="00:00:00",this.state.round=!1,this.state.plusStyle="#368bcb",this.state.reduceStyle="#368bcb",this.state.endQuestion="block",this.state.restartQuestion="none",this.state.crr=[],this.state.trueSelect="",this.state.beginStyle="",this.state.trueLV=0,this.state.allNumbers=0,this.state.initArr=[{id:0,name:"A",sel:!1},{id:1,name:"B",sel:!1},{id:2,name:"C",sel:!1},{id:3,name:"D",sel:!1}],this.state.isPublished=!1,this.state.publishAnswerText=_.default.language.languageData.answers.PublishTheAnswer.text,this.state.publishedWarning="none",this.setState({publishedWarning:this.state.publishedWarning,publishAnswerText:this.state.publishAnswerText,isPublished:this.state.isPublished,tableObject:this.state.tableObject,tableArry:this.state.tableArry,allStudentChosseAnswer:this.state.allStudentChosseAnswer,answerTeachWrapDiv:"none",initArr:this.state.initArr,beginStyle:this.state.beginStyle,plusStyle:this.state.plusStyle,trueLV:this.state.trueLV,allNumbers:this.state.allNumbers,reduceStyle:this.state.plusStyle,crr:this.state.crr,trueSelect:this.state.trueSelect,endQuestion:this.state.endQuestion,restartQuestion:this.state.restartQuestion,round:this.state.round});var r={answerClose:"none"};F.default.sendSignallingAnswerToStudent(r,!0)}}},{key:"resultTeachCloseHandel",value:function(){if(I.default.hasRole.roleChairman||I.default.hasRole.roleTeachingAssistant){this.clearTeacherShowData(),clearInterval(this.stop),this.state.round=!1,this.state.allStudentChosseAnswer={},this.state.tableObject={},this.state.tableArry=[],this.state.isPublished=!1,document.getElementById("result-teach-mytime").textContent="00:00:00",this.state.plusStyle="#368bcb",this.state.reduceStyle="#368bcb",this.state.endQuestion="block",this.state.restartQuestion="none",this.state.crr=[],this.state.trueSelect="",this.state.trueLV=0,this.state.allNumbers=0,this.state.publishAnswerText=_.default.language.languageData.answers.PublishTheAnswer.text,this.state.publishedWarning="none",this.setState({publishedWarning:this.state.publishedWarning,isPublished:this.state.isPublished,publishAnswerText:this.state.publishAnswerText,tableObject:this.state.tableObject,tableArry:this.state.tableArry,allStudentChosseAnswer:this.state.allStudentChosseAnswer,resultTeachDisplay:"none",plusStyle:this.state.plusStyle,round:this.state.round,trueLV:this.state.trueLV,allNumbers:this.state.allNumbers,reduceStyle:this.state.plusStyle,crr:this.state.crr,trueSelect:this.state.trueSelect,endQuestion:this.state.endQuestion,restartQuestion:this.state.restartQuestion});var e={answerClose:"none"};F.default.sendSignallingAnswerToStudent(e,!0)}}},{key:"render",value:function(){var e=this.state,t=e.initArr,a=(e.brr,e.tableObject),n=e.resizeInfo,i=this.props,r=i.id,s=i.answerDrag,o=i.draggableData,l=this._loadTimeDescArray(t),d=l.beforeArray,u=this._loadTableDescArray(a),c=u.afterArry,h={position:"absolute",zIndex:130,display:"inline-block",left:0,top:0},m=Object.customAssign({id:r,size:n,percentPosition:{percentLeft:s.percentLeft,percentTop:s.percentTop}},o);return P.default.createElement(H.default,m,P.default.createElement("div",{id:"answerDrag",style:h},P.default.createElement("div",{className:"answer-teach-wrapDiv touch-select-select ",style:{display:this.state.answerTeachWrapDiv},ref:"dragBox"},P.default.createElement("div",{className:"answer-teach-header"},P.default.createElement("div",{className:"answer-teach-header-left"},P.default.createElement("span",{className:"answer-teach-headerImg"}),P.default.createElement("span",{className:"answer-teach-header-left-grey"},_.default.language.languageData.answers.headerTopLeft.text),P.default.createElement("span",{className:"answer-teach-header-left-green"},_.default.language.languageData.answers.headerMiddel.text)),P.default.createElement("div",{className:"answer-teach-header-right",onClick:this.answerTeachCloseHandel.bind(this)})),P.default.createElement("div",{className:"answer-teach-content"},P.default.createElement("ul",{className:"answer-teach-optionUl"},d),P.default.createElement("div",{className:"answer-teach-add",ref:"addDiv",onClick:this.addHandel.bind(this),style:{background:this.state.plusStyle}},"+"),P.default.createElement("div",{className:"answer-teach-reduce",ref:"reduceDiv",onClick:this.reduceHandel.bind(this),style:{background:this.state.reduceStyle}},"-"),P.default.createElement("div",{className:"answer-teach-begin",onClick:this.beginAnswer.bind(this),style:{background:this.state.beginStyle}},_.default.language.languageData.answers.beginAnswer.text))),P.default.createElement("div",{className:"result-teach-wrapDiv",style:{display:this.state.resultTeachDisplay},ref:"resultRef"},P.default.createElement("div",{className:"result-teach-header"},P.default.createElement("div",{className:"result-teach-header-left"},P.default.createElement("span",{className:"result-teach-headerImg"}),P.default.createElement("span",{className:"result-teach-header-left-grey"},_.default.language.languageData.answers.headerTopLeft.text),P.default.createElement("span",{id:"result-teach-mytime"})),P.default.createElement("p",{className:"result-teach-close",onClick:this.resultTeachCloseHandel.bind(this),style:{display:this.state.resultTeachStyleDisplay}})),P.default.createElement("div",{className:"result-teach-content"},P.default.createElement("p",{className:"answersPeople"},_.default.language.languageData.answers.numberOfAnswer.text,":",P.default.createElement("span",{ref:"anss"},this.state.allNumbers),P.default.createElement("span",{className:"xiang-qing-div",onClick:this.xiangQingHandel.bind(this)},"(",this.state.xiangQingText,")")),P.default.createElement("span",{className:"result-teach-accuracy-right"},P.default.createElement("span",{className:"result-teach-accuracy-right-text"},_.default.language.languageData.answers.tureAccuracy.text,"："),P.default.createElement("span",{style:{color:"red"}},this.state.trueLV,"%")),P.default.createElement("div",{className:"result-teach-coordinate-div",style:{display:this.state.columnar}},P.default.createElement("span",{className:"result-teach-heart-span"},"0"),P.default.createElement("div",{className:"result-teach-staff-div"},P.default.createElement("ul",{className:"result-student-allResult"},this.state.allResult)),P.default.createElement("ul",{className:"result-teach-allResult"},this.state.allResultX)),P.default.createElement("div",{className:"answer-table-div",style:{display:this.state.tableStyle}},P.default.createElement("table",{className:"answer-table"},P.default.createElement("tbody",null,P.default.createElement("tr",{className:"answer-table-first-tr"},P.default.createElement("th",null,_.default.language.languageData.answers.student.text),P.default.createElement("th",null,_.default.language.languageData.answers.TheSelectedTheAnswer.text),P.default.createElement("th",null,_.default.language.languageData.answers.AnswerTime.text)),c))),P.default.createElement("div",{className:"result-teach-true-result"},P.default.createElement("span",{style:{color:"white"}},_.default.language.languageData.answers.trueAnswer.text,":"),P.default.createElement("span",{className:"result-teach-trueSelect"},this.state.trueSelect),P.default.createElement("span",{className:"result-teach-published-warning",style:{display:this.state.publishedWarning}},_.default.language.languageData.answers.end.text),P.default.createElement("span",{className:"publish-the-answer",onClick:this.publishAnswerHandel.bind(this),style:{background:this.state.publishedWarningColor,display:I.default.joinRoomInfo&&I.default.joinRoomInfo.isShowTheAnswer?"block":"none"}},this.state.publishAnswerText)),P.default.createElement("div",{className:"result-teach-end-question",style:{display:this.state.endQuestion},onClick:this.endHandel.bind(this)},_.default.language.languageData.answers.endAnswer.text),P.default.createElement("div",{className:"result-teach-restart-question",style:{display:this.state.restartQuestion},onClick:this.restartHandel.bind(this)},_.default.language.languageData.answers.restarting.text)))))}}]),t}(P.default.Component);t.default=U},oNmr:function(e,t,a){a("9Bbf")("Set")},oeOm:function(e,t,a){var n=a("7Doy");e.exports=function(e,t){return new(n(e))(t)}},pPW7:function(e,t,a){a("M6a0"),a("zQR9"),a("+tPU"),a("ttyz"),a("BDhv"),a("oNmr"),a("ioQ5"),e.exports=a("FeBl").Set},pRCB:function(e,t,a){var n=a("kM2E");n(n.S+n.F*!a("+E39"),"Object",{defineProperties:a("qio6")})},ppOE:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={header:{tool:{blackBoard:{title:{open:"小白板",close:"关闭",prev:"上一位",next:"下一位",shrink:"缩小"},content:{blackboardHeadTitle:"小白板"},toolBtn:{dispenseed:"分发",recycle:"回收",againDispenseed:"再次分发",commonTeacher:"老师"},tip:{saveImage:"是否保存白板"},boardTool:{pen:"笔",text:"文字",eraser:"橡皮",color:"颜色及粗细"}},sharing:{title:"屏幕共享"},mouse:{title:"鼠标"},pencil:{title:"笔",pen:{text:"铅笔工具"},Highlighter:{text:"荧光笔工具"},linellae:{text:"线条工具"},arrow:{text:"箭头工具"},laser:{title:"激光笔",text:"激光笔工具"}},text:{title:"文字",Msyh:{text:"微软雅黑"},Ming:{text:"宋体"},Arial:{text:"Arial"}},shape:{title:"形状",outlinedRectangle:{text:"空心矩形"},filledRectangle:{text:"矩形"},outlinedCircle:{text:"空心椭圆"},filledCircle:{text:"椭圆"}},eraser:{title:"橡皮擦"},undo:{title:"撤销"},redo:{title:"恢复"},clear:{title:"清屏"},tool_zoom_big:{title:"放大"},tool_zoom_small:{title:"缩小"},tool_rotate_left:{title:"逆时针旋转"},tool_rotate_right:{title:"顺时针旋转"},colorAndMeasure:{title:"颜色及粗细",selectColorText:"选择颜色",selectMeasure:"选择粗细"},colors:{title:"颜色"},measure:{title:"粗细"}},page:{prev:{text:"上一页"},next:{text:"下一页"},add:{text:"加页"},lcFullBtn:{title:"绘制区域全屏"},pptFullBtn:{title:"PPT全屏"},h5FileFullBtn:{title:"h5课件全屏"},skipPage:{text_one:"至第",text_two:"页"},ok:{text:"确定"},coursewareRemarks:{title:"课件备注"}},volume:{title:"音量"}},alertWin:{ok:{showError:{text:"确定"},showPrompt:{text:"确定"},showConfirm:{cancel:"取消",ok:"确定"}},title:{showError:{text:"错误信息"},showPrompt:{text:"提示信息"},showConfirm:{text:"确认消息"}},call:{fun:{page:{pageInteger:{text:"输入的页数必须是整数！"},pageMax:{text:"输入的页数不能超过最大页数！"},pageMin:{text:"输入的页数不能小于1"}}}}},toolCase:{toolBox:{text:"工具箱"}},timers:{timerSetInterval:{text:"计时器"},timerBegin:{text:"开始"},timerStop:{text:"暂停"},again:{text:"重新开始"}},dial:{turntable:{text:"转盘"}},answers:{headerTopLeft:{text:"答题器"},headerMiddel:{text:"点击字母预设正确答案"},beginAnswer:{text:"开始答题"},tureAccuracy:{text:"正确率"},trueAnswer:{text:"正确答案"},endAnswer:{text:"结束答题"},restarting:{text:"重新开始"},myAnswer:{text:"我的答案"},changeAnswer:{text:"修改答案"},selectAnswer:{text:"请至少选择一个答案"},submitAnswer:{text:"提交答案"},numberOfAnswer:{text:"答题人数"},PublishTheAnswer:{text:"公布答案"},published:{text:"已公布"},details:{text:"详情"},statistics:{text:"统计"},student:{text:"学生"},TheSelectedTheAnswer:{text:"所选答案"},AnswerTime:{text:"答题用时"},end:{text:"请先结束答题"}},responder:{responder:{text:"抢答器"},begin:{text:"开始抢答"},restart:{text:"重新开始"},close:{text:"关闭"},update:{text:"当前浏览器不支持canvas组件请升级！"},inAnswer:{text:"抢答中"},answer:{text:"抢答"},noContest:{text:"无人抢答"}},call:{fun:{page:{pageInteger:{text:"输入的页数必须是整数！"},pageMax:{text:"输入的页数不能超过最大页数！"},pageMin:{text:"输入的页数不能小于1"}}}},coursewareRemarks:{remarks:"备注",close:"关闭"},reloadDoucumentHint:{one:"当前网络不稳定，正在尝试重新打开课件……第",two:"次"}};t.default=n},ptxU:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("T6+d"),v=n(p),b=a("K9xZ"),y=n(b),S=a("T+56"),k=n(S),w=a("DrPG"),C=(n(w),a("HUPQ")),T=n(C),P=a("EXAz"),A=n(P),D=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return a.props.id,a.state={updateState:!1},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){k.default.CoreController.addEventListener(TkConstant.EVENTTYPE.RoomEvent.roomConnected,this.handlerRoomConnected.bind(this),this.listernerBackupid)}},{key:"componentWillUnmount",value:function(){var e=this;k.default.CoreController.removeBackupListerner(e.listernerBackupid)}},{key:"setDefaultPosition",value:function(){var e=this.props,t=e.id,a=e.draggableData,n=T.default.windowInnerWidth/TkConstant.STANDARDSIZE,i=document.getElementById(t),r=document.querySelector(a.dragBounds);if(i&&r){var s="phone"===T.default.mobileDeviceType?(r.offsetWidth-i.offsetWidth)/2:r.offsetWidth-.8*n,o="phone"===T.default.mobileDeviceType?.25*n:.2*n,l="phone"===T.default.mobileDeviceType?.5:s/(r.offsetWidth-i.offsetWidth),d=o/(r.offsetHeight-i.offsetHeight);l=isNaN(l)||null===l||l<0?0:l,d=isNaN(d)||null===d||d<0?0:d,a.changePosition&&"function"==typeof a.changePosition&&a.changePosition(t,{left:s,top:o,percentLeft:l,percentTop:d,isDrag:!0},!1)}}},{key:"handlerRoomConnected",value:function(){this.setState({updateState:!this.state.updateState})}},{key:"render",value:function(){var e=this,t=e.props,a=t.id,n=t.lcToolContainer,i=t.draggableData,r=T.default.windowInnerWidth/TkConstant.STANDARDSIZE,s=Object.customAssign({id:a,percentPosition:{percentLeft:n.percentLeft,percentTop:n.percentTop}},i);return f.default.createElement(A.default,s,f.default.createElement("div",{id:a,className:"lc-tool-container clear-float tk-tool-right "+("phone"===T.default.mobileDeviceType?"phone ":"pc pad ")},"phone"===T.default.mobileDeviceType?void 0:f.default.createElement(v.default,{left:n.isDrag?n.left/r:void 0,parentId:"lc_tool_container"}),f.default.createElement(y.default,{left:n.isDrag?n.left/r:void 0,parentId:"lc_tool_container",setDefaultPosition:this.setDefaultPosition.bind(this)})))}}]),t}(f.default.Component);t.default=D},qkKv:function(e,t,a){var n=a("FeBl"),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},qo66:function(e,t,a){"use strict";var n=a("7KvD"),i=a("kM2E"),r=a("06OY"),s=a("S82l"),o=a("hJx8"),l=a("xH/j"),d=a("NWt+"),u=a("2KxR"),c=a("EqjI"),h=a("e6n0"),m=a("evD5").f,g=a("ALrJ")(0),f=a("+E39");e.exports=function(e,t,a,p,v,b){var y=n[e],S=y,k=v?"set":"add",w=S&&S.prototype,C={};return f&&"function"==typeof S&&(b||w.forEach&&!s(function(){(new S).entries().next()}))?(S=t(function(t,a){u(t,S,e,"_c"),t._c=new y,void 0!=a&&d(a,v,t[k],t)}),g("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in w&&(!b||"clear"!=e)&&o(S.prototype,e,function(a,n){if(u(this,S,e),!t&&b&&!c(a))return"get"==e&&void 0;var i=this._c[e](0===a?0:a,n);return t?this:i})}),b||m(S.prototype,"size",{get:function(){return this._c.size}})):(S=p.getConstructor(t,e,v,k),l(S.prototype,a),r.NEED=!0),h(S,e),C[e]=S,i(i.G+i.W+i.F,C),b||p.setStrong(S,e,v),S}},qyJz:function(e,t,a){"use strict";var n=a("+ZMJ"),i=a("kM2E"),r=a("sB3e"),s=a("msXi"),o=a("Mhyx"),l=a("QRG4"),d=a("fBQ2"),u=a("3fs2");i(i.S+i.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,i,c,h=r(e),m="function"==typeof this?this:Array,g=arguments.length,f=g>1?arguments[1]:void 0,p=void 0!==f,v=0,b=u(h);if(p&&(f=n(f,g>2?arguments[2]:void 0,2)),void 0==b||m==Array&&o(b))for(t=l(h.length),a=new m(t);t>v;v++)d(a,v,p?f(h[v],v):h[v]);else for(c=b.call(h),a=new m;!(i=c.next()).done;v++)d(a,v,p?s(c,f,[i.value,v],!0):i.value);return a.length=v,a}})},rPQW:function(e,t){},rkp3:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("g4PW"),r=n(i),s=a("W3Iv"),o=n(s),l=a("BO1k"),d=n(l),u=a("d7EF"),c=n(u),h=a("Dd8w"),m=n(h),g=a("bOdI"),f=n(g),p=a("Zx67"),v=n(p),b=a("Zrlr"),y=n(b),S=a("wxAW"),k=n(S),w=a("zwoO"),C=n(w),T=a("Pf15"),P=n(T),A=a("GiK3"),D=n(A),_=a("yE5a"),E=n(_),I=a("T+56"),x=n(I),B=a("HUPQ"),R=n(B),L=a("Sa83"),N=(n(L),a("YRCL")),W=n(N),M=a("DrPG"),F=(n(M),a("eldM")),O=n(F),H=a("2pGZ"),U=n(H),z=a("P0xP"),j=n(z),V=a("3oJH"),K=n(V),Q=a("eLkf"),Y=n(Q),G=a("ptxU"),Z=n(G),J=a("Z5jD"),q=n(J),$=a("CnnV"),X=n($),ee=a("iCxh"),te=n(ee),ae=a("oKdf"),ne=n(ae),ie=a("0quu"),re=n(ie),se=a("hHPy"),oe=n(se),le=a("Um+6"),de=n(le),ue=a("/Ml/"),ce=n(ue),he=a("yms7"),me=n(he),ge=function(e){function t(e){(0,y.default)(this,t);var a=(0,C.default)(this,(t.__proto__||(0,v.default)(t)).call(this,e));return a.state={updateState:!1,mainContentLayerIsShow:!1,captureImgInfos:{},selectMouse:!0,dragPosition:{},eleResizeInfos:{},useToolInfo:{useToolKey:"tool_pencil",useToolColor:"#FF0000",blackboardToolsInfo:{pencil:5,text:18,eraser:30,shape:5}}},a.listCaptureImgResizeArray=null,a.eleInitResizeInfos={},a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,P.default)(t,e),(0,k.default)(t,[{key:"componentWillMount",value:function(){this.initDragData()}},{key:"componentDidMount",value:function(){var e=this;x.default.CoreController.addEventListener("mobileDeviceTypefrom_mobileSdk_setInitPageParameterFormPhone",this.handlerMobileDeviceTypefrom_mobileSdk_setInitPageParameterFormPhone.bind(this),this.listernerBackupid),x.default.CoreController.addEventListener("mobileDeviceTypefrom_mobileSdk_changeInitPageParameterFormPhone",this.handlerMobileDeviceTypefrom_mobileSdk_changeInitPageParameterFormPhone.bind(this),this.listernerBackupid),x.default.CoreController.addEventListener(TkConstant.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener(TkConstant.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-DialDrag",e.handlerMsglistDialDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-TimerDrag",e.handlerMsglistTimerDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-AnswerDrag",e.handlerMsglistAnswerDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-ResponderDrag",e.handlerMsglistResponderDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-CaptureImg",e.handlerMsglistCaptureImg.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-CaptureImgDrag",e.handlerMsglistCaptureImgDrag.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("receive-msglist-CaptureImgResize",e.handlerMsglistCaptureImgResize.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("updateSelectMouse",e.handlerUpdateSelectMouse.bind(e),e.listernerBackupid),x.default.CoreController.addEventListener("changeStrokeSize",this.handlerChangeStrokeSize.bind(this),this.listernerBackupid),x.default.CoreController.addEventListener("changeStrokeColor",this.handlerChangeStrokeColor.bind(this),this.listernerBackupid),x.default.CoreController.addEventListener("whiteboard_activeCommonWhiteboardTool",this.changeUseToolKey.bind(this),this.listernerBackupid),E.default.getTkRoom()&&E.default.getTkRoom().onPageFinished&&E.default.getTkRoom().onPageFinished()}},{key:"componentWillUnmount",value:function(){x.default.CoreController.removeBackupListerner(this.listernerBackupid)}},{key:"handlerRoomPubmsg",value:function(e){var t=e.message;switch(t.name){case"DialDrag":Object.customAssign(this.state.dialDrag,t.data),this.setState({dialDrag:this.state.dialDrag});break;case"TimerDrag":Object.customAssign(this.state.timerDrag,t.data),Object.customAssign(this.state.studentTimerDrag,t.data),this.setState({timerDrag:this.state.timerDrag,studentTimerDrag:this.state.studentTimerDrag});break;case"AnswerDrag":Object.customAssign(this.state.answerDrag,t.data),Object.customAssign(this.state.studentAnswerDrag,t.data),this.setState({answerDrag:this.state.answerDrag,studentAnswerDrag:this.state.studentAnswerDrag});break;case"ResponderDrag":Object.customAssign(this.state.responderDrag,t.data),Object.customAssign(this.state.studentResponderDrag,t.data),this.setState({responderDrag:this.state.responderDrag,studentResponderDrag:this.state.studentResponderDrag});break;case"CaptureImgDrag":t.data.position&&t.data.id&&this.state[t.data.id]&&this.setState((0,f.default)({},t.data.id,Object.customAssign({},t.data.position)));break;case"CaptureImg":if(t.data.captureImgInfo&&t.data.remSize){var a=window.innerWidth/TkConstant.STANDARDSIZE,n=t.data.remSize,i="captureImg_"+t.data.captureImgInfo.fileid,r={width:n.width*a,height:n.height*a};this.setInitResize(i,r,.04);var s=t.data.captureImgInfo;this.handleCaptureImg(s)}break;case"CaptureImgResize":if(t.data.scale&&t.data.id){var o=t.data.scale;if(this.state.eleResizeInfos&&this.eleInitResizeInfos){var l=this.eleInitResizeInfos[t.data.id],d=l.width,u=l.height,c=d*o,h=u*o;this.state.eleResizeInfos[t.data.id]={width:c,height:h},this.setState({eleResizeInfos:this.state.eleResizeInfos})}}}}},{key:"handlerRoomDelmsg",value:function(e){var t=e.message;switch(t.name){case"CaptureImg":if(t.id.startsWith("CaptureImg_")){var a=t.id.split("_")[1],n=(0,m.default)({},this.state.captureImgInfos);delete n[a],this.setState({captureImgInfos:n})}break;case"ClassBegin":this.setState({captureImgInfos:{}})}}},{key:"handlerMsglistDialDrag",value:function(e){var t=this;e.message.DialDragArray.map(function(e,a){Object.customAssign(t.state.dialDrag,e.data),t.setState({dialDrag:t.state.dialDrag})})}},{key:"handlerMsglistTimerDrag",value:function(e){var t=this;e.message.TimerDragArray.map(function(e,a){Object.customAssign(t.state.timerDrag,e.data),Object.customAssign(t.state.studentTimerDrag,e.data),t.setState({timerDrag:t.state.timerDrag,studentTimerDrag:t.state.studentTimerDrag})})}},{key:"handlerMsglistAnswerDrag",value:function(e){var t=this;e.message.AnswerDragArray.map(function(e,a){Object.customAssign(t.state.answerDrag,e.data),Object.customAssign(t.state.studentAnswerDrag,e.data),t.setState({answerDrag:t.state.answerDrag,studentAnswerDrag:t.state.studentAnswerDrag})})}},{key:"handlerMsglistResponderDrag",value:function(e){var t=this;e.message.ResponderDragArray.map(function(e,a){Object.customAssign(t.state.responderDrag,e.data),Object.customAssign(t.state.studentResponderDrag,e.data),t.setState({responderDrag:t.state.responderDrag,studentResponderDrag:t.state.studentResponderDrag})})}},{key:"handlerMsglistCaptureImg",value:function(e){var t=this,a=e.message.CaptureImgArray,n={};a.map(function(e,a){if(e.data.captureImgInfo){var i=e.data.captureImgInfo,r=i.fileid;n[r]=i,t.setState({captureImgInfos:n});var s=window.innerWidth/TkConstant.STANDARDSIZE,o=e.data.remSize,l="captureImg_"+e.data.captureImgInfo.fileid,d={width:o.width*s,height:o.height*s};t.setInitResize(l,d,.04)}})}},{key:"handlerMsglistCaptureImgDrag",value:function(e){var t=this;e.message.CaptureImgDragArray.map(function(e,a){e.data.position&&e.data.id&&t.state[e.data.id]&&(Object.customAssign(t.state[e.data.id],e.data.position),t.setState((0,f.default)({},e.data.id,t.state[e.data.id])))})}},{key:"handlerMsglistCaptureImgResize",value:function(e){var t=this,a=e.message.CaptureImgResizeArray;a&&a.map(function(e,a){if(e.data.scale&&e.data.id){var n=e.data.scale;if(t.state.eleResizeInfos&&t.eleInitResizeInfos){var i=t.eleInitResizeInfos[e.data.id],r=i.width,s=i.height,o=r*n,l=s*n;t.state.eleResizeInfos[e.data.id]={width:o,height:l},t.setState({eleResizeInfos:t.state.eleResizeInfos})}}})}},{key:"handlerMobileDeviceTypefrom_mobileSdk_setInitPageParameterFormPhone",value:function(){this.setState({updateState:!this.state.updateState})}},{key:"handlerMobileDeviceTypefrom_mobileSdk_changeInitPageParameterFormPhone",value:function(){this.setState({updateState:!this.state.updateState})}},{key:"callAllWrapOnClick",value:function(e){x.default.CoreController.dispatchEvent({type:"callAllWrapOnClick",message:{event:e}})}},{key:"handlerUpdateSelectMouse",value:function(e){var t=e.message.selectMouse;this.setState({selectMouse:t})}},{key:"handleCaptureImg",value:function(e){var t=e.fileid,a=(0,m.default)({},this.state.captureImgInfos);a[t]=e,this.setState({captureImgInfos:a})}},{key:"_getCaptureImgEleArr",value:function(e){var t=[],a=!0,n=!1,i=void 0;try{for(var r,s=(0,d.default)((0,o.default)(e));!(a=(r=s.next()).done);a=!0){var l=r.value,u=(0,c.default)(l,2),h=u[0],m=u[1];this.state["captureImg_"+h]||(this.state["captureImg_"+h]={left:0,top:0,percentLeft:0,percentTop:0,isDrag:!1}),this.state.eleResizeInfos&&!this.state.eleResizeInfos["captureImg_"+h]&&(this.state.eleResizeInfos["captureImg_"+h]={width:0,height:0}),this.eleInitResizeInfos&&!this.eleInitResizeInfos["captureImg_"+h]&&(this.eleInitResizeInfos["captureImg_"+h]={width:0,height:0,eleInitResizeInfos:1});var g={percentPosition:this.state["captureImg_"+h],defaultSize:this.eleInitResizeInfos["captureImg_"+h],size:this.state.eleResizeInfos["captureImg_"+h],changeEleReSize:this.changeEleReSize.bind(this),onPanStart:this.onPanStart.bind(this),onPanEnd:this.onPanEnd.bind(this),onPinchStart:this.onPinchStart.bind(this),onPinch:this.onPinch.bind(this),onPinchEnd:this.onPinchEnd.bind(this)};t.push(D.default.createElement(me.default,{key:h,id:"captureImg_"+h,captureImgInfo:m,dragData:g,useToolInfo:this.state.useToolInfo,sendSignallingOfDrag:this.sendSignallingOfDrag.bind(this),changeLayerIsShow:this.changeLayerIsShow.bind(this),selectMouse:this.state.selectMouse}))}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}return t}},{key:"handlerChangeStrokeSize",value:function(e){var t=e.message.strokeJson;this.state.useToolInfo.blackboardToolsInfo=t,this.setState({useToolInfo:this.state.useToolInfo})}},{key:"handlerChangeStrokeColor",value:function(e){var t=e.message.selectColor;this.state.useToolInfo.useToolColor="#"+t,this.setState({useToolInfo:this.state.useToolInfo})}},{key:"changeUseToolKey",value:function(e){var t=e.message.toolKey;"action_undo"!==t&&"action_redo"!==t&&"action_redo"!==t&&(this.state.useToolInfo.useToolKey=t,this.setState({useToolInfo:this.state.useToolInfo}))}},{key:"changeLayerIsShow",value:function(e){this.setState({mainContentLayerIsShow:e})}},{key:"setInitResize",value:function(e,t,a){var n=(0,m.default)({},t),i=n.width/n.height,r=R.default.windowInnerWidth/TkConstant.STANDARDSIZE,s=void 0,o=void 0;if("pc"===TK.SDKTYPE){var l=document.getElementById("lc-full-vessel");s=l.clientWidth,o=l.clientHeight}else s=R.default.windowInnerWidth,o=R.default.windowInnerHeight;return(n.width>s-2*a*r||n.height>o-2*a*r)&&(i>s/o?(n.width=s-2*a*r,n.height=n.width/i):(n.height=o-2*a*r,n.width=n.height*i)),this.eleInitResizeInfos[e]={width:n.width/r,height:n.height/r,originalResizeScale:i},this.state.eleResizeInfos[e]={width:n.width/r,height:n.height/r},this.setState({eleResizeInfos:this.state.eleResizeInfos}),n}},{key:"changeEleReSize",value:function(e,t){this.state.eleResizeInfos[e]=t,this.setState({eleResizeInfos:this.state.eleResizeInfos})}},{key:"sendSignallingOfResize",value:function(e){if(e.startsWith("captureImg_")){var t=e.split("_")[1],a={id:e,scale:this.state.eleResizeInfos[e].width/this.eleInitResizeInfos[e].width},n="CaptureImgResize_"+t,i="CaptureImg_"+t;W.default.sendSignallingFromCaptureImgResize(a,n,i)}}},{key:"initDragData",value:function(){var e=this;["moreBlackboardDrag","page_wrap","lc_tool_container","timerDrag","studentTimerDrag","dialDrag","answerDrag","studentAnswerDrag","responderDrag","studentResponderDrag","coursewareRemarks"].map(function(t,a){e.state[t]={left:0,top:0,percentLeft:0,percentTop:0,isDrag:!1}})}},{key:"changePosition",value:function(e,t,a){t&&e&&(Object.customAssign(this.state[e],t),this.setState((0,f.default)({},e,this.state[e])),a&&this.sendSignallingOfDrag(e))}},{key:"sendSignallingOfDrag",value:function(e){var t=this.state[e],a=t.percentLeft,n=t.percentTop,i={percentLeft:a,percentTop:n,isDrag:!0};if(e.startsWith("captureImg_")){var r=e.split("_")[1],s={id:e,position:i},o="CaptureImgDrag_"+r,l="CaptureImg_"+r;W.default.sendSignallingFromCaptureImgDrag(s,o,l)}else switch(e){case"timerDrag":case"studentTimerDrag":W.default.sendSignallingFromTimerDrag(i);break;case"moreBlackboardDrag":x.default.CoreController.dispatchEvent({type:"isSendSignallingFromBlackBoardDrag",message:{data:i}});break;case"dialDrag":W.default.sendSignallingFromDialDrag(i);break;case"responderDrag":W.default.sendSignallingFromResponderDrag(i);break;case"answerDrag":W.default.sendSignallingFromAnswerDrag(i)}}},{key:"onPanStart",value:function(e){}},{key:"onPanEnd",value:function(e,t,a,n){!n||""===n||(0,r.default)(this.state[n].percentLeft,a.percentLeft)&&(0,r.default)(this.state[n].percentTop,a.percentTop)||(Object.customAssign(this.state[n],t,a),this.state[n].isDrag=!0,this.setState((0,f.default)({},n,this.state[n])),this.sendSignallingOfDrag(n))}},{key:"onPinchStart",value:function(e){}},{key:"onPinch",value:function(e,t,a){this.changeEleReSize(t,Object.customAssign({},a))}},{key:"onPinchEnd",value:function(e,t,a){this.sendSignallingOfResize(t),this.sendSignallingOfDrag(t)}},{key:"render",value:function(){var e=this,t=this.state,a=t.captureImgInfos,n=t.mainContentLayerIsShow,i={dragBounds:"pc"===TK.SDKTYPE?"#lc-full-vessel":"#tk_app",onPanStart:this.onPanStart.bind(this),onPanEnd:this.onPanEnd.bind(this),changePosition:this.changePosition.bind(this),changeLayerIsShow:this.changeLayerIsShow.bind(this)};return D.default.createElement("section",{className:"app-mobile  all-container "+("phone"===R.default.mobileDeviceType?"phone":"pad"),onTouchStart:this.callAllWrapOnClick.bind(this)},D.default.createElement(O.default,null)," ",D.default.createElement(U.default,{id:"moreBlackboardDrag",blackboardThumbnailImageId:"blackboardThumbnailImageId",blackboardCanvasBackgroundColor:"#ffffff",moreBlackboardDrag:e.state.moreBlackboardDrag,draggableData:i}),D.default.createElement(j.default,{blackboardThumbnailImageId:"blackboardThumbnailImageId",blackboardThumbnailImageBackgroundColor:"#ffffff",blackboardThumbnailImageWidth:"2rem"}),TK&&"mobile"===TK.SDKTYPE&&TK.global&&TK.global.initPageParameterFormPhone&&"AndroidTV"===TK.global.initPageParameterFormPhone.appType?void 0:D.default.createElement(K.default,{id:"page_wrap",pageWrap:e.state.page_wrap,draggableData:i})," ",R.default.playback||TK&&"mobile"===TK.SDKTYPE&&TK.global&&TK.global.initPageParameterFormPhone&&"AndroidTV"===TK.global.initPageParameterFormPhone.appType?void 0:D.default.createElement(Z.default,{id:"lc_tool_container",lcToolContainer:e.state.lc_tool_container,draggableData:i}),D.default.createElement(q.default,{id:"timerDrag",timerDrag:e.state.timerDrag,draggableData:i}),D.default.createElement(X.default,{id:"studentTimerDrag",timerDrag:e.state.studentTimerDrag,draggableData:i}),D.default.createElement(te.default,{id:"dialDrag",dialDrag:e.state.dialDrag,draggableData:i}),D.default.createElement(ne.default,{id:"answerDrag",answerDrag:e.state.answerDrag,draggableData:i}),D.default.createElement(re.default,{id:"studentAnswerDrag",studentAnswerDrag:e.state.studentAnswerDrag,draggableData:i}),D.default.createElement(oe.default,{id:"responderDrag",responderDrag:e.state.responderDrag,draggableData:i}),D.default.createElement(de.default,{id:"studentResponderDrag",studentResponderDrag:e.state.studentResponderDrag,draggableData:i}),D.default.createElement(ce.default,null),D.default.createElement(Y.default,{id:"coursewareRemarks",coursewareRemarks:e.state.coursewareRemarks,draggableData:i}),this._getCaptureImgEleArr(a),D.default.createElement("div",{style:{display:n?"block":"none"},className:"main-content-layer"}))}}]),t}(D.default.Component);t.default=ge},sKCO:function(e,t){},ttyz:function(e,t,a){"use strict";var n=a("9C8M"),i=a("LIJb");e.exports=a("qo66")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},uObV:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),r=n(i),s=a("W3Iv"),o=n(s),l=a("d7EF"),d=n(l),u=a("gRE1"),c=n(u),h=a("BO1k"),m=n(h),g=a("Zrlr"),f=n(g),p=a("wxAW"),v=n(p),b=a("woOf"),y=n(b),S=a("pFYg"),k=n(S);window.L&&window.L.Logger&&window.L.Logger.debug&&window.L.Logger.trace&&window.L.Logger.info&&window.L.Logger.warning&&window.L.Logger.error||(window.L=window.L||{},window.L.Logger=window.L.Logger||{},window.L.Logger.debug=window.L.Logger.debug||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.debug.apply(console,e)},window.L.Logger.trace=window.L.Logger.trace||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.trace.apply(console,e)},window.L.Logger.info=window.L.Logger.info||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,e)},window.L.Logger.warning=window.L.Logger.warning||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)},window.L.Logger.error=window.L.Logger.error||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)});var w=function(e){return"object"===(void 0===e?"undefined":(0,k.default)(e))&&"[object object]"===Object.prototype.toString.call(e).toLowerCase()&&!e.length};if(!(Object&&Object.shallowAssign&&Object&&Object.customAssign)){var C=function(e){try{return y.default.apply(y.default,arguments)}catch(r){for(var t=e,a=1;a<arguments.length;a++){var n=arguments[a];if(n&&"object"===(void 0===n?"undefined":(0,k.default)(n)))for(var i in n)t[i]=n[i]}return e}};Object&&Object.shallowAssign||(Object.shallowAssign=C),Object&&Object.customAssign||(Object.customAssign=C)}Object&&Object.deepAssign||(Object.deepAssign=function(e){for(var t=e,a=1;a<arguments.length;a++){var n=arguments[a];if(n&&"object"===(void 0===n?"undefined":(0,k.default)(n)))for(var i in n)void 0===t[i]?"object"===(0,k.default)(n[i])&&(Array.isArray(n[i])||w(n[i]))?t[i]=Object.deepAssign(Array.isArray(n[i])?[]:{},n[i]):t[i]=n[i]:"object"===(0,k.default)(n[i])&&(Array.isArray(n[i])||w(n[i]))?t[i]=Object.deepAssign(Array.isArray(n[i])?[]:{},"object"===(0,k.default)(t[i])?t[i]:Array.isArray(n[i])?[]:{},n[i]):t[i]=n[i]}return e}),String.prototype.colorHex=function(){var e=this,t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(e)){for(var a=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),n="#",i=0;i<a.length;i++){var r=Number(a[i]).toString(16);"0"===r&&(r+=r),n+=r}return 7!==n.length&&(n=e),n}if(!t.test(e))return e;var s=e.replace(/#/,"").split("");if(6===s.length)return e;if(3===s.length){for(var o="#",l=0;l<s.length;l+=1)o+=s[l]+s[l];return o}},String.prototype.colorRgb=function(){var e=this.toLowerCase(),t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e&&t.test(e)){if(4===e.length){for(var a="#",n=1;n<4;n+=1)a+=e.slice(n,n+1).concat(e.slice(n,n+1));e=a}for(var i=[],r=1;r<7;r+=2)i.push(parseInt("0x"+e.slice(r,r+2)));return"RGB("+i.join(",")+")"}return e};var T={addEvent:function(e,t,a,n){n=void 0!=n&&null!=n&&n,e.addEventListener?e.addEventListener(t,a,n):e.attachEvent?e.attachEvent("on"+t,a):e["on"+t]=a},removeEvent:function(e,t,a,n){e.addEventListener?e.removeEventListener(t,a,n):e.attachEvent?e.detachEvent("on"+t,a):e["on"+t]=null},getOffset:function(e){for(var t={left:e.offsetLeft,top:e.offsetTop};e!=document.body;)e=e.offsetParent,t.left+=e.offsetLeft,t.top+=e.offsetTop;return t}},P=function(){function e(){(0,f.default)(this,e),this.whiteboardToolsInfo={primaryColor:"#000000",secondaryColor:"#ffffff",backgroundColor:"#ffffff",pencilWidth:5,shapeWidth:5,eraserWidth:15,fontSize:18,fontFamily:"微软雅黑",fontStyle:"normal",fontWeight:"normal"},this.defaultProductionOptions={whiteboardClear:!0,watermarkImageScalc:16/9,whiteboardMagnification:1,containerWidthAndHeight:{width:0,height:0},minHeight:void 0,rotateDeg:0,baseWhiteboardWidth:960,proprietaryTools:!1,deawPermission:!0,tempDeawPermission:!0,saveRedoStack:!0,saveUndoStack:!1,remindContentTime:3e3,showShapeAuthor:!1,showMyselfRemindContent:!1},this.whiteboardInstanceIDPrefix="whiteboard_",this.whiteboardInstanceDefaultID="whiteboard_default",this.whiteboardInstanceStore={},this.whiteboardThumbnailStore={},this.uniqueWhiteboard=!1,this.minMagnification=1,this.maxMagnification=3,this.useWhiteboardTool={tool_pencil:!1,tool_highlighter:!1,tool_line:!1,tool_arrow:!1,tool_dashed:!1,tool_eraser:!1,tool_text:!1,tool_rectangle:!1,tool_rectangle_empty:!1,tool_ellipse:!1,tool_ellipse_empty:!1,tool_polygon:!1,tool_eyedropper:!1,tool_selectShape:!1,tool_mouse:!1,tool_laser:!1,action_undo:!1,action_redo:!1,action_clear:!1,zoom_big:!1,zoom_small:!1,zoom_default:!1},this.specialWhiteboardInstanceIDPrefix="specialWhiteboardInstanceIDPrefix_",this.awaitSaveToWhiteboardInstanceSignallingArray=[],this.commonActiveTool="tool_pencil",this.basicTemplateWhiteboardSignallingList={}}return(0,v.default)(e,[{key:"getSpecialWhiteboardInstanceIDPrefix",value:function(){return this.specialWhiteboardInstanceIDPrefix}},{key:"setUniqueWhiteboard",value:function(e){this.uniqueWhiteboard=e}},{key:"activeCommonWhiteboardTool",value:function(e){var t=this;/^tool_/.test(e)&&(t.commonActiveTool=e);var a=!0,n=!1,i=void 0;try{for(var r,s=(0,m.default)((0,c.default)(t.whiteboardInstanceStore));!(a=(r=s.next()).done);a=!0){var o=r.value;if(!o.proprietaryTools){var l=o.id;t.activeWhiteboardTool(e,l)}}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"updateCommonWhiteboardToolsInfo",value:function(e){e&&"object"===(void 0===e?"undefined":(0,k.default)(e))&&Object.customAssign(this.whiteboardToolsInfo,e)}},{key:"getWhiteboardDefaultFiledata",value:function(e){var t={fileid:0,currpage:1,pagenum:1,filetype:"whiteboard",filename:"whiteboard",swfpath:"",pptslide:1,pptstep:0,steptotal:0};return e&&"object"===(void 0===e?"undefined":(0,k.default)(e))&&Object.customAssign(t,e),t}},{key:"handlerPubmsg_SharpsChange",value:function(e){if(e){e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),this._saveBasicTemplateWhiteboardSignallingData(e,"pubmsg");var t=e.data.whiteboardID,a=this._getWhiteboardInstanceById(t);if(!a)return e.source="pubmsg",void this.awaitSaveToWhiteboardInstanceSignallingArray.push(e);if(e&&null!=e.data&&("shapeSaveEvent"===e.data.eventType||"clearEvent"===e.data.eventType||"redoEvent"===e.data.eventType||"laserMarkEvent"===e.data.eventType))if(e.source="pubmsg","laserMarkEvent"===e.data.eventType)this._receiveSnapshot(e,a);else{var n=e.id.substring(e.id.lastIndexOf("###_")+4);if(n){var i=n.split("_"),r=i[1],s=i[2],o=this.getWhiteboardFiledata(t);o.fileid==r&&o.currpage==s&&(this._receiveSnapshot(e,a),e.remindContent=e.remindContent||e.data.nickname,a.showShapeAuthor&&e.remindContent&&e.fromID!==a.myselfId&&this._handlerShowRemoteRemindContentFromPubmsgData(a,e)),null===a.waitingProcessShapeData[n]||void 0===a.waitingProcessShapeData[n]?(a.waitingProcessShapeData[n]=[],a.waitingProcessShapeData[n].push(e)):a.waitingProcessShapeData[n].push(e)}}}}},{key:"handlerDelmsg_SharpsChange",value:function(e){if(e){e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),this._saveBasicTemplateWhiteboardSignallingData(e,"delmsg");var t=e.data.whiteboardID,a=this._getWhiteboardInstanceById(t);if(!a){e.source="delmsg";for(var n=this.awaitSaveToWhiteboardInstanceSignallingArray.length-1;n>=0;n--)if(this.awaitSaveToWhiteboardInstanceSignallingArray[n].id===e.id){this.awaitSaveToWhiteboardInstanceSignallingArray.splice(n,1);break}return}var i=e.id.substring(e.id.lastIndexOf("###_")+4);if(i){var r=i.split("_"),s=r[1],o=r[2],l=this.getWhiteboardFiledata(t);if(e.source="delmsg",l.fileid==s&&l.currpage==o&&this._receiveSnapshot(e,a),a.waitingProcessShapeData[i]&&Array.isArray(a.waitingProcessShapeData[i])&&a.waitingProcessShapeData[i].length>0)for(var d=a.waitingProcessShapeData[i].length-1;d>=0;d--){var u=a.waitingProcessShapeData[i][d];if(u.id===e.id){a.waitingProcessShapeData[i].splice(d,1);break}}}}}},{key:"handlerMsglist_SharpsChange",value:function(e){for(var t=0;t<e.length;t++){var a=e[t];a.data&&"string"==typeof a.data&&(a.data=JSON.parse(a.data)),this._saveBasicTemplateWhiteboardSignallingData(a,"msglist");var n=a.data.whiteboardID,i=this._getWhiteboardInstanceById(n);if(i){if(null!=a.data&&("shapeSaveEvent"===a.data.eventType||"clearEvent"===a.data.eventType||"redoEvent"===a.data.eventType)){a.source="msglist";var r=a.id.substring(a.id.lastIndexOf("###_")+4);null===i.waitingProcessShapeData[r]||void 0===i.waitingProcessShapeData[r]?(i.waitingProcessShapeData[r]=[],i.waitingProcessShapeData[r].push(a)):i.waitingProcessShapeData[r].push(a)}}else a.source="msglist",this.awaitSaveToWhiteboardInstanceSignallingArray.push(a)}}},{key:"preloadWhiteboardImg",value:function(e,t){if(!e)return void L.Logger.warning("preload img url is not esixt!");var a=new Image;a.onload=function(){t&&"function"==typeof t&&t()},a.onerror=function(t){L.Logger.error("preload img  fail , img url is "+e)},a.src=e}},{key:"productionWhiteboard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.whiteboardElementId,a=e.thumbnailId,n=e.productionOptions,i=void 0===n?{}:n,r=e.handler,s=void 0===r?{}:r,o=e.id,l=this;if(!t)return void L.Logger.error("whiteboardElementId is required!");var d=l._getWhiteboardInstanceID(o),u=l._getWhiteboardInstanceByID(d);if(u)return L.Logger.error("The production whiteboard(whiteboardInstanceID:"+d+") fails, the whiteboard already exists!"),u;u={};var c=document.getElementById(t);if(!c)return L.Logger.error("Whiteboard elements do not exist , element id is:"+t+"!"),u;var h=document.createElement("div"),m=t+"_whiteboardInstance";return h.className="whiteboard-instance-element",h.id=m,c.appendChild(h),i=Object.customAssign({},l.defaultProductionOptions,i),l.whiteboardInstanceStore[d]=u,u.filedata=i.filedata||{},u.baseWhiteboardWidth=i.baseWhiteboardWidth,u.whiteboardInstanceID=d,u.parcelAncestorElementId=i.parcelAncestorElementId,u.isBaseboard=i.isBaseboard,u.needLooadBaseboard=i.needLooadBaseboard,u.dependenceBaseboardWhiteboardID=i.dependenceBaseboardWhiteboardID,u.watermarkImageScalc=i.watermarkImageScalc,u.whiteboardMagnification=i.whiteboardMagnification,u.remindContentTime=i.remindContentTime,u.showShapeAuthor=i.showShapeAuthor,u.showMyselfRemindContent=i.showMyselfRemindContent,u.associatedMsgID=i.associatedMsgID,u.associatedUserID=i.associatedUserID,u.proprietaryTools=i.proprietaryTools,u.minHeight=i.minHeight,u.rotateDeg=i.rotateDeg,u.deawPermission=i.deawPermission,u.tempDeawPermission=i.tempDeawPermission,u.nickname=i.nickname,u.userid=i.userid,u.synchronizationWhiteboard=i.synchronizationWhiteboard,u.whiteboardToolsInfo=Object.customAssign({},l.whiteboardToolsInfo),i.primaryColor&&(u.whiteboardToolsInfo.primaryColor=i.primaryColor),i.secondaryColor&&(u.whiteboardToolsInfo.secondaryColor=i.secondaryColor),i.backgroundColor&&(u.whiteboardToolsInfo.backgroundColor=i.backgroundColor),u.saveRedoStack=i.saveRedoStack,u.saveUndoStack=i.saveUndoStack,u.imageThumbnailId=i.imageThumbnailId,u.imageThumbnailTipContent=i.imageThumbnailTipContent,u.registerWhiteboardToolsList={},u.stackStorage={},u.handler={},u.handler.sendSignallingToServer=s.sendSignallingToServer,u.handler.delSignallingToServer=s.delSignallingToServer,u.handler.resizeWhiteboardSizeCallback=s.resizeWhiteboardSizeCallback,u.handler.noticeUpdateToolDescCallback=s.noticeUpdateToolDescCallback,u.handler.whiteboardWatermarkImageOnloadCallback=s.whiteboardWatermarkImageOnloadCallback,u.handler.whiteboardWatermarkImageOnFailureCallback=s.whiteboardWatermarkImageOnFailureCallback,u.active=!0,u.containerWidthAndHeight=i.containerWidthAndHeight,u.useImgOriginalSizeToContainerWidthAndHeight=i.useImgOriginalSizeToContainerWidthAndHeight,u.myselfId=i.myselfId,u.undoRedoClearToMySelf=i.undoRedoClearToMySelf,u.useToolKey=i.useToolKey,u.waitingProcessShapeData={},u.whiteboardElementId=t,u.whiteboardElement=c,u.whiteboardInstanceElementId=m,u.whiteboardInstanceElement=h,u.id=o,u.thumbnailId=a,u.lc=window.LC.init(u.whiteboardInstanceElement),u.lc.backingScale=1,u.lc.setColor("primary",u.whiteboardToolsInfo.primaryColor),u.lc.setColor("secondary",u.whiteboardToolsInfo.secondaryColor),u.lc.setColor("background",u.whiteboardToolsInfo.backgroundColor),u.lc.setWatermarkImageToLcBackground(!1),u.lc.setZoom(1),u.lc.setPan(0,0),u.lc.on("shapeSave",l._handlerShapeSaveEvent.bind(l,u)),u.lc.on("sendUndo",l._handlerUndoEvent.bind(l,u)),u.lc.on("sendRedo",l._handlerRedoEvent.bind(l,u)),u.lc.on("sendClear",l._handlerClearEvent.bind(l,u)),u.lc.on("drawingChange",this._handlerDrawingChangeEvent.bind(l,u)),u.activeTool=void 0,u.lc.myselfId=u.myselfId,u.lc.undoRedoClearToMySelf=u.undoRedoClearToMySelf,i.whiteboardClear&&l.clearWhiteboardAllDataById(o),l._changeWhiteboardDeawPermission(u.deawPermission,u),l._changeWhiteboardTemporaryDeawPermission(u.tempDeawPermission,u),l._saveAwaitSaveToWhiteboardInstanceSignallingToWhiteboardInstance(u),l.activeWhiteboardTool(u.proprietaryTools?u.useToolKey?u.useToolKey:"tool_pencil":l.commonActiveTool,o),l._zoomIsDisable(u),l._actionIsDisable(u),l._noticeUpdateToolDesc(u),l._resizeWhiteboardHandler(u),u}},{key:"changeWhiteboardExclusiveAttribute",value:function(e,t){if(t&&"object"===(void 0===t?"undefined":(0,k.default)(t))){var a=this._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[changeWhiteboardExclusiveAttribute]There are no white board Numbers that belong to id "+e);for(var n in t)a.hasOwnProperty(n)&&(a[n]=t[n],"myselfId"!==n&&"undoRedoClearToMySelf"!==n||a.lc&&(a.lc[n]=a[n]))}}},{key:"updateImageThumbnailId",value:function(e,t){var a=this._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[updateImageThumbnailId]There are no white board Numbers that belong to id "+e);a.imageThumbnailId=t,this._saveImageBase64ToImageThumbnail(a)}},{key:"updateWhiteboardSaveRedoStackAndSaveUndoStack",value:function(e,t){var a=t.saveRedoStack,n=t.saveUndoStack,i=this._getWhiteboardInstanceById(e);if(!i)return void L.Logger.error("[updateSaveRedoStackAndSaveUndoStack]There are no white board Numbers that belong to id "+e);i.saveRedoStack=void 0!=a?a:i.saveRedoStack,i.saveUndoStack=void 0!=n?n:i.saveUndoStack}},{key:"updateIsBaseboard",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateIsBaseboard]There are no white board Numbers that belong to id "+e);n.isBaseboard=t}},{key:"updateDependenceBaseboardWhiteboardID",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateDependenceBaseboardWhiteboardID]There are no white board Numbers that belong to id "+e);n.dependenceBaseboardWhiteboardID=t}},{key:"updateShowRemindContent",value:function(e,t,a){var n=this._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateShowRemindContent]There are no white board Numbers that belong to id "+e);n.showShapeAuthor=t||n.showShapeAuthor,n.showMyselfRemindContent=a||n.showMyselfRemindContent}},{key:"updateWhiteboardAssociatedMsgID",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateWhiteboardAssociatedMsgID]There are no white board Numbers that belong to id "+e);n.associatedMsgID=t}},{key:"updateWhiteboardAssociatedUserID",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateWhiteboardAssociatedUserID]There are no white board Numbers that belong to id "+e);n.associatedUserID=t}},{key:"hasWhiteboardById",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);return void 0!==a&&null!==a}},{key:"clearWhiteboardAllDataById",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[clear]There are no white board Numbers that belong to id "+e);t._clearWhiteboardAllDataByInstance(a)}},{key:"productionSpecialId",value:function(e){return this.specialWhiteboardInstanceIDPrefix+e}},{key:"destroyWhiteboardInstance",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[destroy]There are no white board Numbers that belong to id "+e);t._destroyWhiteboardInstance(a)}},{key:"clearRedoAndUndoStack",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[clearRedoAndUndoStack]There are no white board Numbers that belong to id "+e);a._clearRedoAndUndoStack(n,t)}},{key:"resetDedaultWhiteboardMagnification",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[resetDedaultWhiteboardMagnification]There are no white board Numbers that belong to id "+e);a.whiteboardMagnification=t.defaultProductionOptions.whiteboardMagnification,t._zoomIsDisable(a),t._resizeWhiteboardHandler(a)}},{key:"updateWhiteboardMagnification",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateWhiteboardMagnification]There are no white board Numbers that belong to id "+e);n.whiteboardMagnification=t}},{key:"updateWhiteboardWatermarkImageScalc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultProductionOptions.watermarkImageScalc,a=this._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[updateWhiteboardWatermarkImageScalc]There are no white board Numbers that belong to id "+e);this._updateWhiteboardWatermarkImageScalc(a,t)}},{key:"setWhiteboardWatermarkImage",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.resetDedaultWhiteboardMagnification,i=void 0===n||n,r=a.loadSucceedCallback,s=a.loadFailureCallback,o=this;L.Logger.debug("setWhiteboardWatermarkImage watermarkImageUrl:"+t);var l=o._getWhiteboardInstanceById(e);if(!l)return void L.Logger.error("[setWhiteboardWatermarkImage]There are no white board Numbers that belong to id "+e);l.currentWatermarkImageUrl=t,l.lc.watermarkImage=null,i&&o.resetDedaultWhiteboardMagnification(e),t?(o.showWhiteboardCanvasBackground(e),o._showWhiteboardLoading(l),clearTimeout(l.setWhiteboardWatermarkImageTimer),l.setWhiteboardWatermarkImageTimer=setTimeout(function(){var e=new Image;e.onload=function(){if(l.currentWatermarkImageUrl){var a=e.width/e.height;l.useImgOriginalSizeToContainerWidthAndHeight&&(l.containerWidthAndHeight={width:e.width,height:e.height}),l.lc.setWatermarkImage(e),o._resizeWhiteboardByScalc(l,{watermarkImage:e,watermarkImageScalc:a}),l.handler.whiteboardWatermarkImageOnloadCallback&&"function"==typeof l.handler.whiteboardWatermarkImageOnloadCallback&&l.handler.whiteboardWatermarkImageOnloadCallback({width:e.width,height:e.height})}else l.lc.watermarkImage=null,o._resizeWhiteboardHandler();o._hideWhiteboardLoading(l),r&&"function"==typeof r&&r(t)},e.onerror=function(e){L.Logger.error("img load fail , img url is "+t),s&&"function"==typeof s&&s(t),l&&l.handler&&l.handler.whiteboardWatermarkImageOnFailureCallback&&l.currentWatermarkImageUrl&&l.currentWatermarkImageUrl===t&&l.handler.whiteboardWatermarkImageOnFailureCallback(t)},e.src=t},150)):(o.hideWhiteboardCanvasBackground(e),l.lc.watermarkScale=1,o._resizeWhiteboardByScalc(l,{isChangeWatermarkScale:!1}),o._hideWhiteboardLoading(l),l.lc.watermarkImage=null,l.lc.customCanvasBackgroundElement.style.backgroundImage="",o._hideWhiteboardLoading(l))}},{key:"resizeWhiteboardHandler",value:function(e){var t=this;if(void 0===e){var a=!0,n=!1,i=void 0;try{for(var r,s=(0,m.default)((0,c.default)(t.whiteboardInstanceStore));!(a=(r=s.next()).done);a=!0){var o=r.value;t._resizeWhiteboardHandler(o)}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}else{var l=t._getWhiteboardInstanceById(e);if(!l)return void L.Logger.error("[resizeWhiteboardHandler]There are no white board Numbers that belong to id "+e);t._resizeWhiteboardHandler(l)}}},{key:"updateContainerWidthAndHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.width,n=t.height,i=this,r=i._getWhiteboardInstanceById(e);return r?void 0===a||void 0===n?void L.Logger.error("[updateContainerWidthAndHeight]width or height is not exist , [width:"+a+" , height:"+n+"]!"):(r.containerWidthAndHeight={width:a,height:n},void i._resizeWhiteboardHandler(r)):void L.Logger.error("[updateContainerWidthAndHeight]There are no white board Numbers that belong to id "+e)}},{key:"hideWhiteboardCanvasBackground",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[hideWhiteboardCanvasBackground]There are no white board Numbers that belong to id "+e);a.lc&&a.lc.backgroundCanvas&&(a.lc.backgroundCanvas.style.display="none",a.lc.customCanvasBackgroundElement.style.display="none")}},{key:"showWhiteboardCanvasBackground",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[showWhiteboardCanvasBackground]There are no white board Numbers that belong to id "+e);a.lc&&a.lc.backgroundCanvas&&(a.lc.backgroundCanvas.style.display="",a.lc.customCanvasBackgroundElement.style.display="")}},{key:"hideWhiteboard",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);a&&a.whiteboardElement&&(a.whiteboardElement.style.display="none")}},{key:"showWhiteboard",value:function(e){var t=this,a=t._getWhiteboardInstanceById(e);a&&a.whiteboardElement&&(a.whiteboardElement.style.display="block")}},{key:"updateTextFont",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.fontSize,n=t.fontFamily,i=t.fontStyle,r=t.fontWeight,s=this,o=s._getWhiteboardInstanceById(e);if(!o)return void L.Logger.error("[updateTextFont]There are no white board Numbers that belong to id "+e);o.whiteboardToolsInfo.fontSize=void 0!=a?a:o.whiteboardToolsInfo.fontSize,o.whiteboardToolsInfo.fontFamily=void 0!=n?n:o.whiteboardToolsInfo.fontFamily,o.whiteboardToolsInfo.fontStyle=void 0!=i?i:o.whiteboardToolsInfo.fontStyle,o.whiteboardToolsInfo.fontWeight=void 0!=r?r:o.whiteboardToolsInfo.fontWeight,s._updateTextFont(o)}},{key:"updateEraserWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.eraserWidth,n=this,i=n._getWhiteboardInstanceById(e);if(!i)return void L.Logger.error("[updateEraserWidth]There are no white board Numbers that belong to id "+e);i.whiteboardToolsInfo.eraserWidth=void 0!=a?a:i.whiteboardToolsInfo.eraserWidth,n._updateEraserWidth(i)}},{key:"updatePencilWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.pencilWidth,n=this,i=n._getWhiteboardInstanceById(e);if(!i)return void L.Logger.error("[updatePencilWidth]There are no white board Numbers that belong to id "+e);i.whiteboardToolsInfo.pencilWidth=void 0!=a?a:i.whiteboardToolsInfo.pencilWidth,n._updatePencilWidth(i)}},{key:"updateWhiteboardToolsInfo",value:function(e,t){var a=this,n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateWhiteboardToolsInfo]There are no white board Numbers that belong to id "+e);t&&"object"===(void 0===t?"undefined":(0,k.default)(t))&&Object.customAssign(n.whiteboardToolsInfo,t)}},{key:"updateShapeWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.shapeWidth,n=this,i=n._getWhiteboardInstanceById(e);if(!i)return void L.Logger.error("[uploadShapeWidth]There are no white board Numbers that belong to id "+e);i.whiteboardToolsInfo.shapeWidth=void 0!=a?a:i.whiteboardToolsInfo.shapeWidth,n._updateShapeWidth(i)}},{key:"updateColor",value:function(e,t){var a=this;if(t&&"object"===(void 0===t?"undefined":(0,k.default)(t))){var n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[updateColor]There are no white board Numbers that belong to id "+e);var i={},r=!0,s=!1,l=void 0;try{for(var u,c=(0,m.default)((0,o.default)(t));!(r=(u=c.next()).done);r=!0){var h=u.value,g=(0,d.default)(h,2),f=g[0],p=g[1],v=f.replace(/Color/g,"");i[v]=p,n.whiteboardToolsInfo[v+"Color"]=p}}catch(e){s=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(s)throw l}}a._updateColor(n,i)}}},{key:"activeWhiteboardTool",value:function(e,t){var a=this;if(void 0===a.useWhiteboardTool[e])return void L.Logger.error("The whiteboard does not have the "+e+" tool!");if(void 0===t||null===t)return void L.Logger.error("[activeWhiteboardTool]id is undefined or null ");var n=a._getWhiteboardInstanceById(t);if(!n)return void L.Logger.error("[activeWhiteboardTool]There are no white board Numbers that belong to id "+t);if(/^tool_/.test(e))if(n.activeTool=e,a._setWhiteboardTools(e,n),a._handlerActiveToolLaser(e,n),"tool_text"==e?a._updateTextFont(n):"tool_eraser"==e?a._updateEraserWidth(n):"tool_pencil"==e||"tool_highlighter"==e||"tool_line"==e||"tool_arrow"==e||"tool_dashed"==e?a._updatePencilWidth(n):"tool_rectangle"!=e&&"tool_rectangle_empty"!=e&&"tool_ellipse"!=e&&"tool_ellipse_empty"!=e&&"tool_polygon"!=e||a._updateShapeWidth(n),"tool_ellipse_empty"==e||"tool_rectangle_empty"==e?n.lc.setColor("secondary","transparent"):"tool_rectangle"===e||"tool_ellipse"===e||"tool_polygon"===e?n.lc.setColor("secondary",n.whiteboardToolsInfo.primaryColor):n.lc.setColor("secondary",n.whiteboardToolsInfo.secondaryColor),"tool_highlighter"===e){var i=n.whiteboardToolsInfo.primaryColor.colorRgb().toLowerCase().replace("rgb","rgba").replace(")",",0.5)");n.lc.setColor("primary",i)}else n.lc.setColor("primary",n.whiteboardToolsInfo.primaryColor);else if(/^action_/.test(e)){if("action_undo"===e){var r=n.undoRedoClearToMySelf&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendUndo(r):n.lc.undo()}else if("action_redo"===e){var s=n.undoRedoClearToMySelf&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendRedo(s):n.lc.redo()}else if("action_clear"===e){var o=n.undoRedoClearToMySelf&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendClear(o):n.lc.clear()}a._actionIsDisable(n)}else/^zoom_/.test(e)&&("zoom_big"===e?n.whiteboardMagnification<a.maxMagnification&&(n.whiteboardMagnification+=.5):"zoom_small"===e?n.whiteboardMagnification>a.minMagnification&&(n.whiteboardMagnification-=.5):"zoom_default"===e&&(n.whiteboardMagnification=a.defaultProductionOptions.whiteboardMagnification),n.whiteboardMagnification>a.maxMagnification?n.whiteboardMagnification=a.maxMagnification:n.whiteboardMagnification<a.minMagnification&&(n.whiteboardMagnification=a.minMagnification),a._zoomIsDisable(n),a._resizeWhiteboardHandler(n))}},{key:"changeWhiteboardTemporaryDeawPermission",value:function(e,t){var a=this,n=void 0;if(void 0!==t&&(n=a._getWhiteboardInstanceById(t)),!n)return void L.Logger.error("[changeWhiteboardTemporaryDeawPermission]There are no white board Numbers that belong to id "+t);a._changeWhiteboardTemporaryDeawPermission(e,n)}},{key:"updateWhiteboardProperty",value:function(e,t){var a=this;if(t&&"object"===(void 0===t?"undefined":(0,k.default)(t))){if(!this._getWhiteboardInstanceById(e))return void L.Logger.error("[updateWhiteboardProperty]There are no white board Numbers that belong to id "+e);if(void 0!==t.canDraw&&a.changeWhiteboardDeawPermission(t.canDraw,e),void 0!==t.showShapeAuthor&&a.changeWhiteboardExclusiveAttribute(e,{showShapeAuthor:t.showShapeAuthor}),void 0!==t.myUserId&&a.changeWhiteboardExclusiveAttribute(e,{myselfId:t.myUserId}),void 0!==t.myName&&a.changeWhiteboardExclusiveAttribute(e,{nickname:t.myName}),void 0!==t.primaryColor||void 0!==t.secondaryColor||void 0!==t.primaryColor){var n={};for(var i in t)"primaryColor"!==i&&"secondaryColor"!==i&&"backgroundColor"!==i||(n[i]=t[i]);a.updateColor(e,n)}void 0!==t.synchronization&&a.changeWhiteboardExclusiveAttribute(e,{synchronizationWhiteboard:t.synchronization})}}},{key:"changeWhiteboardDeawPermission",value:function(e,t){var a=this,n=void 0;if(void 0!==t&&(n=a._getWhiteboardInstanceById(t)),!n)return void L.Logger.error("[changeWhiteboardDeawPermission]There are no white board Numbers that belong to id "+t);a._changeWhiteboardDeawPermission(e,n)}},{key:"registerWhiteboardTools",value:function(e,t){var a=this;if(!t||"object"!==(void 0===t?"undefined":(0,k.default)(t)))return void L.Logger.error("[initWhiteboardTools] tools desc cannot be empty and type json!");var n=a._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error("[registerWhiteboardTools]There are no white board Numbers that belong to id "+e);var i={},r=!0,s=!1,l=void 0;try{for(var u,c=(0,m.default)((0,o.default)(t));!(r=(u=c.next()).done);r=!0){var h=u.value,g=(0,d.default)(h,2),f=g[0],p=g[1];void 0!==a.useWhiteboardTool[f]?(i[f]=a._productionToolDesc(f,p),a.useWhiteboardTool[f]=!0):L.Logger.warning("The whiteboard does not have the "+f+" tool!")}}catch(e){s=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(s)throw l}}n.registerWhiteboardToolsList=i,n.isRegisterWhiteboardTool=!0,a._zoomIsDisable(n),a._zoomIsDisable(n),a._noticeUpdateToolDesc(n)}},{key:"hasWhiteboardFiledata",value:function(e){var t=this._getWhiteboardInstanceById(e);return t?!!(t.filedata&&"object"===(0,k.default)(t.filedata)&&(0,r.default)(t.filedata).length>0):void L.Logger.error("[hasWhiteboardFiledata]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardFiledata",value:function(e,t){var a=this._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[updateWhiteboardFiledata]There are no white board Numbers that belong to id "+e);this._updateWhiteboardFiledata(a,t)}},{key:"getWhiteboardFiledata",value:function(e){var t=this._getWhiteboardInstanceById(e);return t?("number"!=typeof t.filedata.currpage&&(t.filedata.currpage=Number(t.filedata.currpage)),"number"!=typeof t.filedata.pagenum&&(t.filedata.pagenum=Number(t.filedata.pagenum)),"number"!=typeof t.filedata.pptslide&&(t.filedata.pptslide=Number(t.filedata.pptslide)),"number"!=typeof t.filedata.pptstep&&(t.filedata.pptstep=Number(t.filedata.pptstep)),"number"!=typeof t.filedata.steptotal&&(t.filedata.steptotal=Number(t.filedata.steptotal)),Object.customAssign({},t.filedata)):void L.Logger.error("[getWhiteboardFiledata]There are no white board Numbers that belong to id "+e)}},{key:"loadCurrpageWhiteboard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.loadRedoStack,n=void 0!==a&&a,i=(t.loadUndoStack,t.callback),r=this._getWhiteboardInstanceById(e);if(!r)return void L.Logger.error("[loadCurrpageWhiteboard]There are no white board Numbers that belong to id "+e);this._clearRedoAndUndoStack(r),this._basicTemplateWhiteboardSignallingListToWhiteboardInstance(r);var s=r.filedata,o=s.fileid,l=s.currpage;if(void 0===r.waitingProcessShapeData||null===r.waitingProcessShapeData)r.waitingProcessShapeData={};else{var d=r.waitingProcessShapeData["SharpsChange_"+o+"_"+l];null!==d&&void 0!==d&&d.length>0&&this._batchReceiveSnapshot(d,r)}if(n){var u=r.stackStorage["redoStack_"+o+"_"+l];u&&u.length>0&&(r.lc.redoStack=u)}this._actionIsDisable(r),i&&"function"==typeof i&&i()}},{key:"saveWhiteboardStackToStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.saveRedoStack,n=t.saveUndoStack,i=this._getWhiteboardInstanceById(e);if(!i)return void L.Logger.error("[saveWhiteboardStackToStorage]There are no white board Numbers that belong to id "+e);a=void 0!=a?a:i.saveRedoStack,n=void 0!=n?n:i.saveUndoStack;var r=this.getWhiteboardFiledata(e),s=r.fileid,o=r.currpage;n&&(i.stackStorage["undoStack_"+s+"_"+o]=i.lc.undoStack.slice(0)),a&&(i.stackStorage["redoStack_"+s+"_"+o]=i.lc.redoStack.slice(0))}},{key:"showWhiteboardLoading",value:function(e){var t=this._getWhiteboardInstanceById(e);if(!t)return void L.Logger.error("[showWhiteboardLoading]There are no white board Numbers that belong to id "+e);this._showWhiteboardLoading(t)}},{key:"hideWhiteboardLoading",value:function(e){var t=this._getWhiteboardInstanceById(e);if(!t)return void L.Logger.error("[showWhiteboardLoading]There are no white board Numbers that belong to id "+e);this._hideWhiteboardLoading(t)}},{key:"isWhiteboardTextEditing",value:function(e){var t=this._getWhiteboardInstanceById(e);return t?"Text"==t.lc.tool.name.toString()&&"editing"==t.lc.tool.currentShapeState:void L.Logger.error("[isWhiteboardTextEditing]There are no white board Numbers that belong to id "+e)}},{key:"checkWhiteboardCanvasSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.isResize,n=void 0!==a&&a,i=this._getWhiteboardInstanceById(e);return i?i.lc&&i.lc.canvas?(0===i.lc.canvas.width||0===i.lc.canvas.height)&&(n&&this._resizeWhiteboardHandler(i),!0):void 0:void L.Logger.error("[checkWhiteboardCanvasSize]There are no white board Numbers that belong to id "+e)}},{key:"downCanvasImageToLocalFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",a=this._getWhiteboardInstanceById(e);if(!a)return void L.Logger.error("[downCanvasImageToLocalFile]There are no white board Numbers that belong to id "+e);var n=this._convertCanvasToImageBase64(a,t);n=n.replace(function(e){return e=e.toLocaleLowerCase().replace(/jpg/i,"jpeg"),"image/"+e.match(/png|jpeg|bmp|gif/)[0]}(t),"image/octet-stream");var i=(a.nickname?a.nickname+"_":"")+a.id+"_"+(new Date).getTime()+"."+t;!function(e,t){var a=document.createElementNS("http://www.w3.org/1999/xhtml","a");a.href=e,a.download=t;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}(n,i)}},{key:"_clearRedoAndUndoStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.clear,n=void 0===a||a,i=t.redo,r=void 0===i||i,s=t.undo,o=void 0===s||s,l=this;n&&l._clearLc(e,{triggerEvent:!1}),r&&l._clearLcRedoStack(e),o&&l._clearLcUndoStack(e),l._actionIsDisable(e)}},{key:"_updateWhiteboardFiledata",value:function(e,t){t&&"object"===(void 0===t?"undefined":(0,k.default)(t))&&(void 0!==t.currpage&&(t.currpage=Number(t.currpage)),void 0!==t.pagenum&&(t.pagenum=Number(t.pagenum)),void 0!==t.pptslide&&(t.pptslide=Number(t.pptslide)),void 0!==t.pptstep&&(t.pptstep=Number(t.pptstep)),void 0!==t.steptotal&&(t.steptotal=Number(t.steptotal)),Object.customAssign(e.filedata,t))}},{key:"_batchReceiveSnapshot",value:function(e,t){var a=this;if(!Array.isArray(e))return void L.Logger.error("shapesArray must be an array!");e.forEach(function(n,i){var r=!0;i===e.length-1&&(r=!1),a._handlerRemoteDataToWhiteboard(n,r,t)}),a._actionIsDisable(t)}},{key:"_receiveSnapshot",value:function(e,t){var a=this;a._handlerRemoteDataToWhiteboard(e,!1,t),a._actionIsDisable(t)}},{key:"_handlerRemoteDataToWhiteboard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments[2];if(e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),null!=e.data&&null!=e.data.eventType)if("delmsg"===e.source)switch(e.data.eventType){case"shapeSaveEvent":case"clearEvent":case"undoEvent":e.data.actionName&&"AddShapeAction"===e.data.actionName?(a.lc.undo(!1,e.data.shapeId),this._removeRemindContentByElementId(a,"whiteboard_remind_"+e.data.shapeId)):e.data.actionName&&"ClearAction"===e.data.actionName&&a.lc.undo(!1,e.data.clearActionId)}else switch(e.data.eventType){case"shapeSaveEvent":if(a&&a.lc&&a.lc.undoStack&&a.lc.undoStack.length>0)for(var n=!1,i=a.lc.undoStack.length-1;i>=0;i--){var r=a.lc.undoStack[i];switch(r.actionName){case"AddShapeAction":r.shapeId===e.data.shapeId&&(r.undo&&r.undo(),a.lc.undoStack.splice(i,1),n=!0)}if(n)break}e.data&&e.data.data&&e.data.data.data&&(e.data.data=LC.JSONToShape(e.data.data)),a.lc.saveShape(e.data.data,!1,null,t,e.fromID,e.seq);break;case"undoEvent":e.data.actionName&&"AddShapeAction"===e.data.actionName?(a.lc.undo(!1,e.data.shapeId),this._removeRemindContentByElementId(a,"whiteboard_remind_"+e.data.shapeId)):e.data.actionName&&"ClearAction"===e.data.actionName&&a.lc.undo(!1,e.data.clearActionId);break;case"redoEvent":if(e.data.actionName&&"AddShapeAction"===e.data.actionName){for(var s=!0,o=a.lc.undoStack.length-1;o>=0;o--)if(e.data.shapeId===a.lc.undoStack[o].shapeId){s=!1;break}if(s){for(var l=!1,d=a.lc.redoStack.length-1;d>=0;d--)if(e.data.shapeId===a.lc.redoStack[d].shapeId){l=!0;break}if(l)a.lc.redo(!1,e.data.shapeId);else{e.data&&e.data.data&&e.data.data.data&&(e.data.data=LC.JSONToShape(e.data.data));var u=e.data.otherInfo,c=void 0===u?{authorUserId:e.fromID,seq:e.seq}:u;a.lc.saveShape(e.data.data,!1,null,t,c.authorUserId,c.seq)}}}else if(e.data.actionName&&"ClearAction"===e.data.actionName){for(var h=!0,m=a.lc.undoStack.length-1;m>=0;m--)if(e.data.clearActionId===a.lc.undoStack[m].id){h=!1;break}if(h){for(var g=!1,f=a.lc.redoStack.length-1;f>=0;f--)if(e.data.clearActionId===a.lc.redoStack[f].id){g=!0;break}if(g)a.lc.redo(!1,e.data.clearActionId),this._removeAllRemindContent(a);else{var p=e.data.otherInfo,v=void 0===p?{authorUserId:e.fromID,toAuthorUserId:void 0,seq:e.seq}:p;a.lc.clear(!1,e.data.clearActionId,v.authorUserId,v.toAuthorUserId,v.seq),this._removeAllRemindContent(a)}}}break;case"clearEvent":a.lc.clear(!1,e.data.clearActionId,e.fromID,e.data.toAuthorUserId,e.seq),this._removeAllRemindContent(a);break;case"laserMarkEvent":var b=a.lc.containerEl.parentNode.getElementsByClassName("laser-mark")[0];switch(e.data.actionName){case"show":b.style.display="block";break;case"hide":b.style.display="none";break;case"move":if(e.data&&e.data.laser){var y=e.data.laser.left,S=e.data.laser.top;b.style.left=y+"%",b.style.top=S+"%"}}}}},{key:"_productionToolDesc",value:function(e,t){return{toolKey:e,disabled:!1}}},{key:"_noticeUpdateToolDesc",value:function(e){e&&e.isRegisterWhiteboardTool&&(clearTimeout(e.noticeUpdateToolDescTimer),e.noticeUpdateToolDescTimer=setTimeout(function(){e.handler&&e.handler.noticeUpdateToolDescCallback&&e.handler.noticeUpdateToolDescCallback(e.registerWhiteboardToolsList)},250))}},{key:"_updateToolDesc",value:function(e,t,a){if(e.registerWhiteboardToolsList[t]){var n=!0,i=!1,r=void 0;try{for(var s,l=(0,m.default)((0,o.default)(a));!(n=(s=l.next()).done);n=!0){var u=s.value,c=(0,d.default)(u,2),h=c[0],g=c[1];void 0!==e.registerWhiteboardToolsList[t][h]&&(e.registerWhiteboardToolsList[t][h]=g)}}catch(e){i=!0,r=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw r}}}}},{key:"_batchUpdateToolDesc",value:function(e,t){var a=this;if(!Array.isArray(t))return void L.Logger.error("updateDescArray must be an array , whiteboard id is "+e.id+"!");var n=!0,i=!1,r=void 0;try{for(var s,o=(0,m.default)(t);!(n=(s=o.next()).done);n=!0){var l=s.value;Array.isArray(l)&&a._updateToolDesc(e,l[0],l[1])}}catch(e){i=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}},{key:"_setWhiteboardTools",value:function(e,t){var a=this,n=function(t){var n=a._productionToolByCore(e,t);t.lc.setTool(n)};a._automaticTraverseWhiteboardInstance(t,n)}},{key:"_productionToolByCore",value:function(e,t){var a=this,n=void 0;if(void 0===a.useWhiteboardTool[e])return L.Logger.error("The whiteboard does not have the "+e+" tool!"),n;switch(e){case"tool_pencil":case"tool_highlighter":n=new LC.tools.Pencil(t.lc);break;case"tool_line":n=new LC.tools.Line(t.lc);break;case"tool_arrow":n=new LC.tools.Line(t.lc),n.hasEndArrow=!0;break;case"tool_dashed":n=new LC.tools.Line(t.lc),n.isDashed=!0;break;case"tool_eraser":n=new LC.tools.Eraser(t.lc);break;case"tool_text":n=new LC.tools.Text(t.lc);break;case"tool_rectangle":case"tool_rectangle_empty":n=new LC.tools.Rectangle(t.lc);break;case"tool_ellipse":case"tool_ellipse_empty":n=new LC.tools.Ellipse(t.lc);break;case"tool_polygon":n=new LC.tools.Polygon(t.lc);break;case"tool_eyedropper":n=new LC.tools.Eyedropper(t.lc);break;case"tool_selectShape":n=new LC.tools.SelectShape(t.lc);break;case"tool_mouse":case"tool_laser":n=t.lc.tool;break;default:L.Logger.warning("Tool "+e+" is not created in the whiteboard core layer!"),n=t.lc.tool}return n}},{key:"_getWhiteboardInstanceID",value:function(e){var t=this,a=t.uniqueWhiteboard||void 0==e||null==e?t.whiteboardInstanceDefaultID:t.whiteboardInstanceIDPrefix+e;return e&&"string"==typeof e&&new RegExp(t.specialWhiteboardInstanceIDPrefix,"g").test(e)&&(a=e),a}},{key:"_getWhiteboardInstanceById",value:function(e){var t=this,a=t._getWhiteboardInstanceID(e);return t.whiteboardInstanceStore[a]}},{key:"_getWhiteboardInstanceByID",value:function(e){return this.whiteboardInstanceStore[e]}},{key:"_resizeWhiteboardByScalc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.watermarkImage,n=t.isChangeCanvas,i=void 0===n||n,r=t.isChangeWatermarkScale,s=void 0===r||r,o=t.watermarkImageScalc;o=void 0!==o?o:e.watermarkImageScalc;var l=e.lc;if(l){var d=e.whiteboardElement,u=e.whiteboardInstanceElement,c=e.containerWidthAndHeight.width,h=e.containerWidthAndHeight.height;if(e.parcelAncestorElementId&&document.getElementById(e.parcelAncestorElementId)){var m=document.getElementById(e.parcelAncestorElementId);c=m.clientWidth,h=m.clientHeight}var g={},f=0,p=0,v=0,b=0;if(h*o<c?(f=Math.round(h*o*e.whiteboardMagnification),p=Math.round(h*e.whiteboardMagnification),d.style.width=f+"px",d.style.height=p+"px",u.style.width=f+"px",u.style.height=p+"px",void 0!==e.minHeight&&null!==e.minHeight&&(v=e.minHeight*o,b=e.minHeight,d.style.minWidth=v+"px",d.style.minHeight=b+"px",u.style.minWidth=v+"px",u.style.minHeight=b+"px",g.minWidth=v+"px",g.minHegiht=b+"px"),g.top="0%",g.left="50%",g.marginTop="0px",g.marginLeft=-f/2+"px",g.width=f+"px",g.height=p+"px"):(f=Math.round(c*e.whiteboardMagnification),p=Math.round(c/o*e.whiteboardMagnification),d.style.width=f+"px",d.style.height=p+"px",u.style.width=f+"px",u.style.height=p+"px",void 0!==e.minHeight&&null!==e.minHeight&&(v=e.minHeight*o,b=e.minHeight,d.style.minWidth=v+"px",d.style.minHeight=b+"px",u.style.minWidth=v+"px",u.style.minHeight=b+"px",g.minWidth=v+"px",g.minHegiht=b+"px"),g.top="50%",g.left="0%",g.marginTop=-p/2+"px",g.marginLeft="0px",g.width=f+"px",g.height=p+"px"),i){l.respondToSizeChange();var y=u.clientWidth,S=u.clientHeight,k=(y+S)/(e.baseWhiteboardWidth+e.baseWhiteboardWidth*o);if(l.setZoom(k),l.setPan(0,0),s&&a){var w=a.width,C=a.height,T=y/w,P=S/C,A=(T+P)/2;l.watermarkScale=A,l.setWatermarkImage(a)}}e.whiteboardMagnification>1?g.addClassName="custom-scroll-bar":g.addClassName="",e.handler&&e.handler.resizeWhiteboardSizeCallback&&"function"==typeof e.handler.resizeWhiteboardSizeCallback&&e.handler.resizeWhiteboardSizeCallback(g)}}},{key:"_clearWhiteboardAllDataByInstance",value:function(e){if(!e)return void L.Logger.error("[_clear]The whiteboard instance does not exist!");e.lc.clear(!1),e.lc.redoStack.length=0,e.lc.undoStack.length=0,e.stackStorage={},e.waitingProcessShapeData={},this._removeAllRemindContent(e)}},{key:"_resizeWhiteboardHandler",value:function(e){var t=this;if(e&&e.lc){var a=e.lc.watermarkImage;if(a&&a.src){var n=a.width/a.height;t._resizeWhiteboardByScalc(e,{watermarkImage:a,watermarkImageScalc:n})}else t._resizeWhiteboardByScalc(e,{isChangeWatermarkScale:!1});this._updateAllRemindContent(e)}}},{key:"_updateWhiteboardWatermarkImageScalc",value:function(e,t){e.watermarkImageScalc=t,this._resizeWhiteboardHandler(e)}},{key:"_productionWhiteboardRemindContent",value:function(e,t,a,n,i){var r=this;if(e&&n)try{if(e&&e.lc&&e.lc.containerEl.parentNode&&"function"==typeof e.lc.drawingCoordsToClientCoords){var s=e.lc.drawingCoordsToClientCoords(t,a);if(s){var o=document.createElement("span");o.className="remind-content",o.style.position="absolute",o.style.left=s.x+"px",o.style.top=s.y+"px",o.innerHTML=n;var l=i?"whiteboard_remind_"+i:"whiteboard_remind_"+(new Date).getTime();o.setAttribute("data-position-x",t),o.setAttribute("data-position-y",a),o.setAttribute("id",l),e.lc.containerEl.parentNode.appendChild(o),setTimeout(function(){r._removeRemindContentByElementId(e,l),o=null},e.remindContentTime)}}}catch(e){L.Logger.error("productionWhiteboardRemindContent error:",e)}}},{key:"_updateAllRemindContent",value:function(e){try{if(e.lc&&e.lc.containerEl.parentNode){var t=e.lc.containerEl.parentNode.getElementsByClassName("remind-content");if(t&&t.length>0)for(var a=0;a<t.length;a++){var n=t[a],i=Number(n.getAttribute("data-position-x")),r=Number(n.getAttribute("data-position-y")),s=e.lc.drawingCoordsToClientCoords(i,r);n.style.left=s.x+"px",n.style.top=s.y+"px"}}}catch(e){L.Logger.error("updateAllRemindContent error:",e)}}},{key:"_removeRemindContentByElementId",value:function(e,t){if(e&&e.lc&&e.lc.containerEl.parentNode){var a=document.getElementById(t);a&&(a.innerHTML="",e.lc.containerEl.parentNode.removeChild(a),a=null)}}},{key:"_removeAllRemindContent",value:function(e){if(e&&e.lc&&e.lc.containerEl.parentNode)try{if(e.lc&&e.lc.containerEl.parentNode){var t=e.lc.containerEl.parentNode.getElementsByClassName("remind-content");if(t&&t.length>0)for(var a=t.length-1;a>=0;a--){var n=t[a];n.innerHTML="",e.lc.containerEl.parentNode.removeChild(n),n=null}}}catch(e){L.Logger.error("removeAllRemindContent error:",e)}}},{key:"_handlerShapeSaveEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"shapeSaveEvent",t),this._actionIsDisable(e)}},{key:"_handlerUndoEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"undoEvent",t),this._actionIsDisable(e)}},{key:"_handlerRedoEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"redoEvent",t),this._actionIsDisable(e)}},{key:"_handlerClearEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"clearEvent",t),this._actionIsDisable(e)}},{key:"_handlerDrawingChangeEvent",value:function(e){this._saveImageBase64ToImageThumbnail(e)}},{key:"_saveImageBase64ToImageThumbnail",value:function(e){if(e.imageThumbnailId){var t=document.getElementById(e.imageThumbnailId);if(t&&"img"===t.nodeName.toLowerCase()){var a=this._convertCanvasToImageBase64(e,"jpg");t.src=a,e.imageThumbnailTipContent&&document.getElementById(e.imageThumbnailId+"_imageDescribe")?document.getElementById(e.imageThumbnailId+"_imageDescribe").innerHTML=e.imageThumbnailTipContent:e.nickname&&document.getElementById(e.imageThumbnailId+"_imageDescribe")&&(document.getElementById(e.imageThumbnailId+"_imageDescribe").innerHTML=e.nickname)}}}},{key:"_destroyWhiteboardInstance",value:function(e){var t=this;clearTimeout(e.noticeUpdateToolDescTimer),clearTimeout(e.laserTimer),clearTimeout(e.setWhiteboardWatermarkImageTimer),t.basicTemplateWhiteboardSignallingList[e.id]&&(t.basicTemplateWhiteboardSignallingList[e.id]=null,delete t.basicTemplateWhiteboardSignallingList[e.id]),t._clearWhiteboardAllDataByInstance(e);var a=e.whiteboardInstanceID,n=e.whiteboardElement;e.lc&&"function"==typeof e.lc.teardown&&e.lc.teardown(),n?n.innerHTML="":L.Logger.warning("[destroy] whiteboard elements do not exist , element id is:"+e.whiteboardElementId+"!");var i=e.thumbnailId?document.getElementById(e.thumbnailId):void 0;i&&(i.innerHTML="");var s=!0,o=!1,l=void 0;try{for(var d,u=(0,m.default)((0,r.default)(e));!(s=(d=u.next()).done);s=!0){var c=d.value;e[c]=null,delete e[c]}}catch(e){o=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(o)throw l}}t.whiteboardInstanceStore[a]=null,delete t.whiteboardInstanceStore[a]}},{key:"_clearLc",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).triggerEvent,e&&e.lc?(e.lc.clear(!1),this._removeAllRemindContent(e)):L.Logger.warning("clear whiteboard is not exist!")}},{key:"_clearLcRedoStack",value:function(e){e&&e.lc?e.lc.redoStack.length=0:L.Logger.warning("clearRedoStack whiteboard is not exist!")}},{key:"_clearLcUndoStack",value:function(e){e&&e.lc?e.lc.undoStack.length=0:L.Logger.warning("clearUndoStack whiteboard is not exist!")}},{key:"_showWhiteboardLoading",value:function(e){e.lc.loadingElement&&(e.lc.loadingElement.style.display="block")}},{key:"_hideWhiteboardLoading",value:function(e){e.lc.loadingElement&&(e.lc.loadingElement.style.display="none")}},{key:"_changeWhiteboardTemporaryDeawPermission",value:function(e,t){var a=this,n=function(t){var a=t.lc;if(a.isTmpDrawAble!==e){a.isTmpDrawAble=e;var n=a.containerEl.parentNode.getElementsByClassName("temporary-draw-permission")[0];a.isTmpDrawAble?(n.className=n.className.replace(/( yes| no)/g,""),n.className+=" yes"):(n.className=n.className.replace(/( yes| no)/g,""),n.className+=" no")}};a._automaticTraverseWhiteboardInstance(t,n)}},{key:"_changeWhiteboardDeawPermission",value:function(e,t){var a=this,n=function(t){var a=t.lc;if(a.isDrawAble!==e){a.isDrawAble=e;var n=a.containerEl.parentNode.getElementsByClassName("draw-permission")[0];a.isDrawAble?(n.className=n.className.replace(/( yes| no)/g,""),n.className+=" yes"):(n.className=n.className.replace(/( yes| no)/g,""),n.className+=" no")}};a._automaticTraverseWhiteboardInstance(t,n)}},{key:"_handlerActiveToolLaser",value:function(e,t){var a=this,n=function(t){var n=t.lc,i=n.containerEl.parentNode,r=i.getElementsByClassName("temporary-draw-permission")[0],s=i.getElementsByClassName("laser-mark")[0];if("tool_laser"===e)T.removeEvent(r,"mousemove",t._laserEventHandler_mousemove),T.removeEvent(i,"mouseenter",t._laserEventHandler_mouseenter),T.removeEvent(i,"mouseleave",t._laserEventHandler_mouseleave),t._laserEventHandler_mousemove=function(e){if("tool_laser"!==t.activeTool){var n={action:{actionName:"hide"}};return a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",n),s.style.display="none",T.removeEvent(r,"mousemove",t._laserEventHandler_mousemove),!1}var i=e.pageX,o=e.pageY,l=r.getBoundingClientRect(),d=void 0,u=void 0,c=r.clientWidth,h=r.clientHeight;switch(t.rotateDeg){case 0:d=i-l.left,u=o-l.top;break;case 90:d=o-l.top,u=h-(i-l.left);break;case 180:d=c-(i-l.left),u=h-(o-l.top);break;case 270:d=c-(o-l.top),u=i-l.left;break;default:d=i-l.left,u=o-l.top}var m=d/c*100,g=u/h*100;return s.style.left=m+"%",s.style.top=g+"%",clearTimeout(t.laserTimer),t.laserTimer=setTimeout(function(){if(t.laserPosition&&(Math.abs(m-t.laserPosition.left)>.3||Math.abs(g-t.laserPosition.top)>.3)){var e={laser:{left:m,top:g},action:{actionName:"move"}};t.laserPosition=e.laser,a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",e)}},100),!1},t._laserEventHandler_mouseenter=function(e){if("tool_laser"!==t.activeTool){var n={action:{actionName:"hide"}};return a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",n),s.style.display="none",T.removeEvent(i,"mouseenter",t._laserEventHandler_mouseenter),!1}var r={action:{actionName:"show"}};return a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",r),s.style.display="block",!1},t._laserEventHandler_mouseleave=function(e){var n={action:{actionName:"hide"}};return a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",n),s.style.display="none","tool_laser"!==t.activeTool&&T.removeEvent(i,"mouseleave",t._laserEventHandler_mouseleave),!1},a._changeWhiteboardTemporaryDeawPermission(!1,t),t.selectLaserTool=!0,T.removeEvent(r,"mousemove",t._laserEventHandler_mousemove),T.removeEvent(i,"mouseenter",t._laserEventHandler_mouseenter),T.removeEvent(i,"mouseleave",t._laserEventHandler_mouseleave),r.className=r.className.replace(/ cursor-none/g,""),r.className+=" cursor-none",t.laserPosition=t.laserPosition||{left:0,top:0},T.addEvent(r,"mousemove",t._laserEventHandler_mousemove),T.addEvent(i,"mouseenter",t._laserEventHandler_mouseenter),T.addEvent(i,"mouseleave",t._laserEventHandler_mouseleave);else if(a._changeWhiteboardTemporaryDeawPermission("tool_mouse"!==e,t),T.removeEvent(r,"mousemove",t._laserEventHandler_mousemove),T.removeEvent(i,"mouseenter",t._laserEventHandler_mouseenter),T.removeEvent(i,"mouseleave",t._laserEventHandler_mouseleave),r.className=r.className.replace(/ cursor-none/g,""),s.style.display="none",t.selectLaserTool){var o={action:{actionName:"hide"}};a._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",o),t.selectLaserTool=!1}};a._automaticTraverseWhiteboardInstance(t,n)}},{key:"_sendSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.idPrefix,n=t.data,i=t.name,r=t.assignId,s=t.do_not_save,o=t.expiresabs,l=t.associatedMsgID,d=t.associatedUserID;if(!e)return void L.Logger.error("[_sendSignallingToServer]whiteboardInstance is not exist!");if(e.handler&&e.handler.sendSignallingToServer&&"function"==typeof e.handler.sendSignallingToServer){var u=e.filedata,c=u.currpage,h=u.fileid;if(void 0===c||void 0===h)return void L.Logger.error("[_sendSignallingToServer]whiteboardInstance.filedata do not contain  currpage or fileid , [ currpage , fileid ]is ["+c+","+h+"]!");n&&"string"==typeof n&&(n=JSON.parse(n)),n.whiteboardID=e.id,n.isBaseboard=e.isBaseboard,n.nickname=e.nickname,void 0!==e.dependenceBaseboardWhiteboardID&&(n.dependenceBaseboardWhiteboardID=e.dependenceBaseboardWhiteboardID),l=l||e.associatedMsgID,d=d||e.associatedUserID;var m=r||a+"###_"+i+"_"+h+"_"+c,g="__allExceptSender";if("shapeSaveEvent"!==n.eventType&&"undoEvent"!==n.eventType&&"redoEvent"!==n.eventType&&"clearEvent"!==n.eventType||(g="__all"),"__all"!==g){var f=Object.customAssign({},n);this._saveBasicTemplateWhiteboardSignallingData({name:i,id:m,toID:g,data:f,do_not_save:s,expiresabs:o,associatedMsgID:l,associatedUserID:d},"pubmsg")}e.handler.sendSignallingToServer(i,m,g,n,s,o,l,d)}}},{key:"_delSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.idPrefix,n=t.data,i=t.name,r=t.assignId;if(!e)return void L.Logger.error("[_delSignallingToServer]whiteboardInstance is not exist!");if(e.handler&&e.handler.delSignallingToServer&&"function"==typeof e.handler.delSignallingToServer){var s=e.filedata,o=s.currpage,l=s.fileid;if(void 0===o||void 0===l)return void L.Logger.error("[_delSignallingToServer]whiteboardInstance.filedata do not contain  currpage or fileid , [ currpage , fileid ]is ["+o+","+l+"]!");n.whiteboardID=e.id,n.isBaseboard=e.isBaseboard,void 0!==e.dependenceBaseboardWhiteboardID&&(n.dependenceBaseboardWhiteboardID=e.dependenceBaseboardWhiteboardID);var d=r||a+"###_"+i+"_"+l+"_"+o,u="__allExceptSender";if("shapeSaveEvent"!==n.eventType&&"undoEvent"!==n.eventType&&"redoEvent"!==n.eventType&&"clearEvent"!==n.eventType||(u="__all"),"__all"!==u){var c=Object.customAssign({},n);this._saveBasicTemplateWhiteboardSignallingData({name:i,id:d,toID:u,data:c},"delmsg")}e.handler.delSignallingToServer(i,d,u,n)}}},{key:"_sendWhiteboardMessageToSignallingServer",value:function(e,t,a){var n=this,i=void 0,r=void 0,s=void 0,o=void 0,l=void 0,d=void 0,u=void 0;switch(t){case"shapeSaveEvent":null==(d=LC.shapeToJSON(a.shape))||null==d.className||"LinePath"!=d.className&&"ErasedLinePath"!=d.className||(d.data.smoothedPointCoordinatePairs=null,delete d.data.smoothedPointCoordinatePairs,d.data.pointCoordinatePairs.forEach(function(e){e[0]=Math.round(e[0]),e[1]=Math.round(e[1])})),u={eventType:t,actionName:a.action.actionName,shapeId:a.shapeId,data:d},i=a.shapeId,r=u,s="SharpsChange",o=void 0,l=void 0,n._sendSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o,do_not_save:l});break;case"undoEvent":if("AddShapeAction"===a.action.actionName){var c=a.action.shapeId;u={eventType:t,actionName:a.action.actionName,shapeId:c},i=c,r=u,s="SharpsChange",o=void 0,n._delSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o})}else if("ClearAction"===a.action.actionName){var h=a.action.id;u={eventType:t,actionName:a.action.actionName,clearActionId:h},i=h,r=u,s="SharpsChange",o=void 0,n._delSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o})}break;case"redoEvent":if("AddShapeAction"===a.action.actionName){null==(d=LC.shapeToJSON(a.action.shape))||null==d.className||"LinePath"!=d.className&&"ErasedLinePath"!=d.className||(d.data.smoothedPointCoordinatePairs=null,delete d.data.smoothedPointCoordinatePairs,d.data.pointCoordinatePairs.forEach(function(e){e[0]=Math.round(e[0]),e[1]=Math.round(e[1])}));var m=a.action.shapeId,g={authorUserId:a.action.authorUserId,seq:a.action.seq};u={eventType:t,actionName:a.action.actionName,shapeId:m,data:d,otherInfo:g};var f=m,p=u;n._sendSignallingToServer(e,{idPrefix:f,data:p,name:"SharpsChange",assignId:void 0,do_not_save:void 0})}else if("ClearAction"===a.action.actionName){var v=a.action.id,b={authorUserId:a.action.authorUserId,seq:a.action.seq,toAuthorUserId:a.action.toAuthorUserId};u={eventType:t,actionName:a.action.actionName,clearActionId:v,otherInfo:b},i=v,r=u,s="SharpsChange",o=void 0,l=void 0,n._sendSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o,do_not_save:l})}break;case"clearEvent":var y=a.clearActionId;u={eventType:t,actionName:a.action.actionName,clearActionId:y},i=y,r=u,s="SharpsChange",o=void 0,l=void 0,e&&e.undoRedoClearToMySelf&&e.myselfId&&(u.toAuthorUserId=e.myselfId),n._sendSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o,do_not_save:l});break;case"laserMarkEvent":u={eventType:t,actionName:a.action.actionName},a&&a.laser&&(u.laser=a.laser),i="laserMarkEvent",r=u,s="SharpsChange",o=void 0,l=!0,n._sendSignallingToServer(e,{idPrefix:i,data:r,name:s,assignId:o,do_not_save:l})}}},{key:"_updateTextFont",value:function(e){var t=this,a=function(e){var t=e.whiteboardToolsInfo.fontSize,a=e.whiteboardToolsInfo.fontFamily,n=e.whiteboardToolsInfo.fontStyle,i=e.whiteboardToolsInfo.fontWeight,r=e.lc.tool;"Text"==r.name&&(r.font=n+" "+i+" "+t+"px "+a)};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_updateEraserWidth",value:function(e){var t=this,a=function(e){var t=e.whiteboardToolsInfo.eraserWidth;e.lc.trigger("setStrokeWidth",t)};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_updatePencilWidth",value:function(e){var t=this,a=function(e){var t=e.whiteboardToolsInfo.pencilWidth;e.lc.trigger("setStrokeWidth",t)};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_updateShapeWidth",value:function(e){var t=this,a=function(e){var t=e.whiteboardToolsInfo.shapeWidth;e.lc.trigger("setStrokeWidth",t)};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_updateColor",value:function(e,t){var a=this;if(t&&"object"===(void 0===t?"undefined":(0,k.default)(t))){var n=function(e){var a=!0,n=!1,i=void 0;try{for(var s,o=(0,m.default)((0,r.default)(t));!(a=(s=o.next()).done);a=!0){var l=s.value;if(e.lc.setColor(l,e.whiteboardToolsInfo[l+"Color"]),"primary"!==l&&"secondary"!==l||"tool_rectangle"!==e.activeTool&&"tool_rectangle_empty"!==e.activeTool&&"tool_ellipse"!==e.activeTool&&"tool_ellipse_empty"!==e.activeTool&&"tool_polygon"!==e.activeTool||("tool_ellipse_empty"===e.activeTool||"tool_rectangle_empty"===e.activeTool?e.lc.setColor("secondary","transparent"):e.lc.setColor("secondary",e.whiteboardToolsInfo.primaryColor)),"primary"===l&&"tool_highlighter"===e.activeTool){var d=e.whiteboardToolsInfo[l+"Color"].colorRgb().toLowerCase().replace("rgb","rgba").replace(")",",0.5)");e.lc.setColor(l,d)}}}catch(e){n=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}};a._automaticTraverseWhiteboardInstance(e,n)}}},{key:"_actionIsDisable",value:function(e){var t=this,a=function(e){if(e.active){if(0===e.lc.shapes.length){var a=[["action_clear",{disabled:!0}],["tool_eraser",{disabled:!0}],["tool_eyedropper",{disabled:!0}]];t._batchUpdateToolDesc(e,a),t._noticeUpdateToolDesc(e)}else{var n=[["action_clear",{disabled:!1}],["tool_eraser",{disabled:!1}],["tool_eyedropper",{disabled:!1}]];if(e.undoRedoClearToMySelf&&e.myselfId){n=[["action_clear",{disabled:!0}],["tool_eraser",{disabled:!0}],["tool_eyedropper",{disabled:!0}]];for(var i=0;i<e.lc.shapes.length;i++)if(e.lc.shapes[i].authorUserId===e.myselfId){n=[["action_clear",{disabled:!1}],["tool_eraser",{disabled:!1}],["tool_eyedropper",{disabled:!1}]];break}}t._batchUpdateToolDesc(e,n),t._noticeUpdateToolDesc(e)}e.lc.canRedo()?(t._updateToolDesc(e,"action_redo",{disabled:!1}),t._noticeUpdateToolDesc(e)):(t._updateToolDesc(e,"action_redo",{disabled:!0}),t._noticeUpdateToolDesc(e)),e.lc.canUndo()?(t._updateToolDesc(e,"action_undo",{disabled:!1}),t._noticeUpdateToolDesc(e)):(t._updateToolDesc(e,"action_undo",{disabled:!0}),t._noticeUpdateToolDesc(e))}};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_zoomIsDisable",value:function(e){var t=this,a=function(e){if(e.active){if(e.whiteboardMagnification<=t.minMagnification){var a=[["zoom_small",{disabled:!0}],["zoom_default",{disabled:!0}]];t._batchUpdateToolDesc(e,a),t._noticeUpdateToolDesc(e)}else{var n=[["zoom_small",{disabled:!1}],["zoom_default",{disabled:!1}]];t._batchUpdateToolDesc(e,n),t._noticeUpdateToolDesc(e)}e.whiteboardMagnification>=t.maxMagnification?(t._updateToolDesc(e,"zoom_big",{disabled:!0}),t._noticeUpdateToolDesc(e)):(t._updateToolDesc(e,"zoom_big",{disabled:!1}),t._noticeUpdateToolDesc(e))}};t._automaticTraverseWhiteboardInstance(e,a)}},{key:"_automaticTraverseWhiteboardInstance",value:function(e,t){var a=this;if(e)t&&"function"==typeof t&&t(e);else{var n=!0,i=!1,r=void 0;try{for(var s,o=(0,m.default)((0,c.default)(a.whiteboardInstanceStore));!(n=(s=o.next()).done);n=!0){var l=s.value;t&&"function"==typeof t&&t(l)}}catch(e){i=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}}},{key:"_saveAwaitSaveToWhiteboardInstanceSignallingToWhiteboardInstance",value:function(e){for(var t=!1,a=0;a<this.awaitSaveToWhiteboardInstanceSignallingArray.length;a++){var n=this.awaitSaveToWhiteboardInstanceSignallingArray[a];if(n.data&&"string"==typeof n.data&&(n.data=JSON.parse(n.data)),n.data.whiteboardID===e.id){var i=n.id.substring(n.id.lastIndexOf("###_")+4);null==e.waitingProcessShapeData[i]||void 0==e.waitingProcessShapeData[i]?(e.waitingProcessShapeData[i]=[],e.waitingProcessShapeData[i].push(n)):e.waitingProcessShapeData[i].push(n),t=!0,this.awaitSaveToWhiteboardInstanceSignallingArray.splice(a,1,null)}}if(t)for(var r=this.awaitSaveToWhiteboardInstanceSignallingArray.length-1;r>=0;r--)null===this.awaitSaveToWhiteboardInstanceSignallingArray[r]&&this.awaitSaveToWhiteboardInstanceSignallingArray.splice(r,1)}},{key:"_basicTemplateWhiteboardSignallingListToWhiteboardInstance",value:function(e){e.needLooadBaseboard&&!e.isBaseboard&&void 0!==e.dependenceBaseboardWhiteboardID&&!e.isHandleBasicTemplateWhiteboardSignallingList&&e.id!==e.dependenceBaseboardWhiteboardID&&this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID]&&Array.isArray(this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID])&&(this._batchReceiveSnapshot(this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID],e),e.isHandleBasicTemplateWhiteboardSignallingList=!0)}},{key:"_convertCanvasToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png";if(e&&e.lc&&e.lc.canvas){var a=e.lc.canvas,n=new Image;return n.src=a.toDataURL("image/"+t),n}}},{key:"_convertCanvasToImageBase64",value:function(e,t){if(e&&e.lc&&e.lc.canvas)return e.lc.canvas.toDataURL("image/"+t)}},{key:"_saveBasicTemplateWhiteboardSignallingData",value:function(e,t){e.data.isBaseboard&&e&&e.data&&e.data.isBaseboard&&void 0!==e.data.whiteboardID&&(e.source=t,this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID]=this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID]||[],this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID].push(e))}},{key:"_handlerShowRemoteRemindContentFromPubmsgData",value:function(e,t){var a=void 0,n=void 0,i=void 0;if("pubmsg"===t.source&&t.data&&"shapeSaveEvent"===t.data.eventType)if("LinePath"==t.data.data.className){var r=t.data.data.points.length;r>0&&(a=t.data.data.points[r-1].x,n=t.data.data.points[r-1].y,i=t.remindContent),this._productionWhiteboardRemindContent(e,a,n,i,t.data.shapeId)}else"Rectangle"==t.data.data.className||"Ellipse"==t.data.data.className?(t.data.data.width>0&&t.data.data.height>0?(a=t.data.data.x+t.data.data.width,n=t.data.data.y):t.data.data.width>0&&t.data.data.height<0?(a=t.data.data.x+t.data.data.width,n=t.data.data.y+t.data.data.height):t.data.data.width<0&&t.data.data.height<0?(a=t.data.data.x,n=t.data.data.y+t.data.data.height):t.data.data.width<0&&t.data.data.height>0&&(a=t.data.data.x,n=t.data.data.y),i=t.remindContent,this._productionWhiteboardRemindContent(e,a,n,i,t.data.shapeId)):"Text"==t.data.data.className?(a=t.data.data.x+t.data.data.renderer.metrics.width,n=t.data.data.y+20*t.data.data.renderer.metricses.length,i=t.remindContent,this._productionWhiteboardRemindContent(e,a,n,i,t.data.shapeId)):"Line"==t.data.data.className&&(a=t.data.data.x2,n=t.data.data.y2,i=t.remindContent,this._productionWhiteboardRemindContent(e,a,n,i,t.data.shapeId))}}]),e}(),A=new P;window.WhiteboardHandler=A,t.default=A},uqUo:function(e,t,a){var n=a("kM2E"),i=a("FeBl"),r=a("S82l");e.exports=function(e,t){var a=(i.Object||{})[e]||Object[e],s={};s[e]=t(a),n(n.S+n.F*r(function(){a(1)}),"Object",s)}},"us/S":function(e,t,a){e.exports={default:a("Xd32"),__esModule:!0}},vDoF:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),r=n(i),s=a("+6Bu"),o=n(s),l=a("W3Iv"),d=n(l),u=a("BO1k"),c=n(u),h=a("d7EF"),m=n(h),g=a("Zx67"),f=n(g),p=a("Zrlr"),v=n(p),b=a("wxAW"),y=n(b),S=a("zwoO"),k=n(S),w=a("Pf15"),C=n(w),T=a("GiK3"),P=n(T),A=a("KSGD"),D=n(A),_=a("T+56"),E=n(_),I=a("VSuD"),x=n(I),B=a("HUPQ"),R=n(B),N=a("DrPG"),W=n(N),M=a("Sa83"),F=n(M),O=a("yE5a"),H=n(O),U=a("YRCL"),z=n(U),j=a("uObV"),V=n(j),K=function(e){function t(e){(0,v.default)(this,t);var a=(0,k.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.state={show:!0,selectMouse:!0},a.containerWidthAndHeight={width:0,height:0},a.instanceId=void 0!==a.props.instanceId?a.props.instanceId:"default",a.whiteboardElementId="whiteboard_container_"+a.instanceId,a.fileid=void 0,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a.cacheMaxPageNum=1,a.cacheMinPageNum=1,a.filePreLoadCurrPage=1,a.filePreLoadStep=2,a.showShapeAuthor=R.default.showShapeAuthor,a.forceReloadNumber=0,a.maxForceReloadNumber=10,a}return(0,C.default)(t,e),(0,y.default)(t,[{key:"componentDidMount",value:function(){var e=this;E.default.Window.addEventListener(x.default.EVENTTYPE.WindowEvent.onResize,e.handlerOnResize.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomConnected,e.handlerRoomConnected.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomPubmsg,e.handlerRoomPubmsg.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomDelmsg,e.handlerRoomDelmsg.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomDisconnected,e.handlerRoomDisconnected.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener(x.default.EVENTTYPE.RoomEvent.roomPlaybackClearAllFromPlaybackController,e.handlerRoomPlaybackClearAll.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("receive-msglist-ShowPage-lastDocument",e.handlerReceiveMsglistShowPageLastDocument.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("saveLcStackToStorage",e.handlerSaveLcStackToStorage.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("resizeHandler",e.handlerResizeHandler.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("setFileDataToLcElement",e.handlerSetFileDataToLcElement.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("getFileDataFromLcElement",e.handlerGetFileDataFromLcElement.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("resetLcDefault",e.handlerResetLcDefault.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("closeLoading",e.handlerCloseLoading.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateLcScaleWhenAynicPPTInitHandler",e.handlerUpdateLcScaleWhenAynicPPTInitHandler.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("recoverCurrpageLcData",e.handlerRecoverCurrpageLcData.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboardPrevPage",e.handlerWhiteboardPrevPage.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboardNextPage",e.handlerWhiteboardNextPage.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboardAddPage",e.handlerWhiteboardAddPage.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateAppPermissions_whiteboardPagingPage",e.handlerUpdateAppPermissions_whiteboardPagingPage.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("initAppPermissions",e.handlerInitAppPermissions.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("openDocuemntOrMediaFile",e.handlerOpenDocuemntOrMediaFile.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboard_updateWhiteboardToolsInfo",e.handlerWhiteboard_updateWhiteboardToolsInfo.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboard_updateTextFont",e.handlerWhiteboard_updateTextFont.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateSelectMouse",e.handlerUpdateSelectMouse.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("checkSelectMouseState",e.handlerCheckSelectMouseState.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("changeStrokeSize",e.handlerChangeStrokeSize.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("changeStrokeColor",e.handlerChangeStrokeColor.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateAppPermissions_canDraw",e.handlerUpdateAppPermissions_canDraw.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateAppPermissions_h5DocumentActionClick",e.handlerUpdateAppPermissions_h5DocumentActionClick.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("updateAppPermissions_dynamicPptActionClick",e.handlerUpdateAppPermissions_dynamicPptActionClick.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("lcTextEditing",e.handlerLcTextEditing.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("skipPage_general",e.handlerSkipPage_general.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("preloadWhiteboardImg",e.handlerPreloadWhiteboardImg.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("receive-msglist-whiteboardMarkTool",e.handlerReceive_msglist_whiteboardMarkTool.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("whiteboard_activeCommonWhiteboardTool",e.handlerWhiteboard_activeCommonWhiteboardTool.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("receive-msglist-ClassBegin",e.handlerReceiveMsglistClassBegin.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("changeLine",e.handlerChangeLine.bind(e),e.listernerBackupid),E.default.CoreController.addEventListener("receive-msglist-not-ShowPage-lastDocument",e.handleRreceiveMsglistNotShowPageLastDocument.bind(e),e.listernerBackupid),e._lcInit()}},{key:"componentWillUnmount",value:function(){var e=this;E.default.Window.removeBackupListerner(e.listernerBackupid),E.default.CoreController.removeBackupListerner(e.listernerBackupid),V.default.destroyWhiteboardInstance(e.instanceId)}},{key:"componentDidUpdate",value:function(e,t){t.selectMouse!==this.state.selectMouse&&this.handlerCheckSelectMouseState(),t.show!==this.state.show&&this.state.show&&V.default.checkWhiteboardCanvasSize(this.instanceId,{isResize:!0})}},{key:"handleRreceiveMsglistNotShowPageLastDocument",value:function(){V.default.saveWhiteboardStackToStorage(this.instanceId),V.default.updateWhiteboardFiledata(this.instanceId,{}),V.default.loadCurrpageWhiteboard(this.instanceId)}},{key:"handlerReceiveMsglistClassBegin",value:function(e){V.default.clearWhiteboardAllDataById(this.instanceId)}},{key:"handlerRoomConnected",value:function(){if(V.default.updateWhiteboardSaveRedoStackAndSaveUndoStack(this.instanceId,{saveRedoStack:x.default.hasRole.roleChairman||x.default.joinRoomInfo.shapeUndoRedoClear,saveUndoStack:!1}),this.showShapeAuthor!==R.default.showShapeAuthor&&(this.showShapeAuthor=R.default.showShapeAuthor,V.default.updateShowRemindContent(this.instanceId,R.default.showShapeAuthor)),V.default.changeWhiteboardExclusiveAttribute(this.instanceId,{myselfId:H.default.getTkRoom()&&H.default.getTkRoom().getMySelf()?H.default.getTkRoom().getMySelf().id:void 0,undoRedoClearToMySelf:x.default.hasRole.roleStudent&&x.default.joinRoomInfo.shapeUndoRedoClear}),x.default.joinRoomInfo.customWhiteboardBackground&&void 0!==R.default.whiteboardColorNumber){var e=R.default.whiteboardColorNumber,t="#"+R.default.customWhiteboardColorArry[e];V.default.updateColor(this.instanceId,{background:t})}}},{key:"handlerOnResize",value:function(){var e=this;if(e.props.fatherContainerId){var t=$("#"+e.props.fatherContainerId);if(t&&t.length>0){var a={width:t.width(),height:t.height()};e.containerWidthAndHeight=a,V.default.updateContainerWidthAndHeight(e.instanceId,a)}}V.default.resizeWhiteboardHandler(e.instanceId)}},{key:"handlerRoomPubmsg",value:function(e){var t=this,a=e.message;switch(a.name){case"ClassBegin":V.default.clearWhiteboardAllDataById(t.instanceId);break;case"ShowPage":var n=t._saveFileidReturnOpen(a.data),i={message:{data:a.data,open:n,source:"room-pubmsg"}};t._handlerReceiveShowPageSignalling(i);break;case"whiteboardMarkTool":var r=a.data.selectMouse;t.handlerUpdateSelectMouse({type:"updateSelectMouse",message:{selectMouse:r}})}}},{key:"handlerReceive_msglist_whiteboardMarkTool",value:function(e){var t=this,a=e.message,n=a.data.selectMouse;t.handlerUpdateSelectMouse({type:"updateSelectMouse",message:{selectMouse:n}})}},{key:"handlerRoomDelmsg",value:function(e){var t=this;switch(e.message.name){case"ClassBegin":!x.default.joinRoomInfo.isClassOverNotLeave&&F.default.handler.getAppPermissions("endClassbeginRevertToStartupLayout")&&V.default.clearWhiteboardAllDataById(t.instanceId)}}},{key:"handlerRoomPlaybackClearAll",value:function(){if(!R.default.playback)return void L.Logger.error("No playback environment, no execution event[roomPlaybackClearAll] handler ");var e=this;V.default.clearWhiteboardAllDataById(e.instanceId)}},{key:"handlerRoomDisconnected",value:function(e){var t=this;V.default.clearWhiteboardAllDataById(t.instanceId)}},{key:"handlerReceiveMsglistShowPageLastDocument",value:function(e){var t=this,a=t._saveFileidReturnOpen(e.message.data);e.message.open=a,t._handlerReceiveShowPageSignalling(e)}},{key:"handlerSaveLcStackToStorage",value:function(e){var t=this;V.default.saveWhiteboardStackToStorage(t.instanceId,{saveRedoStack:x.default.hasRole.roleChairman||x.default.joinRoomInfo.shapeUndoRedoClear,saveUndoStack:!1})}},{key:"handlerResizeHandler",value:function(e){var t=this;e&&e.message&&void 0!=e.message.eleWHPercent&&V.default.updateWhiteboardMagnification(t.instanceId,e.message.eleWHPercent),t.handlerOnResize()}},{key:"handlerSetFileDataToLcElement",value:function(e){var t=this;V.default.updateWhiteboardFiledata(t.instanceId,e.message.filedata)}},{key:"handlerGetFileDataFromLcElement",value:function(e){var t=this,a=e.message.callback;a&&"function"==typeof a&&a(V.default.getWhiteboardFiledata(t.instanceId))}},{key:"handlerResetLcDefault",value:function(e){var t=this;V.default.resetDedaultWhiteboardMagnification(t.instanceId)}},{key:"handlerCloseLoading",value:function(e){var t=this;V.default.hideWhiteboardLoading(t.instanceId)}},{key:"handlerUpdateLcScaleWhenAynicPPTInitHandler",value:function(e){var t=this;V.default.updateWhiteboardWatermarkImageScalc(t.instanceId,e.message.lcLitellyScalc),V.default.setWhiteboardWatermarkImage(t.instanceId,"")}},{key:"handlerRecoverCurrpageLcData",value:function(e){this._recoverCurrpageLcData()}},{key:"handlerWhiteboardPrevPage",value:function(){this._whiteboardPaging(!1,!0)}},{key:"handlerWhiteboardNextPage",value:function(){this._whiteboardPaging(!0,!0)}},{key:"handlerWhiteboardAddPage",value:function(){var e=this;e.handlerSaveLcStackToStorage();var t=V.default.getWhiteboardFiledata(e.instanceId);t.pagenum+=1;var a={totalPage:t.pagenum,fileid:t.fileid};V.default.updateWhiteboardFiledata(e.instanceId,t),z.default.sendSignallingFromWBPageCount(a),e._whiteboardPaging(!0,!0)}},{key:"handlerUpdateAppPermissions_whiteboardPagingPage",value:function(){var e=this;"general"===e.props.fileTypeMark&&E.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"whiteboard",data:V.default.getWhiteboardFiledata(e.instanceId)}})}},{key:"handlerInitAppPermissions",value:function(){var e=this;e.handlerUpdateAppPermissions_canDraw(),e.handlerUpdateAppPermissions_whiteboardPagingPage(),e.handlerCheckSelectMouseState()}},{key:"handlerOpenDocuemntOrMediaFile",value:function(e){var t=this,a=e.message,n=t._saveFileidReturnOpen(a);a.isGeneralFile&&t._handlerReceiveShowPageSignalling({message:{data:a,open:n,source:"commonFileClickEvent"}})}},{key:"handlerWhiteboard_updateWhiteboardToolsInfo",value:function(e){V.default.updateWhiteboardToolsInfo(this.instanceId,e.message.whiteboardToolsInfo)}},{key:"handlerWhiteboard_updateTextFont",value:function(e){var t=this;V.default.updateTextFont(t.instanceId)}},{key:"handlerUpdateSelectMouse",value:function(e){var t=e.message.selectMouse;if(this.state.selectMouse!==t){var a=this.props.fileTypeMark,n=!1;switch(a){case"dynamicPPT":case"h5document":n=t;break;default:n=!1}this.setState({selectMouse:t,show:!n})}}},{key:"handlerCheckSelectMouseState",value:function(e){var t=void 0;e&&e.message&&e.message.fileTypeMark&&(t=e.message.fileTypeMark);var a=this.state,n=a.selectMouse,i=a.show;t=t||this.props.fileTypeMark;var r=!1;switch(t){case"dynamicPPT":case"h5document":r=n;break;default:r=!1}i!==!r&&this.setState({show:!r})}},{key:"handlerChangeStrokeSize",value:function(e){var t=this,a=e.message.strokeJson,n=a.pencil,i=a.text,r=a.eraser,s=a.shape,o={pencilWidth:n,fontSize:i,eraserWidth:r,shapeWidth:s};V.default.updateWhiteboardToolsInfo(t.instanceId,o);var l=!0,u=!1,h=void 0;try{for(var g,f=(0,c.default)((0,d.default)(e.message.selectedTool));!(l=(g=f.next()).done);l=!0){var p=g.value,v=(0,m.default)(p,2),b=v[0];if(v[1])switch(b){case"pencil":V.default.updatePencilWidth(t.instanceId,{pencilWidth:n});break;case"text":V.default.updateTextFont(t.instanceId,{fontSize:i});break;case"eraser":V.default.updateEraserWidth(t.instanceId,{eraserWidth:r});break;case"shape":V.default.updateShapeWidth(t.instanceId,{shapeWidth:s})}}}catch(e){u=!0,h=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw h}}}},{key:"handlerChangeStrokeColor",value:function(e){var t=this;V.default.updateColor(t.instanceId,{primary:"#"+e.message.selectColor})}},{key:"handlerUpdateAppPermissions_canDraw",value:function(){var e=this;V.default.changeWhiteboardDeawPermission(!(TK&&"mobile"===TK.SDKTYPE&&TK.global&&TK.global.initPageParameterFormPhone&&"AndroidTV"===TK.global.initPageParameterFormPhone.appType)&&F.default.handler.getAppPermissions("canDraw"),e.instanceId)}},{key:"handlerUpdateAppPermissions_h5DocumentActionClick",value:function(){this.handlerCheckSelectMouseState()}},{key:"handlerUpdateAppPermissions_dynamicPptActionClick",value:function(){this.handlerCheckSelectMouseState()}},{key:"handlerLcTextEditing",value:function(e){var t=this,a=e.message.callback;a&&"function"==typeof a&&a(V.default.isWhiteboardTextEditing(t.instanceId))}},{key:"handlerSkipPage_general",value:function(e){var t=this;if("general"===t.props.fileTypeMark){var a=e.message.currpage;t._skipWhiteboardPaging(a)}}},{key:"handlerPreloadWhiteboardImg",value:function(e){var t=e.message.url;V.default.preloadWhiteboardImg(t)}},{key:"sendSignallingToServer",value:function(e,t,a,n,i,r,s,o){z.default.sendSignallingFromSharpsChange(!1,e,t,a,n,i,r,s,o)}},{key:"delSignallingToServer",value:function(e,t,a,n){z.default.sendSignallingFromSharpsChange(!0,e,t,a,n)}},{key:"resizeWhiteboardSizeCallback",value:function(e){this.props.resizeWhiteboardSizeCallback&&"function"==typeof this.props.resizeWhiteboardSizeCallback&&this.props.resizeWhiteboardSizeCallback(e)}},{key:"noticeUpdateToolDescCallback",value:function(e){E.default.CoreController.dispatchEvent({type:"commonWhiteboardTool_noticeUpdateToolDesc",message:{registerWhiteboardToolsList:e}})}},{key:"handlerChangeLine",value:function(){var e=V.default.getWhiteboardFiledata(this.instanceId),t=e.swfpath,a=e.currpage,n=e.filetype;if("general"===this.props.fileTypeMark&&"whiteboard"!==n&&t){var i=t.lastIndexOf("."),r=t.substring(i),s=t.replace(r,"-"+a+r);V.default.setWhiteboardWatermarkImage(this.instanceId,R.default.nowUseDocAddress+s,{resetDedaultWhiteboardMagnification:!1})}}},{key:"whiteboardWatermarkImageOnFailureCallback",value:function(e){var t=V.default.getWhiteboardFiledata(this.instanceId),a=t.swfpath,n=t.currpage,i=t.filetype;if("general"===this.props.fileTypeMark&&e&&"whiteboard"!==i&&this.forceReloadNumber<this.maxForceReloadNumber){var r=a.lastIndexOf("."),s=a.substring(r),o=a.replace(s,"-"+n+s);if(new RegExp(o,"g").test(e)){this.forceReloadNumber++;var l=R.default.docAddressList[R.default.docAddressIndex]||x.default.SERVICEINFO.docAddress;R.default.docAddressIndex=++R.default.docAddressIndex%R.default.docAddressList.length,"mobile"===TK.SDKTYPE?"function"==typeof H.default.getTkRoom().setLocalStorageItem&&H.default.getTkRoom().setLocalStorageItem("tkDocAddressIndex",R.default.docAddressIndex):L.Utils.localStorage.setItem("tkDocAddressIndex",R.default.docAddressIndex),R.default.nowUseDocAddress=R.default.docAddressList[R.default.docAddressIndex]||x.default.SERVICEINFO.docAddress,L.Logger.info("[reload general document]change doc address , old address is "+l+" , now address is "+R.default.nowUseDocAddress),L.Logger.info("[general document]load general document failure , reload file , old url is "+(l+o)+" , now url is "+(R.default.nowUseDocAddress+o)+" , reload number is "+this.forceReloadNumber),V.default.setWhiteboardWatermarkImage(this.instanceId,R.default.nowUseDocAddress+o,{resetDedaultWhiteboardMagnification:!1})}else this.forceReloadNumber=0}}},{key:"handlerWhiteboard_activeCommonWhiteboardTool",value:function(e){var t=e.message.toolKey;V.default.activeWhiteboardTool(t,this.instanceId)}},{key:"_lcInit",value:function(){var e=this;if(!V.default.hasWhiteboardById(e.instanceId)){var t={whiteboardElementId:e.whiteboardElementId,id:e.instanceId,handler:{sendSignallingToServer:e.sendSignallingToServer.bind(e),delSignallingToServer:e.delSignallingToServer.bind(e),resizeWhiteboardSizeCallback:e.resizeWhiteboardSizeCallback.bind(e),noticeUpdateToolDescCallback:e.noticeUpdateToolDescCallback.bind(e),whiteboardWatermarkImageOnFailureCallback:e.whiteboardWatermarkImageOnFailureCallback.bind(e)},productionOptions:{deawPermission:F.default.handler.getAppPermissions("canDraw"),showShapeAuthor:this.showShapeAuthor,myselfId:H.default.getTkRoom()&&H.default.getTkRoom().getMySelf()?H.default.getTkRoom().getMySelf().id:void 0,undoRedoClearToMySelf:x.default.hasRole.roleStudent&&x.default.joinRoomInfo.shapeUndoRedoClear}},a={tool_pencil:{},tool_highlighter:{},tool_line:{},tool_arrow:{},tool_eraser:{},tool_text:{},tool_rectangle:{},tool_rectangle_empty:{},tool_ellipse:{},tool_ellipse_empty:{},tool_mouse:{},tool_laser:{},action_undo:{},action_redo:{},action_clear:{},zoom_big:{},zoom_small:{}};V.default.productionWhiteboard(t),V.default.registerWhiteboardTools(e.instanceId,a),V.default.clearRedoAndUndoStack(e.instanceId),V.default.hasWhiteboardFiledata(e.instanceId)||V.default.updateWhiteboardFiledata(e.instanceId,V.default.getWhiteboardDefaultFiledata()),e.handlerOnResize()}}},{key:"_handlerReceiveShowPageSignalling",value:function(e){var t=this,a=e.message.data,n=e.message.open;if(!a.isMedia&&a.isGeneralFile){if("room-pubmsg"===e.message.source&&!n&&a.filedata.fileid===t.fileid&&Number(a.filedata.currpage)===V.default.getWhiteboardFiledata(this.instanceId).currpage)return;t.handlerSaveLcStackToStorage(),V.default.updateWhiteboardFiledata(t.instanceId,a.filedata),t._recviceCommonDocumentShowPage(!0,n)}}},{key:"_recviceCommonDocumentShowPage",value:function(e,t){var a=this;this.forceReloadNumber=0,a.props.changeFileTypeMark("general"),e=null==e||void 0==e||e,E.default.CoreController.dispatchEvent({type:"setNewPptFrameSrc",message:{src:""}}),E.default.CoreController.dispatchEvent({type:"setH5FileFrameSrc",message:{src:""}}),V.default.resetDedaultWhiteboardMagnification(a.instanceId);var n=V.default.getWhiteboardFiledata(a.instanceId),i=n.swfpath,r=n.currpage,s=n.pagenum,o=n.filetype;if(n.fileid,"whiteboard"===o)V.default.updateWhiteboardWatermarkImageScalc(a.instanceId,16/9),e&&V.default.setWhiteboardWatermarkImage(a.instanceId,"",{resetDedaultWhiteboardMagnification:!1});else{var l=i.lastIndexOf("."),d=i.substring(l),u=i.replace(d,"-"+r+d);if(e){V.default.setWhiteboardWatermarkImage(a.instanceId,R.default.nowUseDocAddress+u,{resetDedaultWhiteboardMagnification:!1});var c=1,h=1;t?(a.cacheMaxPageNum=r,a.filePreLoadCurrPage=r,a.cacheMinPageNum=r,a.cacheMaxPageNum+a.filePreLoadStep<=s?a.cacheMaxPageNum+=a.filePreLoadStep:a.cacheMaxPageNum<s&&(a.cacheMaxPageNum+=s-a.cacheMaxPageNum),a.cacheMinPageNum-a.filePreLoadStep>=1?a.cacheMinPageNum-=a.filePreLoadStep:a.cacheMinPageNum=1,h=a.cacheMaxPageNum,c=a.cacheMinPageNum):(a.filePreLoadCurrPage<r?(c=a.cacheMaxPageNum+1,r>a.cacheMaxPageNum&&(a.cacheMaxPageNum=r),a.cacheMaxPageNum+a.filePreLoadStep<=s?a.cacheMaxPageNum+=a.filePreLoadStep:a.cacheMaxPageNum<s&&(a.cacheMaxPageNum+=s-a.cacheMaxPageNum),h=a.cacheMaxPageNum):a.filePreLoadCurrPage>r&&(h=a.cacheMinPageNum-1,r<a.cacheMinPageNum&&(a.cacheMinPageNum=r),a.cacheMinPageNum-a.filePreLoadStep>=1?a.cacheMinPageNum-=a.filePreLoadStep:a.cacheMinPageNum=1,c=a.cacheMinPageNum),a.filePreLoadCurrPage=r);for(var m=c;m<=h;m++)if(m!==r){var g=i.lastIndexOf("."),f=i.substring(g),p=i.replace(f,"-"+m+f);a.handlerPreloadWhiteboardImg({type:"preloadWhiteboardImg",message:{url:R.default.nowUseDocAddress+p}})}}}a._recoverCurrpageLcData(),E.default.CoreController.dispatchEvent({type:"updatePagdingState",message:{source:"whiteboard",data:V.default.getWhiteboardFiledata(a.instanceId)}}),a.handlerCheckSelectMouseState({type:"checkSelectMouseState",message:{fileTypeMark:"general"}})}},{key:"_recoverCurrpageLcData",value:function(){var e=this,t={loadRedoStack:x.default.hasRole.roleChairman||x.default.joinRoomInfo.shapeUndoRedoClear};V.default.loadCurrpageWhiteboard(e.instanceId,t)}},{key:"_whiteboardPaging",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this,i=V.default.getWhiteboardFiledata(n.instanceId);if(!0===e){if(i.currpage>=i.pagenum)return;i.currpage++}else if(0==e){if(i.currpage<=1)return;i.currpage--}n.handlerSaveLcStackToStorage(),V.default.updateWhiteboardFiledata(n.instanceId,i),n._recviceCommonDocumentShowPage(a);var r=this._toShowPageData(i);E.default.CoreController.dispatchEvent({type:"documentPageChange",message:r}),t&&z.default.sendSignallingFromShowPage(!1,"DocumentFilePage_ShowPage",r)}},{key:"_skipWhiteboardPaging",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this,i=V.default.getWhiteboardFiledata(n.instanceId);i.currpage=e,n.handlerSaveLcStackToStorage(),V.default.updateWhiteboardFiledata(n.instanceId,i),n._recviceCommonDocumentShowPage(a);var r=this._toShowPageData(i);E.default.CoreController.dispatchEvent({type:"documentPageChange",message:r}),t&&z.default.sendSignallingFromShowPage(!1,"DocumentFilePage_ShowPage",r)}},{key:"_toShowPageData",value:function(e){return{isMedia:!1,isDynamicPPT:!1,isGeneralFile:!0,isH5Document:!1,action:"",mediaType:"",filedata:e}}},{key:"_saveFileidReturnOpen",value:function(e){var t=this,a=void 0;if(!e.isMedia){var n=e.filedata.fileid;a=t.fileid!=n,t.fileid=n}return a}},{key:"render",value:function(){var e=this,t=e.props,a=t.fileTypeMark,n=(0,o.default)(t,["fileTypeMark"]),i=e.state.show;return P.default.createElement("div",(0,r.default)({id:e.whiteboardElementId,style:{display:i?"block":"none"},className:"overflow-hidden  scroll-literally-container tk-filetype-"+a},W.default.filterContainDataAttribute(n)))}}]),t}(P.default.Component);K.propTypes={instanceId:D.default.string.isRequired},t.default=K},w5fS:function(e,t){},wEtr:function(e,t,a){a("gSvA"),e.exports=a("FeBl").Object.entries},"xH/j":function(e,t,a){var n=a("hJx8");e.exports=function(e,t,a){for(var i in t)a&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},xPSH:function(e,t){},yE5a:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=void 0,t=void 0,a=void 0,n=void 0,i=void 0;this.getTkRoom=function(){return e},this.getRoomName=function(){return t},this.setTkRoom=function(t){e=t},this.setRoomName=function(e){t=e},this.getLocalStream=function(){return n},this.setLocalStream=function(e){n=e},this.getUserName=function(){return a},this.setUserName=function(e){a=e},this.getUserThirdid=function(){return i},this.setUserThirdid=function(e){i=e},this.clearAll=function(){e=null,t=null,a=null,n=null,i=null}};t.default=new n},yZ13:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={header:{tool:{blackBoard:{title:{open:"Small Whiteboard",close:"Close",prev:"Previous one",next:"Next person",shrink:"Shrink"},content:{blackboardHeadTitle:"Small Whiteboard"},toolBtn:{dispenseed:"Send",recycle:"Take Back",againDispenseed:"Again Send",commonTeacher:"Teacher"},tip:{saveImage:"Save Image"},boardTool:{pen:"Pen",text:"Text Input",eraser:"Eraser",color:"Colors and Thickness"}},sharing:{title:"Sharing"},mouse:{title:"Mouse"},pencil:{title:"Pen",pen:{text:"Pencils"},Highlighter:{text:"Highlighters"},linellae:{text:"Lines"},arrow:{text:"Arrows"},laser:{title:"Laser pen",text:"Laser pen"}},text:{title:"Text Input",Msyh:{text:"Microsoft YaHei"},Ming:{text:"SimSun"},Arial:{text:"Arial"}},shape:{title:"Shapes",outlinedRectangle:{text:"Squares"},filledRectangle:{text:"Solid Squares"},outlinedCircle:{text:"Circles"},filledCircle:{text:"Solid Circles"}},eraser:{title:"Eraser"},undo:{title:"Undo"},redo:{title:"Recover"},clear:{title:" Clear Screen"},tool_zoom_big:{title:"Zoom In"},tool_zoom_small:{title:"Zoom Out"},tool_rotate_left:{title:"Contrarotate"},tool_rotate_right:{title:"Clockwise rotation"},colorAndMeasure:{title:"Colors and Thickness",selectColorText:"select Colour",selectMeasure:"select Thickness"},colors:{title:"Colors"},measure:{title:"Thickness"}},page:{prev:{text:"Previous Page"},next:{text:"Next Page"},add:{text:"Add Page"},lcFullBtn:{title:"Full Screen of Drawing Area"},pptFullBtn:{title:"Full Screen  of PPT"},h5FileFullBtn:{title:"Full Screen  of Courseware"},skipPage:{text_one:"To ",text_two:" pages"},ok:{text:"Confirm"},coursewareRemarks:{title:"Courseware Remarks"}},volume:{title:"volume"}},alertWin:{ok:{showError:{text:"Confirm"},showPrompt:{text:"Confirm"},showConfirm:{cancel:"Cancel",ok:"Confirm"}},title:{showError:{text:"Error Message"},showPrompt:{text:"Prompt Message"},showConfirm:{text:"Confirmation Messages"}},call:{fun:{page:{pageInteger:{text:"The page number entered must be integers."},pageMax:{text:"The page number entered is over!"},pageMin:{text:"The page number entered can't be less than 1."}}}}},toolCase:{toolBox:{text:"ToolBox"}},timers:{timerSetInterval:{text:"Timer"},timerBegin:{text:"Start"},timerStop:{text:"Pause"},again:{text:"Restart"}},dial:{turntable:{text:"Turntable"}},answers:{headerTopLeft:{text:"The answer is"},headerMiddel:{text:"Click the default answer"},beginAnswer:{text:"Begin to answer"},tureAccuracy:{text:"Accuracy"},trueAnswer:{text:"The right answer"},endAnswer:{text:"End of the answer"},restarting:{text:"Restart"},myAnswer:{text:"My Answer"},changeAnswer:{text:"Modify the answer"},selectAnswer:{text:"Please select at least one answer"},submitAnswer:{text:"Submit the answer"},numberOfAnswer:{text:"Number of answer"},PublishTheAnswer:{text:"Publish the answer"},published:{text:"Published"},details:{text:"Details"},statistics:{text:"Statistics"},student:{text:"Student"},TheSelectedTheAnswer:{text:"The selected the answer"},AnswerTime:{text:"Answer Time"},end:{text:"Please finish your questions first"}},responder:{responder:{text:"Responder"},begin:{text:"Start"},restart:{text:"Restart"},close:{text:"Close"},update:{text:"The current browser does not support canvas components please upgrade!"},inAnswer:{text:"In answer"},answer:{text:"Responder"},noContest:{text:"No contest"}},call:{fun:{page:{pageInteger:{text:"The page number entered must be integers."},pageMax:{text:"The page number entered is over!"},pageMin:{text:"The page number entered can't be less than 1."}}}},coursewareRemarks:{remarks:"remarks",close:"close"},reloadDoucumentHint:{one:"The network is unstable , Trying to reopen the courseware ...",two:""}};t.default=n},yms7:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("Zx67"),r=n(i),s=a("Zrlr"),o=n(s),l=a("wxAW"),d=n(l),u=a("zwoO"),c=n(u),h=a("Pf15"),m=n(h),g=a("GiK3"),f=n(g),p=a("HUPQ"),v=n(p),b=a("yE5a"),y=(n(b),a("6ifl")),S=n(y),k=a("Sa83"),w=n(k),C=a("T+56"),T=n(C),P=a("YRCL"),A=n(P),D=a("EXAz"),_=n(D),E=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e)),n=a.props.captureImgInfo;return a.state={captureImgBoardInfo:{containerWidthAndHeight:{width:0,height:0},watermarkImageUrl:"",isShow:!1,backgroundColor:"transparent",instanceId:"captureImgBoard"+n.fileid,saveImage:!1,nickname:"captureImgBoard",deawPermission:w.default.handler.getAppPermissions("canDraw"),associatedMsgID:"CaptureImg_"+n.fileid},isRender:!1},a.isAnewCountPosition=!1,a.listernerBackupid=(new Date).getTime()+"_"+Math.random(),a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){T.default.Window.addEventListener(TkConstant.EVENTTYPE.WindowEvent.onResize,this.handlerOnResize.bind(this),this.listernerBackupid),T.default.CoreController.addEventListener("resizeHandler",this.handlerOnResize.bind(this),this.listernerBackupid),T.default.CoreController.addEventListener("updateAppPermissions_canDraw",this.handlerUpdateAppPermissions_canDraw.bind(this),this.listernerBackupid),T.default.CoreController.addEventListener("updateAppPermissions_canDragCaptureImg",this.handlerUpdate_canDragCaptureImg.bind(this),this.listernerBackupid),T.default.CoreController.addEventListener("updateAppPermissions_canResizeCaptureImg",this.handlerUpdate_canResizeCaptureImg.bind(this),this.listernerBackupid)}},{key:"componentWillUnmount",value:function(){T.default.Window.removeBackupListerner(this.listernerBackupid),T.default.CoreController.removeBackupListerner(this.listernerBackupid)}},{key:"componentDidUpdate",value:function(e,t){}},{key:"handlerOnResize",value:function(){this.setState({isRender:!this.state.isRender})}},{key:"handlerUpdateAppPermissions_canDraw",value:function(){this.state.captureImgBoardInfo.deawPermission=w.default.handler.getAppPermissions("canDraw"),this.setState({captureImgBoardInfo:this.state.captureImgBoardInfo})}},{key:"handlerUpdate_canDragCaptureImg",value:function(){this.setState({isRender:!this.state.isRender})}},{key:"handlerUpdate_canResizeCaptureImg",value:function(){this.setState({isRender:!this.state.isRender})}},{key:"captureImgCloseClick",value:function(){var e=this.props.captureImgInfo,t="CaptureImg_"+e.fileid,a={};A.default.sendSignallingFromCaptureImg(t,a,!0)}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.captureImgInfo,n=e.dragData,i=e.useToolInfo,r=e.selectMouse,s=(e.changeLayerIsShow,this.state.captureImgBoardInfo),o=v.default.windowInnerWidth/TkConstant.STANDARDSIZE,l=a.swfpath.substring(a.swfpath.lastIndexOf("."))||".jpg",d=a.swfpath.replace(l,"-1"+l);s.watermarkImageUrl=v.default.nowUseDocAddress+d;var u="tool_eraser"===i.useToolKey?i.blackboardToolsInfo.eraser:i.blackboardToolsInfo.pencil;o&&(s.containerWidthAndHeight={width:n.size.width*o,height:n.size.height*o});var c=Object.customAssign({id:t,dragBounds:"pc"===TK.SDKTYPE?"#lc-full-vessel":"#tk_app",disabled:!(r&&w.default.handler.getAppPermissions("canDragCaptureImg")),canResize:w.default.handler.getAppPermissions("canResizeCaptureImg")&&r,minResize:{width:2,height:2},borderWidth:.04},n);return f.default.createElement(_.default,c,f.default.createElement("div",{id:t,className:"capture-img-box"},f.default.createElement(S.default,{resizeInfo:n.size,isBaseboard:!1,watermarkImageUrl:s.watermarkImageUrl,instanceId:s.instanceId,nickname:s.nickname,show:!0,backgroundColor:s.backgroundColor,containerWidthAndHeight:s.containerWidthAndHeight,showShapeAuthor:!1,deawPermission:s.deawPermission,associatedMsgID:s.associatedMsgID,fontSize:i.blackboardToolsInfo.text,useToolColor:i.useToolColor,pencilWidth:u,useToolKey:i.useToolKey}),f.default.createElement("div",{className:"capture-img-layer",style:{display:c.disabled?"none":"block"}}),f.default.createElement("button",{className:"capture-img-close",style:{display:TkConstant.hasRole.roleChairman||TkConstant.hasRole.roleTeachingAssistant?void 0:"none"},onClick:this.captureImgCloseClick.bind(this),title:"关闭"})))}}]),t}(f.default.Component);t.default=E}},[0]);